# ドキュメントテンプレート

このディレクトリには、電子署名用のドキュメントテンプレートを配置します。

## ディレクトリ構成

```
templates/
├── documents/          # Excelテンプレートファイル
│   ├── order_template.xlsx         # 発注書テンプレート
│   ├── completion_template.xlsx    # 完了届テンプレート
│   └── monthly_invoice_template.xlsx # 月次請求書テンプレート
└── README.md
```

## Excelテンプレートの作成方法

### 1. 発注書テンプレート (`order_template.xlsx`)

**セル配置:**
- `B5`: 発注者名
- `B6`: 発注者メールアドレス
- `B8`: 受注者名
- `B9`: 受注者メールアドレス
- `B11`: プロジェクト名
- `B12`: 契約金額
- `B13`: 納期
- `E2`: 作成日

### 2. 完了届テンプレート (`completion_template.xlsx`)

**セル配置:**
- `B5`: プロジェクト名
- `B6`: 受注者名
- `B7`: 完了日
- `E2`: 作成日

**テーブル（成果物一覧）:**
- 10行目から成果物リストを配置

### 3. 月次請求書テンプレート (`monthly_invoice_template.xlsx`)

**セル配置:**
- `B5`: 受注者名
- `B6`: 受注者メールアドレス
- `B8`: 請求対象期間
- `E20`: システム利用料合計
- `E21`: 請求金額合計
- `E2`: 作成日

**テーブル（プロジェクト一覧）:**
- 12行目からプロジェクト一覧を配置
  - A列: 番号
  - B列: プロジェクト名
  - C列: 完了日
  - D列: 契約金額
  - E列: システム利用料

## 計算式の使用

Excelテンプレートでは計算式を使用できます：

```excel
// システム利用料の自動計算例
=D12*0.1    // 契約金額の10%

// 合計金額の計算例
=SUM(E12:E20)  // システム利用料の合計
```

## テンプレートファイルの命名規則

システムは以下の順序でテンプレートファイルを検索します：

1. `{templateId}.xlsx` (データベースのtemplate ID)
2. `{docType}_template.xlsx` (例: `order_template.xlsx`)
3. `{docType}.xlsx` (例: `order.xlsx`)
4. `template_{docType}.xlsx` (例: `template_order.xlsx`)

テンプレートファイルが見つからない場合、モックPDF生成にフォールバックします。

## 使用方法

1. 上記の仕様に従ってExcelテンプレートを作成
2. `templates/documents/` ディレクトリに配置
3. システムが自動的にテンプレートを検出し、Excel → PDF変換を実行

## 注意事項

- Excelファイルは最初のシートのみが使用されます
- 複雑なレイアウトや画像は、PDF変換時に表示が崩れる可能性があります
- 日本語フォントが適切に表示されるよう、システム側でフォント設定を調整済みです