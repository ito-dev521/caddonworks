(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[14],{28203:function(e,s,t){"use strict";t.d(s,{Z:function(){return a}});/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let a=(0,t(62898).Z)("Calendar",[["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",ry:"2",key:"eu3xkr"}],["line",{x1:"16",x2:"16",y1:"2",y2:"6",key:"m3sa8f"}],["line",{x1:"8",x2:"8",y1:"2",y2:"6",key:"18kwsl"}],["line",{x1:"3",x2:"21",y1:"10",y2:"10",key:"xt86sb"}]])},86264:function(e,s,t){"use strict";t.d(s,{Z:function(){return a}});/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let a=(0,t(62898).Z)("Loader2",[["path",{d:"M21 12a9 9 0 1 1-6.219-8.56",key:"13zald"}]])},2882:function(e,s,t){"use strict";t.d(s,{Z:function(){return a}});/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let a=(0,t(62898).Z)("MessageSquare",[["path",{d:"M21 15a2 2 0 0 1-2 2H7l-4 4V5a2 2 0 0 1 2-2h14a2 2 0 0 1 2 2z",key:"1lielz"}]])},41787:function(e,s,t){Promise.resolve().then(t.bind(t,90511))},90511:function(e,s,t){"use strict";t.r(s),t.d(s,{default:function(){return g}});var a=t(57437),r=t(2265),i=t(65251),n=t(55340),l=t(28203),c=t(2882),d=t(15671),x=t(33277),o=t(7403),m=t(65592),u=t(66210),h=t(14958);function g(){return(0,a.jsx)(o.AuthGuard,{allowedRoles:["Contractor"],children:(0,a.jsx)(j,{})})}function j(){let{userProfile:e,userRole:s}=(0,u.useAuth)(),[t,o]=(0,r.useState)([]),[g,j]=(0,r.useState)(!0),[y,f]=(0,r.useState)(null),b=async()=>{if(e&&"Contractor"===s)try{j(!0);let{data:{session:s}}=await h.OQ.auth.getSession();if(!s)return;let t=await fetch("/api/evaluations/contractor?contractor_id=".concat(e.id),{headers:{Authorization:"Bearer ".concat(s.access_token)}});if(t.ok){let e=await t.json();o(e.evaluations||[])}else f("評価データの取得に失敗しました")}catch(e){console.error("評価取得エラー:",e),f("ネットワークエラーが発生しました")}finally{j(!1)}};(0,r.useEffect)(()=>{b()},[e,s]);let N=e=>{let{score:s}=e;return(0,a.jsxs)("div",{className:"flex items-center gap-1",children:[[1,2,3,4,5].map(e=>(0,a.jsx)(n.Z,{className:"w-4 h-4 ".concat(e<=s?"text-yellow-400 fill-yellow-400":"text-gray-300")},e)),(0,a.jsx)("span",{className:"ml-2 text-sm text-gray-600",children:s.toFixed(1)})]})},v=e=>e>=4.5?{label:"優秀",color:"bg-green-100 text-green-800"}:e>=3.5?{label:"良好",color:"bg-blue-100 text-blue-800"}:e>=2.5?{label:"普通",color:"bg-yellow-100 text-yellow-800"}:e>=1.5?{label:"要改善",color:"bg-orange-100 text-orange-800"}:{label:"不十分",color:"bg-red-100 text-red-800"};return g?(0,a.jsxs)("div",{className:"min-h-screen bg-gradient-mesh",children:[(0,a.jsx)(m.W,{}),(0,a.jsx)("div",{className:"md:ml-64 transition-all duration-300",children:(0,a.jsx)("div",{className:"flex items-center justify-center min-h-screen",children:(0,a.jsxs)("div",{className:"text-center",children:[(0,a.jsx)("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-engineering-blue mx-auto mb-4"}),(0,a.jsx)("p",{className:"text-gray-600",children:"評価データを読み込み中..."})]})})})]}):y?(0,a.jsxs)("div",{className:"min-h-screen bg-gradient-mesh",children:[(0,a.jsx)(m.W,{}),(0,a.jsx)("div",{className:"md:ml-64 transition-all duration-300",children:(0,a.jsx)("div",{className:"flex items-center justify-center min-h-screen",children:(0,a.jsxs)("div",{className:"text-center",children:[(0,a.jsx)("div",{className:"text-red-500 text-xl mb-4",children:"⚠️"}),(0,a.jsx)("p",{className:"text-gray-600",children:y}),(0,a.jsx)("button",{onClick:b,className:"mt-4 px-4 py-2 bg-engineering-blue text-white rounded-lg hover:bg-blue-700",children:"再試行"})]})})})]}):(0,a.jsxs)("div",{className:"min-h-screen bg-gradient-mesh",children:[(0,a.jsx)(m.W,{}),(0,a.jsxs)("div",{className:"md:ml-64 transition-all duration-300",children:[(0,a.jsx)(i.E.header,{initial:{opacity:0,y:-20},animate:{opacity:1,y:0},className:"bg-white/80 backdrop-blur-sm border-b border-gray-200 sticky top-0 z-30",children:(0,a.jsx)("div",{className:"px-6 py-4",children:(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsxs)("div",{children:[(0,a.jsxs)("h1",{className:"text-2xl font-bold text-gray-900 flex items-center gap-2",children:[(0,a.jsx)(n.Z,{className:"w-6 h-6 text-yellow-500"}),"受注者評価"]}),(0,a.jsx)("p",{className:"text-gray-600",children:"発注者からの評価とコメントを確認できます"})]}),(0,a.jsxs)(x.C,{variant:"engineering",children:[t.length,"件の評価"]})]})})}),(0,a.jsx)("main",{className:"px-6 py-8",children:0===t.length?(0,a.jsxs)(i.E.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},className:"text-center py-12",children:[(0,a.jsx)(n.Z,{className:"w-16 h-16 text-gray-300 mx-auto mb-4"}),(0,a.jsx)("h2",{className:"text-xl font-semibold text-gray-900 mb-2",children:"まだ評価がありません"}),(0,a.jsx)("p",{className:"text-gray-600",children:"案件完了後に発注者からの評価が表示されます"})]}):(0,a.jsx)("div",{className:"space-y-6",children:t.map((e,s)=>{let t=v(e.average_score);return(0,a.jsx)(i.E.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.1*s},children:(0,a.jsxs)(d.Zb,{className:"hover:shadow-lg transition-shadow",children:[(0,a.jsx)(d.Ol,{children:(0,a.jsxs)("div",{className:"flex items-start justify-between",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)(d.ll,{className:"text-lg font-semibold text-gray-900 mb-2",children:e.projects.title}),(0,a.jsx)("div",{className:"flex items-center gap-4 text-sm text-gray-600",children:(0,a.jsxs)("div",{className:"flex items-center gap-1",children:[(0,a.jsx)(l.Z,{className:"w-4 h-4"}),new Date(e.created_at).toLocaleDateString("ja-JP")]})})]}),(0,a.jsxs)("div",{className:"text-right",children:[(0,a.jsx)("div",{className:"flex items-center gap-2 mb-2",children:(0,a.jsx)(N,{score:e.average_score})}),(0,a.jsx)(x.C,{className:t.color,children:t.label})]})]})}),(0,a.jsx)(d.aY,{children:(0,a.jsxs)("div",{className:"space-y-4",children:[(0,a.jsxs)("div",{className:"grid grid-cols-2 md:grid-cols-5 gap-4",children:[(0,a.jsxs)("div",{className:"text-center p-3 bg-gray-50 rounded-lg",children:[(0,a.jsx)("div",{className:"text-sm text-gray-600 mb-1",children:"納期"}),(0,a.jsx)(N,{score:e.deadline_score})]}),(0,a.jsxs)("div",{className:"text-center p-3 bg-gray-50 rounded-lg",children:[(0,a.jsx)("div",{className:"text-sm text-gray-600 mb-1",children:"成果品の質"}),(0,a.jsx)(N,{score:e.quality_score})]}),(0,a.jsxs)("div",{className:"text-center p-3 bg-gray-50 rounded-lg",children:[(0,a.jsx)("div",{className:"text-sm text-gray-600 mb-1",children:"コミュニケーション"}),(0,a.jsx)(N,{score:e.communication_score})]}),(0,a.jsxs)("div",{className:"text-center p-3 bg-gray-50 rounded-lg",children:[(0,a.jsx)("div",{className:"text-sm text-gray-600 mb-1",children:"理解度"}),(0,a.jsx)(N,{score:e.understanding_score})]}),(0,a.jsxs)("div",{className:"text-center p-3 bg-gray-50 rounded-lg",children:[(0,a.jsx)("div",{className:"text-sm text-gray-600 mb-1",children:"プロフェッショナリズム"}),(0,a.jsx)(N,{score:e.professionalism_score})]})]}),e.comment&&(0,a.jsxs)("div",{className:"border-t pt-4",children:[(0,a.jsxs)("div",{className:"flex items-center gap-2 mb-2",children:[(0,a.jsx)(c.Z,{className:"w-4 h-4 text-gray-600"}),(0,a.jsx)("span",{className:"text-sm font-medium text-gray-700",children:"コメント"})]}),(0,a.jsx)("div",{className:"bg-blue-50 p-4 rounded-lg",children:(0,a.jsxs)("p",{className:"text-gray-700 italic",children:['"',e.comment,'"']})})]})]})})]})},e.id)})})})]})]})}},7403:function(e,s,t){"use strict";t.r(s),t.d(s,{AuthGuard:function(){return d},useRoleAccess:function(){return o},withAuth:function(){return x}});var a=t(57437),r=t(2265),i=t(24033),n=t(65251),l=t(86264),c=t(66210);function d(e){let{children:s,requiredRole:t,allowedRoles:d,redirectTo:x="/auth/login"}=e,{user:o,userRole:m,loading:u}=(0,c.useAuth)(),h=(0,i.useRouter)(),g=(0,i.usePathname)(),j=(0,r.useRef)(!1);return((0,r.useEffect)(()=>{if(!u&&!j.current){if(!o){sessionStorage.setItem("redirectAfterLogin",g),g!==x&&(j.current=!0,h.push(x));return}if(t&&m!==t||d&&d.length>0&&(!m||!d.includes(m))){"/unauthorized"!==g&&(j.current=!0,h.push("/unauthorized"));return}}},[o,m,u,t,d,h,x,g]),u)?(0,a.jsx)("div",{className:"min-h-screen bg-gradient-mesh flex items-center justify-center",children:(0,a.jsxs)(n.E.div,{initial:{opacity:0,scale:.9},animate:{opacity:1,scale:1},className:"text-center",children:[(0,a.jsx)("div",{className:"w-16 h-16 bg-engineering-blue rounded-xl flex items-center justify-center mx-auto mb-4",children:(0,a.jsx)(l.Z,{className:"w-8 h-8 text-white animate-spin"})}),(0,a.jsx)("h2",{className:"text-xl font-semibold text-gray-900 mb-2",children:"認証確認中..."}),(0,a.jsx)("p",{className:"text-gray-600",children:"しばらくお待ちください"})]})}):!o||t&&m!==t||d&&d.length>0&&(!m||!d.includes(m))?null:(0,a.jsx)(a.Fragment,{children:s})}function x(e,s){return function(t){return(0,a.jsx)(d,{requiredRole:s,children:(0,a.jsx)(e,{...t})})}}function o(){let{userRole:e}=(0,c.useAuth)(),s=s=>e===s,t=s=>!!e&&s.includes(e);return{hasRole:s,hasAnyRole:t,isAdmin:()=>s("OrgAdmin"),isStaff:()=>s("Staff"),isContractor:()=>s("Contractor"),isReviewer:()=>s("Reviewer"),isAuditor:()=>s("Auditor"),canManageProjects:()=>t(["OrgAdmin","Staff"]),canViewFinancials:()=>t(["OrgAdmin","Staff","Auditor"]),canReviewProjects:()=>t(["Reviewer","OrgAdmin"]),canViewAuditLogs:()=>t(["Auditor","OrgAdmin"])}}}},function(e){e.O(0,[778,402,440,250,677,650,971,938,744],function(){return e(e.s=41787)}),_N_E=e.O()}]);