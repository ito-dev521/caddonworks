(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[178],{22505:function(e,a,s){"use strict";s.d(a,{Z:function(){return r}});/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let r=(0,s(62898).Z)("Award",[["circle",{cx:"12",cy:"8",r:"6",key:"1vp47v"}],["path",{d:"M15.477 12.89 17 22l-5-3-5 3 1.523-9.11",key:"em7aur"}]])},22812:function(e,a,s){"use strict";s.d(a,{Z:function(){return r}});/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let r=(0,s(62898).Z)("Building",[["rect",{width:"16",height:"20",x:"4",y:"2",rx:"2",ry:"2",key:"76otgf"}],["path",{d:"M9 22v-4h6v4",key:"r93iot"}],["path",{d:"M8 6h.01",key:"1dz90k"}],["path",{d:"M16 6h.01",key:"1x0f13"}],["path",{d:"M12 6h.01",key:"1vi96p"}],["path",{d:"M12 10h.01",key:"1nrarc"}],["path",{d:"M12 14h.01",key:"1etili"}],["path",{d:"M16 10h.01",key:"1m94wz"}],["path",{d:"M16 14h.01",key:"1gbofw"}],["path",{d:"M8 10h.01",key:"19clt8"}],["path",{d:"M8 14h.01",key:"6423bh"}]])},28203:function(e,a,s){"use strict";s.d(a,{Z:function(){return r}});/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let r=(0,s(62898).Z)("Calendar",[["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",ry:"2",key:"eu3xkr"}],["line",{x1:"16",x2:"16",y1:"2",y2:"6",key:"m3sa8f"}],["line",{x1:"8",x2:"8",y1:"2",y2:"6",key:"18kwsl"}],["line",{x1:"3",x2:"21",y1:"10",y2:"10",key:"xt86sb"}]])},13008:function(e,a,s){"use strict";s.d(a,{Z:function(){return r}});/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let r=(0,s(62898).Z)("CheckCircle",[["path",{d:"M22 11.08V12a10 10 0 1 1-5.93-9.14",key:"g774vq"}],["path",{d:"m9 11 3 3L22 4",key:"1pflzl"}]])},6141:function(e,a,s){"use strict";s.d(a,{Z:function(){return r}});/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let r=(0,s(62898).Z)("Clock",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["polyline",{points:"12 6 12 12 16 14",key:"68esgv"}]])},49168:function(e,a,s){"use strict";s.d(a,{Z:function(){return r}});/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let r=(0,s(62898).Z)("Crown",[["path",{d:"m2 4 3 12h14l3-12-6 7-4-7-4 7-6-7zm3 16h14",key:"zkxr6b"}]])},41298:function(e,a,s){"use strict";s.d(a,{Z:function(){return r}});/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let r=(0,s(62898).Z)("DollarSign",[["line",{x1:"12",x2:"12",y1:"2",y2:"22",key:"7eqyqh"}],["path",{d:"M17 5H9.5a3.5 3.5 0 0 0 0 7h5a3.5 3.5 0 0 1 0 7H6",key:"1b0p4s"}]])},97982:function(e,a,s){"use strict";s.d(a,{Z:function(){return r}});/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let r=(0,s(62898).Z)("FileCheck",[["path",{d:"M14.5 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7.5L14.5 2z",key:"1nnpy2"}],["polyline",{points:"14 2 14 8 20 8",key:"1ew0cm"}],["path",{d:"m9 15 2 2 4-4",key:"1grp1n"}]])},86264:function(e,a,s){"use strict";s.d(a,{Z:function(){return r}});/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let r=(0,s(62898).Z)("Loader2",[["path",{d:"M21 12a9 9 0 1 1-6.219-8.56",key:"13zald"}]])},96142:function(e,a,s){"use strict";s.d(a,{Z:function(){return r}});/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let r=(0,s(62898).Z)("MapPin",[["path",{d:"M20 10c0 6-8 12-8 12s-8-6-8-12a8 8 0 0 1 16 0Z",key:"2oe9fu"}],["circle",{cx:"12",cy:"10",r:"3",key:"ilqhr7"}]])},49617:function(e,a,s){"use strict";s.d(a,{Z:function(){return r}});/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let r=(0,s(62898).Z)("PenSquare",[["path",{d:"M11 4H4a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7",key:"1qinfi"}],["path",{d:"M18.5 2.5a2.12 2.12 0 0 1 3 3L12 15l-4 1 1-4Z",key:"w2jsv5"}]])},12741:function(e,a,s){"use strict";s.d(a,{Z:function(){return r}});/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let r=(0,s(62898).Z)("Phone",[["path",{d:"M22 16.92v3a2 2 0 0 1-2.18 2 19.79 19.79 0 0 1-8.63-3.07 19.5 19.5 0 0 1-6-6 19.79 19.79 0 0 1-3.07-8.67A2 2 0 0 1 4.11 2h3a2 2 0 0 1 2 1.72 12.84 12.84 0 0 0 .7 2.81 2 2 0 0 1-.45 2.11L8.09 9.91a16 16 0 0 0 6 6l1.27-1.27a2 2 0 0 1 2.11-.45 12.84 12.84 0 0 0 2.81.7A2 2 0 0 1 22 16.92z",key:"foiqr5"}]])},9883:function(e,a,s){"use strict";s.d(a,{Z:function(){return r}});/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let r=(0,s(62898).Z)("Plus",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]])},92295:function(e,a,s){"use strict";s.d(a,{Z:function(){return r}});/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let r=(0,s(62898).Z)("Save",[["path",{d:"M19 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h11l5 5v11a2 2 0 0 1-2 2z",key:"1owoqh"}],["polyline",{points:"17 21 17 13 7 13 7 21",key:"1md35c"}],["polyline",{points:"7 3 7 8 15 8",key:"8nz8an"}]])},49036:function(e,a,s){"use strict";s.d(a,{Z:function(){return r}});/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let r=(0,s(62898).Z)("Shield",[["path",{d:"M12 22s8-4 8-10V5l-8-3-8 3v7c0 6 8 10 8 10",key:"1irkt0"}]])},66654:function(e,a,s){"use strict";s.d(a,{Z:function(){return r}});/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let r=(0,s(62898).Z)("Target",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["circle",{cx:"12",cy:"12",r:"6",key:"1vlfrh"}],["circle",{cx:"12",cy:"12",r:"2",key:"1c9p78"}]])},85790:function(e,a,s){"use strict";s.d(a,{Z:function(){return r}});/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let r=(0,s(62898).Z)("TrendingUp",[["polyline",{points:"22 7 13.5 15.5 8.5 10.5 2 17",key:"126l90"}],["polyline",{points:"16 7 22 7 22 13",key:"kwv8wd"}]])},52431:function(e,a,s){"use strict";s.d(a,{Z:function(){return r}});/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let r=(0,s(62898).Z)("UserCheck",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["polyline",{points:"16 11 18 13 22 9",key:"1pwet4"}]])},52369:function(e,a,s){"use strict";s.d(a,{Z:function(){return r}});/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let r=(0,s(62898).Z)("Zap",[["polygon",{points:"13 2 3 14 12 14 11 22 21 10 12 10 13 2",key:"45s27k"}]])},98378:function(e,a,s){Promise.resolve().then(s.bind(s,94591))},94591:function(e,a,s){"use strict";s.r(a),s.d(a,{default:function(){return ei}});var r=s(57437),t=s(2265),n=s(65251),l=s(49617),i=s(92295),c=s(82549),d=s(67972),o=s(62898);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let u=(0,o.Z)("Camera",[["path",{d:"M14.5 4h-5L7 7H4a2 2 0 0 0-2 2v9a2 2 0 0 0 2 2h16a2 2 0 0 0 2-2V9a2 2 0 0 0-2-2h-3l-2.5-3z",key:"1tc9qg"}],["circle",{cx:"12",cy:"13",r:"3",key:"1vg3eu"}]]);var m=s(22505),x=s(9883),h=s(22812),g=s(7403),p=s(65592),y=s(575),b=s(15671),f=s(33277),j=s(66210),v=s(14958),N=s(14374),k=s(12741);function w(){let{userProfile:e,userRole:a}=(0,j.useAuth)(),[s,d]=(0,t.useState)(null),[o,u]=(0,t.useState)(!1),[m,x]=(0,t.useState)(!0),[g,p]=(0,t.useState)(!1),[f,N]=(0,t.useState)({id:"",name:"",description:"",address:"",phone:"",email:"",website:"",employee_count:0,business_type:"",registration_number:"",contact_person:"",created_at:"",updated_at:""}),w=async()=>{try{x(!0);let{data:{session:e}}=await v.OQ.auth.getSession();if(!e)throw Error("セッションが見つかりません");let a=await fetch("/api/organization/profile",{headers:{Authorization:"Bearer ".concat(e.access_token),"Content-Type":"application/json"}});if(!a.ok)throw Error("組織情報の取得に失敗しました");let s=await a.json();d(s.organization),N(s.organization)}catch(e){console.error("組織情報取得エラー:",e),alert("組織情報の取得に失敗しました")}finally{x(!1)}},_=async()=>{try{p(!0);let{data:{session:e}}=await v.OQ.auth.getSession();if(!e)throw Error("セッションが見つかりません");let a=await fetch("/api/organization/profile",{method:"PUT",headers:{Authorization:"Bearer ".concat(e.access_token),"Content-Type":"application/json"},body:JSON.stringify({organizationData:f})});if(!a.ok)throw Error("組織情報の更新に失敗しました");let s=await a.json();d(s.organization),u(!1),alert("組織情報が正常に更新されました")}catch(e){console.error("組織情報保存エラー:",e),alert("組織情報の更新に失敗しました")}finally{p(!1)}};return((0,t.useEffect)(()=>{w()},[]),m)?(0,r.jsxs)("div",{className:"text-center py-8",children:[(0,r.jsx)("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-engineering-blue mx-auto"}),(0,r.jsx)("p",{className:"mt-4 text-gray-600",children:"読み込み中..."})]}):(0,r.jsxs)("div",{className:"space-y-6",children:[(0,r.jsx)(n.E.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.5},children:(0,r.jsxs)("div",{className:"flex items-center justify-between",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("h1",{className:"text-3xl font-bold text-gray-900",children:"法人プロフィール"}),(0,r.jsx)("p",{className:"text-gray-600 mt-2",children:"組織の基本情報を管理します"})]}),(0,r.jsx)("div",{className:"flex gap-3",children:o?(0,r.jsxs)(r.Fragment,{children:[(0,r.jsxs)(y.z,{onClick:_,disabled:g,className:"bg-engineering-blue hover:bg-engineering-blue/90",children:[(0,r.jsx)(i.Z,{className:"w-4 h-4 mr-2"}),g?"保存中...":"保存"]}),(0,r.jsxs)(y.z,{variant:"outline",onClick:()=>{N(s||f),u(!1)},disabled:g,children:[(0,r.jsx)(c.Z,{className:"w-4 h-4 mr-2"}),"キャンセル"]})]}):(0,r.jsxs)(y.z,{onClick:()=>u(!0),className:"bg-engineering-blue hover:bg-engineering-blue/90",children:[(0,r.jsx)(l.Z,{className:"w-4 h-4 mr-2"}),"編集"]})})]})}),(0,r.jsx)(n.E.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.1},children:(0,r.jsxs)(b.Zb,{className:"hover-lift",children:[(0,r.jsxs)(b.Ol,{children:[(0,r.jsxs)(b.ll,{className:"flex items-center gap-2",children:[(0,r.jsx)(h.Z,{className:"w-5 h-5"}),"基本情報"]}),(0,r.jsx)(b.SZ,{children:"法人の基本情報を入力してください"})]}),(0,r.jsxs)(b.aY,{className:"space-y-4",children:[(0,r.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"法人名 *"}),o?(0,r.jsx)("input",{type:"text",value:f.name,onChange:e=>N(a=>({...a,name:e.target.value})),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-engineering-blue focus:border-transparent",placeholder:"株式会社サンプル",required:!0}):(0,r.jsx)("p",{className:"text-gray-900",children:(null==s?void 0:s.name)||"未設定"})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"事業種別"}),o?(0,r.jsx)("input",{type:"text",value:f.business_type,onChange:e=>N(a=>({...a,business_type:e.target.value})),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-engineering-blue focus:border-transparent",placeholder:"建設業"}):(0,r.jsx)("p",{className:"text-gray-900",children:(null==s?void 0:s.business_type)||"未設定"})]})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"法人番号"}),o?(0,r.jsx)("input",{type:"text",value:f.registration_number,onChange:e=>N(a=>({...a,registration_number:e.target.value})),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-engineering-blue focus:border-transparent",placeholder:"1234567890123"}):(0,r.jsx)("p",{className:"text-gray-900",children:(null==s?void 0:s.registration_number)||"未設定"})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"担当者名"}),o?(0,r.jsx)("input",{type:"text",value:f.contact_person,onChange:e=>N(a=>({...a,contact_person:e.target.value})),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-engineering-blue focus:border-transparent",placeholder:"管理者デモ"}):(0,r.jsx)("p",{className:"text-gray-900",children:(null==s?void 0:s.contact_person)||"未設定"})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"従業員数"}),o?(0,r.jsx)("input",{type:"number",min:"0",value:f.employee_count,onChange:e=>N(a=>({...a,employee_count:Number(e.target.value)})),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-engineering-blue focus:border-transparent",placeholder:"50"}):(0,r.jsx)("p",{className:"text-gray-900",children:(null==s?void 0:s.employee_count)?"".concat(s.employee_count,"名"):"未設定"})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"事業内容"}),o?(0,r.jsx)("textarea",{value:f.description,onChange:e=>N(a=>({...a,description:e.target.value})),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-engineering-blue focus:border-transparent",rows:3,placeholder:"土木設計、建設コンサルタント業務など"}):(0,r.jsx)("p",{className:"text-gray-900 whitespace-pre-wrap",children:(null==s?void 0:s.description)||"未設定"})]})]})]})}),(0,r.jsx)(n.E.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.2},children:(0,r.jsxs)(b.Zb,{className:"hover-lift",children:[(0,r.jsxs)(b.Ol,{children:[(0,r.jsxs)(b.ll,{className:"flex items-center gap-2",children:[(0,r.jsx)(k.Z,{className:"w-5 h-5"}),"連絡先情報"]}),(0,r.jsx)(b.SZ,{children:"法人の連絡先情報を入力してください"})]}),(0,r.jsxs)(b.aY,{className:"space-y-4",children:[(0,r.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"電話番号"}),o?(0,r.jsx)("input",{type:"tel",value:f.phone,onChange:e=>N(a=>({...a,phone:e.target.value})),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-engineering-blue focus:border-transparent",placeholder:"03-1234-5678"}):(0,r.jsx)("p",{className:"text-gray-900",children:(null==s?void 0:s.phone)||"未設定"})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"メールアドレス"}),o?(0,r.jsx)("input",{type:"email",value:f.email,onChange:e=>N(a=>({...a,email:e.target.value})),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-engineering-blue focus:border-transparent",placeholder:"info@company.com"}):(0,r.jsx)("p",{className:"text-gray-900",children:(null==s?void 0:s.email)||"未設定"})]})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"住所"}),o?(0,r.jsx)("input",{type:"text",value:f.address,onChange:e=>N(a=>({...a,address:e.target.value})),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-engineering-blue focus:border-transparent",placeholder:"東京都渋谷区..."}):(0,r.jsx)("p",{className:"text-gray-900",children:(null==s?void 0:s.address)||"未設定"})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"ウェブサイト"}),o?(0,r.jsx)("input",{type:"url",value:f.website,onChange:e=>N(a=>({...a,website:e.target.value})),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-engineering-blue focus:border-transparent",placeholder:"https://www.company.com"}):(0,r.jsx)("p",{className:"text-gray-900",children:(null==s?void 0:s.website)?(0,r.jsx)("a",{href:s.website,target:"_blank",rel:"noopener noreferrer",className:"text-engineering-blue hover:underline",children:s.website}):"未設定"})]})]})]})})]})}var _=s(55340);function Z(e){let{evaluations:a,loading:s}=e;if(s)return(0,r.jsxs)(b.Zb,{children:[(0,r.jsx)(b.Ol,{children:(0,r.jsxs)(b.ll,{className:"flex items-center gap-2",children:[(0,r.jsx)(_.Z,{className:"w-5 h-5 text-yellow-500"}),"受注者評価"]})}),(0,r.jsx)(b.aY,{children:(0,r.jsxs)("div",{className:"text-center py-4",children:[(0,r.jsx)("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600 mx-auto mb-2"}),(0,r.jsx)("p",{className:"text-gray-600",children:"評価データを読み込み中..."})]})})]});if(!a||0===a.length)return(0,r.jsxs)(b.Zb,{children:[(0,r.jsx)(b.Ol,{children:(0,r.jsxs)(b.ll,{className:"flex items-center gap-2",children:[(0,r.jsx)(_.Z,{className:"w-5 h-5 text-yellow-500"}),"受注者評価"]})}),(0,r.jsx)(b.aY,{children:(0,r.jsxs)("div",{className:"text-center py-8",children:[(0,r.jsx)(_.Z,{className:"w-12 h-12 text-gray-300 mx-auto mb-4"}),(0,r.jsx)("p",{className:"text-gray-600",children:"まだ評価がありません"}),(0,r.jsx)("p",{className:"text-sm text-gray-500 mt-2",children:"案件完了後に発注者からの評価が表示されます"})]})})]});let t=a.length,n=a.reduce((e,a)=>e+a.average_score,0)/t,l=a.reduce((e,a)=>e+a.deadline_score,0)/t,i=a.reduce((e,a)=>e+a.quality_score,0)/t,c=a.reduce((e,a)=>e+a.communication_score,0)/t,d=a.reduce((e,a)=>e+a.understanding_score,0)/t,o=a.reduce((e,a)=>e+a.professionalism_score,0)/t,u=e=>{let{score:a,label:s}=e;return(0,r.jsxs)("div",{className:"flex items-center justify-between py-2",children:[(0,r.jsx)("span",{className:"text-sm font-medium text-gray-700",children:s}),(0,r.jsxs)("div",{className:"flex items-center gap-1",children:[(0,r.jsx)("div",{className:"flex",children:[1,2,3,4,5].map(e=>(0,r.jsx)(_.Z,{className:"w-4 h-4 ".concat(e<=Math.round(a)?"text-yellow-400 fill-yellow-400":"text-gray-300")},e))}),(0,r.jsx)("span",{className:"text-sm text-gray-600 ml-2",children:a.toFixed(1)})]})]})};return(0,r.jsxs)(b.Zb,{children:[(0,r.jsx)(b.Ol,{children:(0,r.jsxs)(b.ll,{className:"flex items-center gap-2",children:[(0,r.jsx)(_.Z,{className:"w-5 h-5 text-yellow-500"}),"受注者評価"]})}),(0,r.jsxs)(b.aY,{className:"space-y-6",children:[(0,r.jsxs)("div",{className:"text-center p-4 bg-gradient-to-r from-yellow-50 to-orange-50 rounded-lg",children:[(0,r.jsxs)("div",{className:"flex items-center justify-center gap-2 mb-2",children:[(0,r.jsx)(_.Z,{className:"w-6 h-6 text-yellow-500 fill-yellow-500"}),(0,r.jsx)("span",{className:"text-2xl font-bold text-gray-900",children:n.toFixed(1)}),(0,r.jsx)("span",{className:"text-gray-600",children:"/ 5.0"})]}),(0,r.jsxs)("p",{className:"text-sm text-gray-600",children:[t,"件の評価"]}),(0,r.jsx)(f.C,{variant:"secondary",className:"mt-2",children:"総合評価"})]}),(0,r.jsxs)("div",{className:"space-y-1",children:[(0,r.jsx)("h4",{className:"font-medium text-gray-900 mb-3",children:"詳細評価"}),(0,r.jsx)(u,{score:l,label:"納期"}),(0,r.jsx)(u,{score:i,label:"成果品の質"}),(0,r.jsx)(u,{score:c,label:"コミュニケーション"}),(0,r.jsx)(u,{score:d,label:"理解度"}),(0,r.jsx)(u,{score:o,label:"プロフェッショナリズム"})]})]})]})}/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let M=(0,o.Z)("Trophy",[["path",{d:"M6 9H4.5a2.5 2.5 0 0 1 0-5H6",key:"17hqa7"}],["path",{d:"M18 9h1.5a2.5 2.5 0 0 0 0-5H18",key:"lmptdp"}],["path",{d:"M4 22h16",key:"57wxv0"}],["path",{d:"M10 14.66V17c0 .55-.47.98-.97 1.21C7.85 18.75 7 20.24 7 22",key:"1nw9bq"}],["path",{d:"M14 14.66V17c0 .55.47.98.97 1.21C16.15 18.75 17 20.24 17 22",key:"1np0yb"}],["path",{d:"M18 2H6v7a6 6 0 0 0 12 0V2Z",key:"u46fv3"}]]);var C=s(49168),z=s(52369),q=s(66654),S=s(85790);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let A=(0,o.Z)("Waves",[["path",{d:"M2 6c.6.5 1.2 1 2.5 1C7 7 7 5 9.5 5c2.6 0 2.4 2 5 2 2.5 0 2.5-2 5-2 1.3 0 1.9.5 2.5 1",key:"knzxuh"}],["path",{d:"M2 12c.6.5 1.2 1 2.5 1 2.5 0 2.5-2 5-2 2.6 0 2.4 2 5 2 2.5 0 2.5-2 5-2 1.3 0 1.9.5 2.5 1",key:"2jd2cc"}],["path",{d:"M2 18c.6.5 1.2 1 2.5 1 2.5 0 2.5-2 5-2 2.6 0 2.4 2 5 2 2.5 0 2.5-2 5-2 1.3 0 1.9.5 2.5 1",key:"rd2r6e"}]]),O=(0,o.Z)("Mountain",[["path",{d:"m8 3 4 8 5-5 5 15H2L8 3z",key:"otkl63"}]]),E=(0,o.Z)("Droplets",[["path",{d:"M7 16.3c2.2 0 4-1.83 4-4.05 0-1.16-.57-2.26-1.71-3.19S7.29 6.75 7 5.3c-.29 1.45-1.14 2.84-2.29 3.76S3 11.1 3 12.25c0 2.22 1.8 4.05 4 4.05z",key:"1ptgy4"}],["path",{d:"M12.56 6.6A10.97 10.97 0 0 0 14 3.02c.5 2.5 2 4.9 4 6.5s3 3.5 3 5.5a6.98 6.98 0 0 1-11.91 4.97",key:"1sl1rz"}]]),L=(0,o.Z)("Monitor",[["rect",{width:"20",height:"14",x:"2",y:"3",rx:"2",key:"48i651"}],["line",{x1:"8",x2:"16",y1:"21",y2:"21",key:"1svkeh"}],["line",{x1:"12",x2:"12",y1:"17",y2:"21",key:"vw1qmm"}]]),H=(0,o.Z)("Calculator",[["rect",{width:"16",height:"20",x:"4",y:"2",rx:"2",key:"1nb95v"}],["line",{x1:"8",x2:"16",y1:"6",y2:"6",key:"x4nwl0"}],["line",{x1:"16",x2:"16",y1:"14",y2:"18",key:"wjye3r"}],["path",{d:"M16 10h.01",key:"1m94wz"}],["path",{d:"M12 10h.01",key:"1nrarc"}],["path",{d:"M8 10h.01",key:"19clt8"}],["path",{d:"M12 14h.01",key:"1etili"}],["path",{d:"M8 14h.01",key:"6423bh"}],["path",{d:"M12 18h.01",key:"mhygvu"}],["path",{d:"M8 18h.01",key:"lrp35t"}]]);var P=s(96142),Y=s(32176),T=s(25750),V=s(6141);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let D=(0,o.Z)("Presentation",[["path",{d:"M2 3h20",key:"91anmk"}],["path",{d:"M21 3v11a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V3",key:"2k9sn8"}],["path",{d:"m7 21 5-5 5 5",key:"bip4we"}]]);var R=s(13008),F=s(97982),B=s(76637),Q=s(49036);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let U=(0,o.Z)("Leaf",[["path",{d:"M11 20A7 7 0 0 1 9.8 6.1C15.5 5 17 4.48 19 2c1 2 2 4.18 2 8 0 5.5-4.78 10-10 10Z",key:"nnexq3"}],["path",{d:"M2 21c0-3 1.85-5.36 5.08-6C9.5 14.52 12 13 13 12",key:"mt58a7"}]]),W=(0,o.Z)("Sun",[["circle",{cx:"12",cy:"12",r:"4",key:"4exip2"}],["path",{d:"M12 2v2",key:"tus03m"}],["path",{d:"M12 20v2",key:"1lh1kg"}],["path",{d:"m4.93 4.93 1.41 1.41",key:"149t6j"}],["path",{d:"m17.66 17.66 1.41 1.41",key:"ptbguv"}],["path",{d:"M2 12h2",key:"1t8f8n"}],["path",{d:"M20 12h2",key:"1q8mjw"}],["path",{d:"m6.34 17.66-1.41 1.41",key:"1m8zz5"}],["path",{d:"m19.07 4.93-1.41 1.41",key:"1shlcs"}]]),G=(0,o.Z)("Snowflake",[["line",{x1:"2",x2:"22",y1:"12",y2:"12",key:"1dnqot"}],["line",{x1:"12",x2:"12",y1:"2",y2:"22",key:"7eqyqh"}],["path",{d:"m20 16-4-4 4-4",key:"rquw4f"}],["path",{d:"m4 8 4 4-4 4",key:"12s3z9"}],["path",{d:"m16 4-4 4-4-4",key:"1tumq1"}],["path",{d:"m8 20 4-4 4 4",key:"9p200w"}]]);var I=s(28203);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let J=(0,o.Z)("Map",[["polygon",{points:"3 6 9 3 15 6 21 3 21 18 15 21 9 18 3 21",key:"ok2ie8"}],["line",{x1:"9",x2:"9",y1:"3",y2:"18",key:"w34qz5"}],["line",{x1:"15",x2:"15",y1:"6",y2:"21",key:"volv9a"}]]);var $=s(41298);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let K=(0,o.Z)("Sparkles",[["path",{d:"m12 3-1.912 5.813a2 2 0 0 1-1.275 1.275L3 12l5.813 1.912a2 2 0 0 1 1.275 1.275L12 21l1.912-5.813a2 2 0 0 1 1.275-1.275L21 12l-5.813-1.912a2 2 0 0 1-1.275-1.275L12 3Z",key:"17u4zn"}],["path",{d:"M5 3v4",key:"bklmnn"}],["path",{d:"M19 17v4",key:"iiml17"}],["path",{d:"M3 5h4",key:"nem4j1"}],["path",{d:"M17 19h4",key:"lbex7p"}]]),X=(0,o.Z)("Lightbulb",[["path",{d:"M15 14c.2-1 .7-1.7 1.5-2.5 1-.9 1.5-2.2 1.5-3.5A6 6 0 0 0 6 8c0 1 .2 2.2 1.5 3.5.7.7 1.3 1.5 1.5 2.5",key:"1gvzjb"}],["path",{d:"M9 18h6",key:"x1upvd"}],["path",{d:"M10 22h4",key:"ceow96"}]]);var ee=s(52431);let ea={first_project:m.Z,project_master:_.Z,project_expert:M,project_legend:C.Z,streak_3m:z.Z,speed_star:z.Z,perfectionist:q.Z,growing_star:S.Z,bridge_designer:h.Z,road_designer:h.Z,building_designer:h.Z,river_designer:A,tunnel_designer:O,electrical_designer:z.Z,water_designer:E,cad_master:L,structural_engineer:H,surveyor:P.Z,bim_specialist:h.Z,communicator:Y.Z,team_player:T.Z,response_king:V.Z,presenter:D,quality_manager:R.Z,checker:F.Z,document_master:B.Z,safety_designer:Q.Z,spring_designer:U,summer_designer:W,autumn_designer:U,winter_designer:G,new_year_challenger:I.Z,urban_designer:h.Z,rural_designer:J,mega_project:h.Z,local_expert:P.Z,millionaire:$.Z,billionaire:$.Z,growth_stock:S.Z,goal_achiever:q.Z,platform_mvp:C.Z,superstar:K,innovator:X,mentor:ee.Z},es={bronze:{bg:"bg-amber-100",border:"border-amber-300",text:"text-amber-800",icon:"text-amber-600"},silver:{bg:"bg-gray-100",border:"border-gray-300",text:"text-gray-800",icon:"text-gray-600"},gold:{bg:"bg-yellow-100",border:"border-yellow-300",text:"text-yellow-800",icon:"text-yellow-600"},platinum:{bg:"bg-blue-100",border:"border-blue-300",text:"text-blue-800",icon:"text-blue-600"},rainbow:{bg:"bg-gradient-to-r from-pink-100 via-purple-100 to-indigo-100",border:"border-purple-300",text:"text-purple-800",icon:"text-purple-600"}},er={sm:{container:"w-8 h-8",icon:"w-4 h-4"},md:{container:"w-12 h-12",icon:"w-6 h-6"},lg:{container:"w-16 h-16",icon:"w-8 h-8"}};function et(e){let{iconName:a,tier:s,size:t="md",className:n=""}=e,l=ea[a]||m.Z,i=es[s],c=er[t];return(0,r.jsx)("div",{className:"\n        ".concat(c.container,"\n        ").concat(i.bg,"\n        ").concat(i.border,"\n        border-2\n        rounded-full\n        flex\n        items-center\n        justify-center\n        shadow-sm\n        ").concat(n,"\n      "),title:"".concat(a," (").concat(s,")"),children:(0,r.jsx)(l,{className:"".concat(c.icon," ").concat(i.icon)})})}function en(e){let{name:a,description:s,tier:t,earnedAt:n}=e;return(0,r.jsxs)("div",{className:"bg-white p-3 rounded-lg shadow-lg border max-w-xs",children:[(0,r.jsxs)("div",{className:"flex items-center gap-2 mb-2",children:[(0,r.jsx)(et,{iconName:"award",tier:t,size:"sm"}),(0,r.jsx)("h4",{className:"font-semibold text-gray-900",children:a})]}),(0,r.jsx)("p",{className:"text-sm text-gray-600 mb-2",children:s}),(0,r.jsxs)("div",{className:"flex items-center justify-between text-xs text-gray-500",children:[(0,r.jsx)("span",{className:"capitalize",children:t}),n&&(0,r.jsx)("span",{children:new Date(n).toLocaleDateString("ja-JP")})]})]})}function el(e){let{badges:a,loading:s=!1,showAll:l=!1,maxDisplay:i=12}=e,[c,d]=(0,t.useState)(null),[o,u]=(0,t.useState)(!1);if(s)return(0,r.jsxs)(b.Zb,{children:[(0,r.jsx)(b.Ol,{children:(0,r.jsxs)(b.ll,{className:"flex items-center gap-2",children:[(0,r.jsx)(M,{className:"w-5 h-5 text-yellow-500"}),"バッジコレクション"]})}),(0,r.jsx)(b.aY,{children:(0,r.jsx)("div",{className:"grid grid-cols-4 md:grid-cols-6 lg:grid-cols-8 gap-4",children:Array.from({length:8}).map((e,a)=>(0,r.jsx)("div",{className:"w-12 h-12 bg-gray-200 rounded-full animate-pulse"},a))})})]});if(!a||0===a.length)return(0,r.jsxs)(b.Zb,{children:[(0,r.jsx)(b.Ol,{children:(0,r.jsxs)(b.ll,{className:"flex items-center gap-2",children:[(0,r.jsx)(M,{className:"w-5 h-5 text-yellow-500"}),"バッジコレクション"]})}),(0,r.jsx)(b.aY,{children:(0,r.jsxs)("div",{className:"text-center py-8",children:[(0,r.jsx)(m.Z,{className:"w-12 h-12 text-gray-300 mx-auto mb-4"}),(0,r.jsx)("p",{className:"text-gray-600",children:"まだバッジがありません"}),(0,r.jsx)("p",{className:"text-sm text-gray-500 mt-2",children:"案件を完了してバッジを獲得しましょう"})]})})]});let x=a.reduce((e,a)=>{let s=a.badges.tier;return e[s]||(e[s]=[]),e[s].push(a),e},{}),h={rainbow:"レア",platinum:"プラチナ",gold:"ゴールド",silver:"シルバー",bronze:"ブロンズ"},g=l?a:a.slice(0,i);return(0,r.jsxs)(b.Zb,{children:[(0,r.jsx)(b.Ol,{children:(0,r.jsxs)(b.ll,{className:"flex items-center gap-2",children:[(0,r.jsx)(M,{className:"w-5 h-5 text-yellow-500"}),"バッジコレクション",(0,r.jsxs)(f.C,{variant:"secondary",className:"ml-2",children:[a.length,"個"]})]})}),(0,r.jsxs)(b.aY,{className:"space-y-6",children:[(0,r.jsx)("div",{className:"grid grid-cols-2 md:grid-cols-5 gap-3",children:["rainbow","platinum","gold","silver","bronze"].map(e=>{var a;let s=(null===(a=x[e])||void 0===a?void 0:a.length)||0;return 0===s?null:(0,r.jsxs)("div",{className:"text-center p-3 bg-gray-50 rounded-lg",children:[(0,r.jsx)("div",{className:"text-lg font-bold text-gray-900",children:s}),(0,r.jsx)("div",{className:"text-xs text-gray-600",children:h[e]})]},e)})}),(0,r.jsx)("div",{className:"grid grid-cols-4 md:grid-cols-6 lg:grid-cols-8 gap-4",children:g.map((e,a)=>(0,r.jsxs)(n.E.div,{initial:{opacity:0,scale:.8},animate:{opacity:1,scale:1},transition:{delay:.05*a},className:"relative",children:[(0,r.jsx)("div",{className:"cursor-pointer hover:scale-110 transition-transform",onMouseEnter:()=>{d(e),u(!0)},onMouseLeave:()=>u(!1),onClick:()=>{d(e),u(!o)},children:(0,r.jsx)(et,{iconName:e.badges.icon_name,tier:e.badges.tier,size:"md"})}),o&&(null==c?void 0:c.id)===e.id&&(0,r.jsx)("div",{className:"absolute z-10 top-full left-1/2 transform -translate-x-1/2 mt-2",children:(0,r.jsx)(en,{name:e.badges.name,description:e.badges.description,tier:e.badges.tier,earnedAt:e.earned_at})})]},e.id))}),!l&&a.length>i&&(0,r.jsx)("div",{className:"text-center",children:(0,r.jsxs)("button",{className:"text-sm text-blue-600 hover:text-blue-800",children:["+",a.length-i,"個のバッジを表示"]})}),a.length>0&&(0,r.jsxs)("div",{className:"border-t pt-4",children:[(0,r.jsx)("h4",{className:"font-medium text-gray-900 mb-3",children:"最近獲得したバッジ"}),(0,r.jsx)("div",{className:"flex gap-3 overflow-x-auto pb-2",children:a.sort((e,a)=>new Date(a.earned_at).getTime()-new Date(e.earned_at).getTime()).slice(0,5).map(e=>(0,r.jsx)("div",{className:"flex-shrink-0",children:(0,r.jsx)(et,{iconName:e.badges.icon_name,tier:e.badges.tier,size:"sm"})},e.id))})]})]})]})}function ei(){return(0,r.jsx)(g.AuthGuard,{children:(0,r.jsx)(ec,{})})}function ec(){var e,a;let{user:s,userProfile:o,userRole:g,updateProfile:k}=(0,j.useAuth)(),[_,M]=(0,t.useState)(!1),[C,z]=(0,t.useState)(!1),[q,S]=(0,t.useState)(!1),[A,O]=(0,t.useState)(null),[E,L]=(0,t.useState)(!1),[H,P]=(0,t.useState)([]),[Y,T]=(0,t.useState)(!1),[V,D]=(0,t.useState)({display_name:(null==o?void 0:o.display_name)||"",specialties:(null==o?void 0:o.specialties)||[],qualifications:(null==o?void 0:o.qualifications)||[],experience_years:(null==o?void 0:o.experience_years)||"",phone:"",location:"",bio:"",linkedin:"",github:"",formal_name:(null==o?void 0:o.formal_name)||"",postal_code:(null==o?void 0:o.postal_code)||"",address:(null==o?void 0:o.address)||"",address_detail:(null==o?void 0:o.address_detail)||"",phone_number:(null==o?void 0:o.phone_number)||"",company_number:(null==o?void 0:o.company_number)||"",registration_number:(null==o?void 0:o.registration_number)||""}),R=async()=>{if(!V.formal_name.trim()){alert("氏名を入力してください");return}if(!V.phone_number.trim()){alert("電話番号を入力してください");return}if(!V.address.trim()){alert("住所を入力してください");return}if(!V.address_detail.trim()){alert("住所（その他）を入力してください");return}if(V.specialties.some(e=>"未経験"!==e)&&!V.experience_years.trim()){alert("未経験以外の専門分野を選択した場合は経験年数を入力してください");return}z(!0);try{await k({display_name:V.display_name,specialties:V.specialties,qualifications:V.qualifications,experience_years:V.experience_years||void 0,formal_name:V.formal_name||void 0,postal_code:V.postal_code||void 0,address:V.address||void 0,address_detail:V.address_detail||void 0,phone_number:V.phone_number||void 0,company_number:V.company_number||void 0,registration_number:V.registration_number||void 0}),M(!1),alert("プロフィールが正常に更新されました")}catch(e){console.error("Error updating profile:",e),alert("プロフィールの更新に失敗しました: "+(e instanceof Error?e.message:"不明なエラー"))}finally{z(!1)}},F=async()=>{if(o&&"Contractor"===g){L(!0);try{let{data:{session:e}}=await v.OQ.auth.getSession();if(!e)return;let a=await fetch("/api/evaluations/contractor?contractor_id=".concat(o.id),{headers:{Authorization:"Bearer ".concat(e.access_token)}});if(a.ok){let e=await a.json();O(e.evaluations||[])}}catch(e){console.error("評価データ取得エラー:",e)}finally{L(!1)}}},B=async()=>{if(o){T(!0);try{let{data:{session:e}}=await v.OQ.auth.getSession();if(!e)return;let a=await fetch("/api/badges/user/".concat(o.id),{headers:{Authorization:"Bearer ".concat(e.access_token)}});if(a.ok){let e=await a.json();P(e.badges||[])}}catch(e){console.error("バッジデータ取得エラー:",e)}finally{T(!1)}}};t.useEffect(()=>{F(),B()},[o,g]);let Q=async e=>{if(7===e.length)try{let a=await fetch("https://zipcloud.ibsnet.co.jp/api/search?zipcode=".concat(e)),s=await a.json();if(200===s.status&&s.results&&s.results.length>0){let e=s.results[0],a="".concat(e.address1).concat(e.address2).concat(e.address3);D(e=>({...e,address:a}))}}catch(e){console.error("住所取得エラー:",e)}},U=e=>{let a=e.replace(/[^0-9]/g,"");D(e=>({...e,postal_code:a})),7===a.length&&Q(a)},W=e=>{V.specialties.includes(e)||D(a=>({...a,specialties:[...a.specialties,e]}))},G=e=>{D(a=>({...a,specialties:a.specialties.filter(a=>a!==e)}))},I=e=>{V.qualifications.includes(e)||D(a=>({...a,qualifications:[...a.qualifications,e]}))},J=e=>{D(a=>({...a,qualifications:a.qualifications.filter(a=>a!==e)}))},$=async e=>{if(s&&e)try{S(!0);let{data:{session:a}}=await v.OQ.auth.getSession();if(!a){console.error("セッションが見つかりません");return}let s=new FormData;s.append("avatar",e);let r=await fetch("/api/profile/avatar",{method:"POST",headers:{Authorization:"Bearer ".concat(a.access_token)},body:s}),t=await r.json();r.ok?window.location.reload():(console.error("アバターアップロードエラー:",t.message),alert("アバターのアップロードに失敗しました: "+t.message))}catch(e){console.error("Error uploading avatar:",e),alert("アバターのアップロードに失敗しました: "+(e instanceof Error?e.message:"不明なエラー"))}finally{S(!1)}};return"OrgAdmin"===g?(0,r.jsxs)("div",{className:"min-h-screen bg-gray-50",children:[(0,r.jsx)(p.W,{}),(0,r.jsx)("div",{className:"container mx-auto px-4 py-8",children:(0,r.jsx)(w,{})})]}):(0,r.jsxs)("div",{className:"min-h-screen bg-gradient-mesh",children:[(0,r.jsx)(p.W,{}),(0,r.jsx)("div",{className:"md:ml-64 transition-all duration-300",children:(0,r.jsx)("main",{className:"px-6 py-8",children:(0,r.jsxs)("div",{className:"max-w-4xl mx-auto space-y-6",children:[(0,r.jsx)("div",{className:"flex justify-end",children:_?(0,r.jsxs)("div",{className:"flex gap-4",children:[(0,r.jsxs)(y.z,{onClick:R,disabled:C,className:"bg-engineering-green hover:bg-engineering-green/90",children:[(0,r.jsx)(i.Z,{className:"w-4 h-4 mr-2"}),C?"保存中...":"保存"]}),(0,r.jsxs)(y.z,{onClick:()=>{D({display_name:(null==o?void 0:o.display_name)||"",specialties:(null==o?void 0:o.specialties)||[],qualifications:(null==o?void 0:o.qualifications)||[],experience_years:(null==o?void 0:o.experience_years)||"",phone:"",location:"",bio:"",linkedin:"",github:"",formal_name:(null==o?void 0:o.formal_name)||"",postal_code:(null==o?void 0:o.postal_code)||"",address:(null==o?void 0:o.address)||"",address_detail:(null==o?void 0:o.address_detail)||"",phone_number:(null==o?void 0:o.phone_number)||"",company_number:(null==o?void 0:o.company_number)||"",registration_number:(null==o?void 0:o.registration_number)||""}),M(!1)},variant:"outline",disabled:C,children:[(0,r.jsx)(c.Z,{className:"w-4 h-4 mr-2"}),"キャンセル"]})]}):(0,r.jsxs)(y.z,{onClick:()=>M(!0),className:"bg-engineering-blue hover:bg-engineering-blue/90",children:[(0,r.jsx)(l.Z,{className:"w-4 h-4 mr-2"}),"プロフィールを編集"]})}),(0,r.jsx)(n.E.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.1},children:(0,r.jsxs)(b.Zb,{className:"hover-lift",children:[(0,r.jsx)(b.Ol,{children:(0,r.jsxs)(b.ll,{className:"flex items-center gap-2",children:[(0,r.jsx)(d.Z,{className:"w-5 h-5"}),"基本情報"]})}),(0,r.jsx)(b.aY,{className:"space-y-4",children:(0,r.jsxs)("div",{className:"flex items-center gap-6",children:[(0,r.jsxs)("div",{className:"relative",children:[(null==o?void 0:o.avatar_url)?(0,r.jsx)("img",{src:o.avatar_url,alt:"プロフィール画像",className:"w-24 h-24 rounded-full object-cover border-2 border-gray-200"}):(0,r.jsx)("div",{className:"w-24 h-24 bg-engineering-blue rounded-full flex items-center justify-center text-white text-2xl font-bold",children:V.display_name.charAt(0)||"U"}),_&&(0,r.jsxs)("label",{className:"absolute -bottom-2 -right-2 w-8 h-8 bg-white border-2 border-gray-300 rounded-full flex items-center justify-center hover:bg-gray-50 cursor-pointer",children:[(0,r.jsx)(u,{className:"w-4 h-4 text-gray-600"}),(0,r.jsx)("input",{type:"file",accept:"image/*",onChange:e=>{var a;let s=null===(a=e.target.files)||void 0===a?void 0:a[0];s&&$(s)},className:"hidden",disabled:q})]}),q&&(0,r.jsx)("div",{className:"absolute inset-0 bg-black/50 rounded-full flex items-center justify-center",children:(0,r.jsx)("div",{className:"animate-spin rounded-full h-6 w-6 border-b-2 border-white"})})]}),(0,r.jsxs)("div",{className:"flex-1",children:[(0,r.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"表示名"}),_?(0,r.jsx)("input",{type:"text",value:V.display_name,onChange:e=>D(a=>({...a,display_name:e.target.value})),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-engineering-blue focus:border-transparent"}):(0,r.jsx)("p",{className:"text-gray-900 font-medium",children:null==o?void 0:o.display_name})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"メールアドレス"}),(0,r.jsx)("p",{className:"text-gray-900",children:null==s?void 0:s.email}),(0,r.jsx)(f.C,{variant:"outline",className:"mt-1 text-xs",children:"認証済み"})]})]}),(0,r.jsxs)("div",{className:"mt-4 grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"ロール"}),(0,r.jsx)(f.C,{variant:"engineering",children:g})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"会員レベル"}),(()=>{let e=(0,N.$9)(V.experience_years,V.specialties),a=(0,N.qf)(e);return(0,r.jsx)(f.C,{className:a.color,children:a.label})})()]})]})]})]})})]})}),(0,r.jsx)(n.E.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.2},children:(0,r.jsxs)(b.Zb,{className:"hover-lift",children:[(0,r.jsx)(b.Ol,{children:(0,r.jsxs)(b.ll,{className:"flex items-center gap-2",children:[(0,r.jsx)(m.Z,{className:"w-5 h-5"}),"専門情報"]})}),(0,r.jsxs)(b.aY,{className:"space-y-6",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-3",children:"専門分野"}),_?(0,r.jsxs)("div",{className:"space-y-3",children:[(0,r.jsx)("div",{className:"grid grid-cols-2 md:grid-cols-3 gap-2",children:["未経験","道路設計","橋梁設計","河川工事","上下水道設計","トンネル設計","地下構造","構造物点検","測量業務","地質調査","環境評価","施工管理"].filter(e=>!V.specialties.includes(e)).map(e=>(0,r.jsxs)("button",{type:"button",onClick:()=>W(e),className:"px-3 py-2 text-sm border border-gray-200 rounded-lg hover:border-engineering-blue hover:bg-engineering-blue/5 transition-colors",children:[(0,r.jsx)(x.Z,{className:"w-3 h-3 inline mr-1"}),e]},e))}),V.specialties.length>0&&(0,r.jsx)("div",{className:"flex flex-wrap gap-2",children:V.specialties.map(e=>(0,r.jsxs)(f.C,{variant:"engineering",className:"cursor-pointer",onClick:()=>G(e),children:[e,(0,r.jsx)(c.Z,{className:"w-3 h-3 ml-1"})]},e))})]}):(0,r.jsx)("div",{className:"flex flex-wrap gap-2",children:(null==o?void 0:null===(e=o.specialties)||void 0===e?void 0:e.map(e=>(0,r.jsx)(f.C,{variant:"engineering",children:e},e)))||(0,r.jsx)("p",{className:"text-gray-500",children:"未設定"})})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-3",children:"資格・免許"}),_?(0,r.jsxs)("div",{className:"space-y-3",children:[(0,r.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-2",children:["技術士（建設部門）","技術士（上下水道部門）","技術士（その他）","技術士補","一級建築士","測量士","土木施工管理技士","管工事施工管理技士","造園施工管理技士","土地家屋調査士"].filter(e=>!V.qualifications.includes(e)).map(e=>(0,r.jsxs)("button",{type:"button",onClick:()=>I(e),className:"px-3 py-2 text-sm border border-gray-200 rounded-lg hover:border-engineering-blue hover:bg-engineering-blue/5 transition-colors text-left",children:[(0,r.jsx)(x.Z,{className:"w-3 h-3 inline mr-1"}),e]},e))}),V.qualifications.length>0&&(0,r.jsx)("div",{className:"flex flex-wrap gap-2",children:V.qualifications.map(e=>(0,r.jsxs)(f.C,{variant:"success",className:"cursor-pointer",onClick:()=>J(e),children:[e,(0,r.jsx)(c.Z,{className:"w-3 h-3 ml-1"})]},e))})]}):(0,r.jsx)("div",{className:"flex flex-wrap gap-2",children:(null==o?void 0:null===(a=o.qualifications)||void 0===a?void 0:a.map(e=>(0,r.jsx)(f.C,{variant:"success",children:e},e)))||(0,r.jsx)("p",{className:"text-gray-500",children:"未設定"})})]}),(0,r.jsxs)("div",{children:[(0,r.jsxs)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:["経験年数 ",V.specialties.some(e=>"未経験"!==e)&&"*"]}),_?(0,r.jsx)("input",{type:"number",min:"0",max:"50",value:V.experience_years,onChange:e=>D(a=>({...a,experience_years:e.target.value})),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-engineering-blue focus:border-transparent",placeholder:"5",required:V.specialties.some(e=>"未経験"!==e)}):(null==o?void 0:o.experience_years)?(0,r.jsxs)("p",{className:"text-gray-900",children:[o.experience_years,"年"]}):(0,r.jsx)("p",{className:"text-gray-500",children:"未設定"}),_&&V.specialties.some(e=>"未経験"!==e)&&(0,r.jsx)("p",{className:"text-sm text-gray-500 mt-1",children:"未経験以外の専門分野を選択した場合は必須です"})]})]})]})}),(0,r.jsx)(n.E.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.25},children:(0,r.jsxs)(b.Zb,{className:"hover-lift",children:[(0,r.jsxs)(b.Ol,{children:[(0,r.jsxs)(b.ll,{className:"flex items-center gap-2",children:[(0,r.jsx)(h.Z,{className:"w-5 h-5"}),"個人情報"]}),(0,r.jsx)(b.SZ,{children:"氏名、住所（自動入力）、住所（その他）、電話番号は必須項目です。会社番号、インボイス番号は任意で入力してください"})]}),(0,r.jsxs)(b.aY,{className:"space-y-4",children:[(0,r.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"氏名 *"}),_?(0,r.jsx)("input",{type:"text",value:V.formal_name,onChange:e=>D(a=>({...a,formal_name:e.target.value})),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-engineering-blue focus:border-transparent",placeholder:"田中 太郎",required:!0}):(0,r.jsx)("p",{className:"text-gray-900",children:(null==o?void 0:o.formal_name)||"未設定"})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"電話番号 *"}),_?(0,r.jsx)("input",{type:"tel",value:V.phone_number,onChange:e=>D(a=>({...a,phone_number:e.target.value})),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-engineering-blue focus:border-transparent",placeholder:"03-1234-5678",required:!0}):(0,r.jsx)("p",{className:"text-gray-900",children:(null==o?void 0:o.phone_number)||"未設定"})]})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"郵便番号"}),_?(0,r.jsx)("input",{type:"text",value:V.postal_code,onChange:e=>U(e.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-engineering-blue focus:border-transparent",placeholder:"1234567",maxLength:7}):(0,r.jsx)("p",{className:"text-gray-900",children:(null==o?void 0:o.postal_code)||"未設定"}),_&&(0,r.jsx)("p",{className:"text-sm text-gray-500 mt-1",children:"7桁の郵便番号を入力すると住所が自動入力されます"})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"住所（自動入力） *"}),_?(0,r.jsx)("input",{type:"text",value:V.address,onChange:e=>D(a=>({...a,address:e.target.value})),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-engineering-blue focus:border-transparent",placeholder:"東京都渋谷区...",required:!0}):(0,r.jsx)("p",{className:"text-gray-900",children:(null==o?void 0:o.address)||"未設定"}),_&&(0,r.jsx)("p",{className:"text-sm text-gray-500 mt-1",children:"郵便番号から自動入力されます（手動でも編集可能）"})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"住所（その他） *"}),_?(0,r.jsx)("input",{type:"text",value:V.address_detail,onChange:e=>D(a=>({...a,address_detail:e.target.value})),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-engineering-blue focus:border-transparent",placeholder:"マンション名、部屋番号など",required:!0}):(0,r.jsx)("p",{className:"text-gray-900",children:(null==o?void 0:o.address_detail)||"未設定"}),_&&(0,r.jsx)("p",{className:"text-sm text-gray-500 mt-1",children:"マンション名、部屋番号、建物名などを入力してください（必須項目）"})]}),(0,r.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"会社番号（法人番号）"}),_?(0,r.jsx)("input",{type:"text",value:V.company_number,onChange:e=>D(a=>({...a,company_number:e.target.value})),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-engineering-blue focus:border-transparent",placeholder:"1234567890123"}):(0,r.jsx)("p",{className:"text-gray-900",children:(null==o?void 0:o.company_number)||"未設定"})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"インボイス番号（Tを除く）"}),_?(0,r.jsx)("input",{type:"text",value:V.registration_number,onChange:e=>{let a=e.target.value.replace(/[^0-9]/g,"");D(e=>({...e,registration_number:a}))},className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-engineering-blue focus:border-transparent",placeholder:"1234567890123",maxLength:13}):(0,r.jsx)("p",{className:"text-gray-900",children:(null==o?void 0:o.registration_number)?"T".concat(o.registration_number):"未設定"})]})]})]})]})}),"Contractor"===g&&(0,r.jsx)(n.E.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.3},children:(0,r.jsx)(Z,{evaluations:A||[],loading:E})}),"Contractor"===g&&(0,r.jsx)(n.E.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.4},children:(0,r.jsx)(el,{badges:H||[],loading:Y})})]})})})]})}},7403:function(e,a,s){"use strict";s.r(a),s.d(a,{AuthGuard:function(){return d},useRoleAccess:function(){return u},withAuth:function(){return o}});var r=s(57437),t=s(2265),n=s(24033),l=s(65251),i=s(86264),c=s(66210);function d(e){let{children:a,requiredRole:s,allowedRoles:d,redirectTo:o="/auth/login"}=e,{user:u,userRole:m,loading:x}=(0,c.useAuth)(),h=(0,n.useRouter)(),g=(0,n.usePathname)(),p=(0,t.useRef)(!1);return((0,t.useEffect)(()=>{if(!x&&!p.current){if(!u){sessionStorage.setItem("redirectAfterLogin",g),g!==o&&(p.current=!0,h.push(o));return}if(s&&m!==s||d&&d.length>0&&(!m||!d.includes(m))){"/unauthorized"!==g&&(p.current=!0,h.push("/unauthorized"));return}}},[u,m,x,s,d,h,o,g]),x)?(0,r.jsx)("div",{className:"min-h-screen bg-gradient-mesh flex items-center justify-center",children:(0,r.jsxs)(l.E.div,{initial:{opacity:0,scale:.9},animate:{opacity:1,scale:1},className:"text-center",children:[(0,r.jsx)("div",{className:"w-16 h-16 bg-engineering-blue rounded-xl flex items-center justify-center mx-auto mb-4",children:(0,r.jsx)(i.Z,{className:"w-8 h-8 text-white animate-spin"})}),(0,r.jsx)("h2",{className:"text-xl font-semibold text-gray-900 mb-2",children:"認証確認中..."}),(0,r.jsx)("p",{className:"text-gray-600",children:"しばらくお待ちください"})]})}):!u||s&&m!==s||d&&d.length>0&&(!m||!d.includes(m))?null:(0,r.jsx)(r.Fragment,{children:a})}function o(e,a){return function(s){return(0,r.jsx)(d,{requiredRole:a,children:(0,r.jsx)(e,{...s})})}}function u(){let{userRole:e}=(0,c.useAuth)(),a=a=>e===a,s=a=>!!e&&a.includes(e);return{hasRole:a,hasAnyRole:s,isAdmin:()=>a("OrgAdmin"),isStaff:()=>a("Staff"),isContractor:()=>a("Contractor"),isReviewer:()=>a("Reviewer"),isAuditor:()=>a("Auditor"),canManageProjects:()=>s(["OrgAdmin","Staff"]),canViewFinancials:()=>s(["OrgAdmin","Staff","Auditor"]),canReviewProjects:()=>s(["Reviewer","OrgAdmin"]),canViewAuditLogs:()=>s(["Auditor","OrgAdmin"])}}},14374:function(e,a,s){"use strict";s.d(a,{$9:function(){return t},DY:function(){return r},qf:function(){return n}});let r={beginner:{level:"beginner",label:"初級",description:"経験年数3年未満、未経験",color:"bg-green-100 text-green-800"},intermediate:{level:"intermediate",label:"中級",description:"経験年数3年以上7年未満",color:"bg-yellow-100 text-yellow-800"},advanced:{level:"advanced",label:"上級",description:"経験年数7年以上",color:"bg-red-100 text-red-800"}};function t(e,a){if(0===a.length||a.every(e=>"未経験"===e))return"beginner";let s=parseInt(e||"0",10);return s<3?"beginner":s<7?"intermediate":"advanced"}function n(e){return r[e]}}},function(e){e.O(0,[778,402,440,250,677,650,971,938,744],function(){return e(e.s=98378)}),_N_E=e.O()}]);