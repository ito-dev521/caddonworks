(()=>{var e={};e.id=2895,e.ids=[2895],e.modules={47849:e=>{"use strict";e.exports=require("next/dist/client/components/action-async-storage.external")},72934:e=>{"use strict";e.exports=require("next/dist/client/components/action-async-storage.external.js")},55403:e=>{"use strict";e.exports=require("next/dist/client/components/request-async-storage.external")},54580:e=>{"use strict";e.exports=require("next/dist/client/components/request-async-storage.external.js")},94749:e=>{"use strict";e.exports=require("next/dist/client/components/static-generation-async-storage.external")},45869:e=>{"use strict";e.exports=require("next/dist/client/components/static-generation-async-storage.external.js")},20399:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},13685:e=>{"use strict";e.exports=require("http")},95687:e=>{"use strict";e.exports=require("https")},85477:e=>{"use strict";e.exports=require("punycode")},12781:e=>{"use strict";e.exports=require("stream")},57310:e=>{"use strict";e.exports=require("url")},59796:e=>{"use strict";e.exports=require("zlib")},36373:(e,t,r)=>{"use strict";r.r(t),r.d(t,{GlobalError:()=>i.ZP,__next_app__:()=>u,originalPathname:()=>o,pages:()=>d,routeModule:()=>x,tree:()=>c});var s=r(50482),a=r(69108),i=r(83543),n=r(68300),l={};for(let e in n)0>["default","tree","pages","GlobalError","originalPathname","__next_app__","routeModule"].indexOf(e)&&(l[e]=()=>n[e]);r.d(t,l);let c=["",{children:["projects",{children:["__PAGE__",{},{page:[()=>Promise.resolve().then(r.bind(r,48810)),"/Users/sayuri/caddonworks/src/app/projects/page.tsx"]}]},{}]},{layout:[()=>Promise.resolve().then(r.bind(r,61623)),"/Users/sayuri/caddonworks/src/app/layout.tsx"],error:[()=>Promise.resolve().then(r.bind(r,24117)),"/Users/sayuri/caddonworks/src/app/error.tsx"],"not-found":[()=>Promise.resolve().then(r.bind(r,48206)),"/Users/sayuri/caddonworks/src/app/not-found.tsx"]}],d=["/Users/sayuri/caddonworks/src/app/projects/page.tsx"],o="/projects/page",u={require:r,loadChunk:()=>Promise.resolve()},x=new s.AppPageRouteModule({definition:{kind:a.x.APP_PAGE,page:"/projects/page",pathname:"/projects",bundlePath:"",filename:"",appPaths:[]},userland:{loaderTree:c}})},81136:(e,t,r)=>{Promise.resolve().then(r.bind(r,45207))},78638:(e,t,r)=>{"use strict";r.d(t,{Z:()=>s});/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let s=(0,r(69224).Z)("Building",[["rect",{width:"16",height:"20",x:"4",y:"2",rx:"2",ry:"2",key:"76otgf"}],["path",{d:"M9 22v-4h6v4",key:"r93iot"}],["path",{d:"M8 6h.01",key:"1dz90k"}],["path",{d:"M16 6h.01",key:"1x0f13"}],["path",{d:"M12 6h.01",key:"1vi96p"}],["path",{d:"M12 10h.01",key:"1nrarc"}],["path",{d:"M12 14h.01",key:"1etili"}],["path",{d:"M16 10h.01",key:"1m94wz"}],["path",{d:"M16 14h.01",key:"1gbofw"}],["path",{d:"M8 10h.01",key:"19clt8"}],["path",{d:"M8 14h.01",key:"6423bh"}]])},55794:(e,t,r)=>{"use strict";r.d(t,{Z:()=>s});/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let s=(0,r(69224).Z)("Calendar",[["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",ry:"2",key:"eu3xkr"}],["line",{x1:"16",x2:"16",y1:"2",y2:"6",key:"m3sa8f"}],["line",{x1:"8",x2:"8",y1:"2",y2:"6",key:"18kwsl"}],["line",{x1:"3",x2:"21",y1:"10",y2:"10",key:"xt86sb"}]])},7060:(e,t,r)=>{"use strict";r.d(t,{Z:()=>s});/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let s=(0,r(69224).Z)("CheckCircle",[["path",{d:"M22 11.08V12a10 10 0 1 1-5.93-9.14",key:"g774vq"}],["path",{d:"m9 11 3 3L22 4",key:"1pflzl"}]])},25545:(e,t,r)=>{"use strict";r.d(t,{Z:()=>s});/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let s=(0,r(69224).Z)("Clock",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["polyline",{points:"12 6 12 12 16 14",key:"68esgv"}]])},48411:(e,t,r)=>{"use strict";r.d(t,{Z:()=>s});/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let s=(0,r(69224).Z)("DollarSign",[["line",{x1:"12",x2:"12",y1:"2",y2:"22",key:"7eqyqh"}],["path",{d:"M17 5H9.5a3.5 3.5 0 0 0 0 7h5a3.5 3.5 0 0 1 0 7H6",key:"1b0p4s"}]])},53148:(e,t,r)=>{"use strict";r.d(t,{Z:()=>s});/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let s=(0,r(69224).Z)("Eye",[["path",{d:"M2 12s3-7 10-7 10 7 10 7-3 7-10 7-10-7-10-7Z",key:"rwhkz3"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]])},56515:(e,t,r)=>{"use strict";r.d(t,{Z:()=>s});/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let s=(0,r(69224).Z)("File",[["path",{d:"M14.5 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7.5L14.5 2z",key:"1nnpy2"}],["polyline",{points:"14 2 14 8 20 8",key:"1ew0cm"}]])},17418:(e,t,r)=>{"use strict";r.d(t,{Z:()=>s});/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let s=(0,r(69224).Z)("Filter",[["polygon",{points:"22 3 2 3 10 12.46 10 19 14 21 14 12.46 22 3",key:"1yg77f"}]])},42739:(e,t,r)=>{"use strict";r.d(t,{Z:()=>s});/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let s=(0,r(69224).Z)("Loader2",[["path",{d:"M21 12a9 9 0 1 1-6.219-8.56",key:"13zald"}]])},38852:(e,t,r)=>{"use strict";r.d(t,{Z:()=>s});/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let s=(0,r(69224).Z)("MessageSquare",[["path",{d:"M21 15a2 2 0 0 1-2 2H7l-4 4V5a2 2 0 0 1 2-2h14a2 2 0 0 1 2 2z",key:"1lielz"}]])},66062:(e,t,r)=>{"use strict";r.d(t,{Z:()=>s});/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let s=(0,r(69224).Z)("Paperclip",[["path",{d:"m21.44 11.05-9.19 9.19a6 6 0 0 1-8.49-8.49l8.57-8.57A4 4 0 1 1 18 8.84l-8.59 8.57a2 2 0 0 1-2.83-2.83l8.49-8.48",key:"1u3ebp"}]])},75695:(e,t,r)=>{"use strict";r.d(t,{Z:()=>s});/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let s=(0,r(69224).Z)("PenSquare",[["path",{d:"M11 4H4a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7",key:"1qinfi"}],["path",{d:"M18.5 2.5a2.12 2.12 0 0 1 3 3L12 15l-4 1 1-4Z",key:"w2jsv5"}]])},51838:(e,t,r)=>{"use strict";r.d(t,{Z:()=>s});/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let s=(0,r(69224).Z)("Plus",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]])},28765:(e,t,r)=>{"use strict";r.d(t,{Z:()=>s});/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let s=(0,r(69224).Z)("Search",[["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}],["path",{d:"m21 21-4.3-4.3",key:"1qie3q"}]])},38271:(e,t,r)=>{"use strict";r.d(t,{Z:()=>s});/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let s=(0,r(69224).Z)("Trash2",[["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6",key:"4alrt4"}],["path",{d:"M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2",key:"v07s0e"}],["line",{x1:"10",x2:"10",y1:"11",y2:"17",key:"1uufr5"}],["line",{x1:"14",x2:"14",y1:"11",y2:"17",key:"xtxkd"}]])},3380:(e,t,r)=>{"use strict";r.d(t,{Z:()=>s});/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let s=(0,r(69224).Z)("Upload",[["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["polyline",{points:"17 8 12 3 7 8",key:"t8dd8p"}],["line",{x1:"12",x2:"12",y1:"3",y2:"15",key:"widbto"}]])},45207:(e,t,r)=>{"use strict";r.r(t),r.d(t,{default:()=>D});var s=r(95344),a=r(3729),i=r(57916),n=r(73644),l=r(78638),c=r(51838),d=r(28765),o=r(17418),u=r(25545),x=r(48411),m=r(55794),g=r(18822),h=r(53148),p=r(75695),y=r(38271),f=r(66062),b=r(69224);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let j=(0,b.Z)("PlayCircle",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["polygon",{points:"10 8 16 12 10 16 10 8",key:"1cimsy"}]]);var v=r(7060);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let N=(0,b.Z)("StopCircle",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["rect",{width:"6",height:"6",x:"9",y:"9",key:"1wrtvo"}]]);var w=r(38852),k=r(3380),_=r(56515),Z=r(14513),C=r(83655),q=r(23673),S=r(26298),z=r(19591),P=r(5094),$=r(43750),M=r(18704),A=r(76586),E=r(91684);function O(){let{userProfile:e,userRole:t,loading:r}=(0,$.useAuth)(),[b,A]=(0,a.useState)([]),[O,D]=(0,a.useState)([]),[T,L]=(0,a.useState)("active"),[B,R]=(0,a.useState)(""),[U,Q]=(0,a.useState)(!1),[G,I]=(0,a.useState)(null),[J,F]=(0,a.useState)(!0),[Y,H]=(0,a.useState)({title:"",description:"",budget:"",start_date:"",end_date:"",bidding_deadline:"",category:"",contractor_id:"",assignee_name:"",required_contractors:1,required_level:"beginner"}),[V,W]=(0,a.useState)(!1),[X,K]=(0,a.useState)([]),[ee,et]=(0,a.useState)(""),[er,es]=(0,a.useState)(!1),[ea,ei]=(0,a.useState)(!1),[en,el]=(0,a.useState)(null),[ec,ed]=(0,a.useState)(null),[eo,eu]=(0,a.useState)(null),[ex,em]=(0,a.useState)([]),[eg,eh]=(0,a.useState)(!1),[ep,ey]=(0,a.useState)(!1),ef=(0,a.useRef)(null),eb=e=>e.replace(/[^\d]/g,"").replace(/\B(?=(\d{3})+(?!\d))/g,","),ej=e=>parseInt(e.replace(/[^\d]/g,""),10)||0,ev=(0,a.useCallback)(async()=>{try{F(!0);let{data:{session:e}}=await M.OQ.auth.getSession();if(!e){console.error("セッションが見つかりません"),F(!1);return}let t=await fetch("/api/projects",{method:"GET",headers:{Authorization:`Bearer ${e.access_token}`}}),r=await t.json();t.ok?(A(r.projects||[]),D(r.projects||[])):(console.error("fetchProjects: 案件データの取得に失敗:",r.message),A([]),D([]))}catch(e){console.error("データ取得エラー:",e),A([]),D([])}finally{F(!1)}},[]);(0,a.useEffect)(()=>{if(!e||"OrgAdmin"!==t){F(!1);return}let r=`${e.id}:${t}`;ef.current!==r&&(ef.current=r,ev())},[e,t,ev]),(0,a.useEffect)(()=>{let e=b;"active"===T?e=e.filter(e=>"in_progress"===e.status||"bidding"===e.status):"completed"===T&&(e=e.filter(e=>"completed"===e.status||"cancelled"===e.status)),B&&(e=e.filter(e=>e.title.toLowerCase().includes(B.toLowerCase())||e.contractor_name.toLowerCase().includes(B.toLowerCase())||e.category.toLowerCase().includes(B.toLowerCase()))),D(e)},[b,T,B]);let eN=async e=>{e.preventDefault(),W(!0);try{let{data:{session:e}}=await M.OQ.auth.getSession();if(!e){alert("ログインが必要です");return}let t=await fetch("/api/projects",{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${e.access_token}`},body:JSON.stringify({...Y,budget:ej(Y.budget)})}),r=await t.json();t.ok?(alert("案件が正常に作成されました"),Q(!1),H({title:"",description:"",budget:"",start_date:"",end_date:"",bidding_deadline:"",category:"",contractor_id:"",assignee_name:"",required_contractors:1,required_level:"beginner"}),await ev()):alert("案件の作成に失敗しました: "+r.message)}catch(e){console.error("案件作成エラー:",e),alert("ネットワークエラーが発生しました")}finally{W(!1)}},ew=async e=>{es(!0);try{let{data:{session:t}}=await M.OQ.auth.getSession();if(!t){alert("ログインが必要です");return}let r=await fetch(`/api/chat?project_id=${e}`,{method:"GET",headers:{Authorization:`Bearer ${t.access_token}`}}),s=await r.json();r.ok?K(s.messages):(console.error("メッセージ取得エラー:",s.message),K([]))}catch(e){console.error("メッセージ取得エラー:",e),K([])}finally{es(!1)}},ek=async e=>{if(ee.trim()){ei(!0);try{let{data:{session:t}}=await M.OQ.auth.getSession();if(!t){alert("ログインが必要です");return}let r=await fetch("/api/chat",{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${t.access_token}`},body:JSON.stringify({project_id:e,message:ee,sender_type:"client"})}),s=await r.json();r.ok?(et(""),await ew(e)):alert("メッセージの送信に失敗しました: "+s.message)}catch(e){console.error("メッセージ送信エラー:",e),alert("ネットワークエラーが発生しました")}finally{ei(!1)}}},e_=e=>{I(e),ew(e)},eZ=e=>{b.find(t=>t.id===e)&&el(e)},eC=e=>{let t=b.find(t=>t.id===e);t&&ed(t)},eq=async e=>{if(e.preventDefault(),ec){W(!0);try{let{data:{session:e}}=await M.OQ.auth.getSession();if(!e){alert("ログインが必要です");return}let t=await fetch(`/api/projects/${ec.id}`,{method:"PUT",headers:{"Content-Type":"application/json",Authorization:`Bearer ${e.access_token}`},body:JSON.stringify({title:ec.title,description:ec.description,budget:ec.budget,start_date:ec.start_date,end_date:ec.end_date,category:ec.category,required_contractors:ec.required_contractors,required_level:ec.required_level,assignee_name:ec.assignee_name})}),r=await t.json();t.ok?(alert("案件が正常に更新されました"),ed(null),await ev()):alert("案件の更新に失敗しました: "+r.message)}catch(e){console.error("案件更新エラー:",e),alert("ネットワークエラーが発生しました")}finally{W(!1)}}},eS=async e=>{if(confirm("この案件を削除してもよろしいですか？"))try{let{data:{session:t}}=await M.OQ.auth.getSession();if(!t){alert("ログインが必要です");return}let r=await fetch(`/api/projects/${e}`,{method:"DELETE",headers:{Authorization:`Bearer ${t.access_token}`}}),s=await r.json();r.ok?(alert("案件が削除されました"),await ev()):alert("案件の削除に失敗しました: "+s.message)}catch(e){console.error("案件削除エラー:",e),alert("ネットワークエラーが発生しました")}},ez=async(e,t)=>{let r={bidding:"入札受付中",in_progress:"進行中",completed:"完了",cancelled:"キャンセル"};if(confirm(`この案件のステータスを「${r[t]}」に変更してもよろしいですか？`))try{let{data:{session:s}}=await M.OQ.auth.getSession();if(!s){alert("ログインが必要です");return}let a=b.find(t=>t.id===e);if(!a){alert("案件が見つかりません");return}let i=await fetch(`/api/projects/${e}`,{method:"PUT",headers:{"Content-Type":"application/json",Authorization:`Bearer ${s.access_token}`},body:JSON.stringify({title:a.title,description:a.description,budget:a.budget,start_date:a.start_date,end_date:a.end_date,category:a.category,required_contractors:a.required_contractors,status:t,isStatusUpdate:!0})}),n=await i.json();i.ok?(alert(`案件のステータスが「${r[t]}」に変更されました`),await ev(),"completed"===t&&await eP(e)):alert("ステータスの変更に失敗しました: "+n.message)}catch(e){console.error("ステータス変更エラー:",e),alert("ネットワークエラーが発生しました")}},eP=async e=>{try{let{data:{session:t}}=await M.OQ.auth.getSession();if(!t)return;(await fetch("/api/invoices",{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${t.access_token}`},body:JSON.stringify({project_id:e,type:"completion"})})).ok}catch(e){console.error("請求書作成エラー:",e)}},e$=async e=>{eh(!0);try{let{data:{session:t}}=await M.OQ.auth.getSession();if(!t){alert("ログインが必要です");return}let r=await fetch(`/api/projects/${e}/attachments`,{method:"GET",headers:{Authorization:`Bearer ${t.access_token}`}}),s=await r.json();r.ok?em(s.attachments||[]):(console.error("添付資料取得エラー:",s.message),em([]))}catch(e){console.error("添付資料取得エラー:",e),em([])}finally{eh(!1)}},eM=async(e,t)=>{ey(!0);try{let{data:{session:r}}=await M.OQ.auth.getSession();if(!r){console.error("セッションがありません"),alert("ログインが必要です");return}let s=new FormData;s.append("file",t);let a=new AbortController,i=setTimeout(()=>{console.error("リクエストタイムアウト（5分）"),a.abort()},3e5),n=await fetch(`/api/projects/${e}/attachments`,{method:"POST",headers:{Authorization:`Bearer ${r.access_token}`},body:s,signal:a.signal});clearTimeout(i);let l=await n.json();if(n.ok)alert("ファイルが正常にアップロードされました"),await e$(e);else{console.error("ファイルアップロードエラー:",l);let e="ファイルのアップロードに失敗しました";l.message&&(e+=": "+l.message),l.details&&(e+="\n詳細: "+l.details),l.duration&&(e+=`
処理時間: ${l.duration}`),alert(e)}}catch(e){console.error("=== フロントエンド: ファイルアップロードエラー ===",{error:e,errorName:e instanceof Error?e.name:"Unknown",errorMessage:e instanceof Error?e.message:"Unknown error",timestamp:new Date().toISOString()}),e instanceof Error&&"AbortError"===e.name?alert("ファイルアップロードがタイムアウトしました（5分）"):e instanceof Error&&e.message.includes("fetch")?alert("ネットワークエラーが発生しました。サーバーが起動しているか確認してください。"):alert("エラーが発生しました: "+(e instanceof Error?e.message:"Unknown error"))}finally{ey(!1)}},eA=async(e,t)=>{if(confirm("この添付資料を削除してもよろしいですか？"))try{let{data:{session:r}}=await M.OQ.auth.getSession();if(!r){alert("ログインが必要です");return}let s=await fetch(`/api/projects/${e}/attachments/${t}`,{method:"DELETE",headers:{Authorization:`Bearer ${r.access_token}`}}),a=await s.json();s.ok?(alert("添付資料が削除されました"),await e$(e)):alert("添付資料の削除に失敗しました: "+a.message)}catch(e){console.error("添付資料削除エラー:",e),alert("ネットワークエラーが発生しました")}},eE=e=>{eu(e),e$(e)},eO=e=>{switch(e){case"bidding":return"text-blue-600 bg-blue-100";case"in_progress":return"text-green-600 bg-green-100";case"completed":default:return"text-gray-600 bg-gray-100";case"cancelled":return"text-red-600 bg-red-100"}},eD=e=>{switch(e){case"bidding":return"入札中";case"in_progress":return"進行中";case"completed":return"完了";case"cancelled":return"キャンセル";default:return e}};return r||J?s.jsx("div",{className:"min-h-screen bg-gradient-mesh flex items-center justify-center",children:(0,s.jsxs)("div",{className:"text-center",children:[s.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-engineering-blue mx-auto mb-4"}),s.jsx("p",{className:"text-gray-600",children:"データを読み込み中..."})]})}):"OrgAdmin"!==t?s.jsx("div",{className:"min-h-screen bg-gradient-mesh flex items-center justify-center",children:s.jsx(q.Zb,{className:"w-full max-w-md",children:(0,s.jsxs)(q.aY,{className:"p-6 text-center",children:[s.jsx(l.Z,{className:"w-12 h-12 text-red-500 mx-auto mb-4"}),s.jsx("h2",{className:"text-xl font-semibold text-gray-900 mb-2",children:"アクセス権限がありません"}),s.jsx("p",{className:"text-gray-600",children:"このページは発注者（組織管理者）のみアクセス可能です。"})]})})}):(0,s.jsxs)("div",{className:"min-h-screen bg-gradient-mesh",children:[s.jsx(C.W,{}),(0,s.jsxs)("div",{className:"md:ml-64 transition-all duration-300",children:[s.jsx(i.E.header,{initial:{opacity:0,y:-20},animate:{opacity:1,y:0},className:"bg-white/80 backdrop-blur-sm border-b border-gray-200 sticky top-0 z-30",children:s.jsx("div",{className:"px-6 py-4",children:(0,s.jsxs)("div",{className:"flex items-center justify-between",children:[(0,s.jsxs)("div",{children:[(0,s.jsxs)("h1",{className:"text-2xl font-bold text-gray-900 flex items-center gap-2",children:[s.jsx(l.Z,{className:"w-6 h-6 text-engineering-blue"}),"案件管理"]}),s.jsx("p",{className:"text-gray-600",children:"新規案件登録と過去案件の管理"})]}),(0,s.jsxs)("div",{className:"flex items-center gap-3",children:[(0,s.jsxs)(P.z,{variant:"engineering",onClick:()=>Q(!0),children:[s.jsx(c.Z,{className:"w-4 h-4 mr-2"}),"新規案件登録"]}),(0,s.jsxs)("div",{className:"text-right",children:[s.jsx("p",{className:"text-sm text-gray-600",children:"総案件数"}),(0,s.jsxs)("p",{className:"text-sm font-medium",children:[b.length,"件"]})]})]})]})})}),(0,s.jsxs)("main",{className:"px-6 py-8",children:[s.jsx("div",{className:"mb-8",children:(0,s.jsxs)("div",{className:"flex flex-col lg:flex-row gap-4 items-start lg:items-center justify-between",children:[s.jsx("div",{className:"flex space-x-1 bg-gray-100 p-1 rounded-lg",children:[{id:"active",label:"進行中",count:b.filter(e=>"in_progress"===e.status||"bidding"===e.status).length},{id:"completed",label:"完了済み",count:b.filter(e=>"completed"===e.status||"cancelled"===e.status).length},{id:"all",label:"すべて",count:b.length}].map(e=>(0,s.jsxs)("button",{onClick:()=>L(e.id),className:`flex items-center gap-2 px-4 py-2 rounded-md text-sm font-medium transition-colors ${T===e.id?"bg-white text-engineering-blue shadow-sm":"text-gray-600 hover:text-gray-900"}`,children:[e.label,s.jsx(z.C,{variant:"outline",className:"text-xs",children:e.count})]},e.id))}),(0,s.jsxs)("div",{className:"flex gap-2",children:[(0,s.jsxs)("div",{className:"relative",children:[s.jsx(d.Z,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400 w-4 h-4"}),s.jsx("input",{type:"text",placeholder:"案件名・受注者で検索...",value:B,onChange:e=>R(e.target.value),className:"pl-10 pr-4 py-2 border border-gray-200 rounded-lg focus:ring-2 focus:ring-engineering-blue focus:border-transparent w-64"})]}),(0,s.jsxs)(P.z,{variant:"outline",children:[s.jsx(o.Z,{className:"w-4 h-4 mr-2"}),"フィルター"]})]})]})}),s.jsx("div",{className:"grid grid-cols-1 lg:grid-cols-2 xl:grid-cols-3 gap-6",children:s.jsx(n.M,{children:O.map((e,t)=>s.jsx(i.E.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},exit:{opacity:0,y:-20},transition:{delay:.1*t},children:(0,s.jsxs)(q.Zb,{className:"hover-lift cursor-pointer group",children:[s.jsx(q.Ol,{className:"pb-3",children:(0,s.jsxs)("div",{className:"flex items-start justify-between",children:[(0,s.jsxs)("div",{className:"flex-1",children:[s.jsx(q.ll,{className:"text-lg text-gray-900 group-hover:text-engineering-blue transition-colors",children:e.title}),(0,s.jsxs)(q.SZ,{className:"mt-1",children:[e.contractor_name," • ",e.category]})]}),s.jsx(z.C,{className:eO(e.status),children:eD(e.status)})]})}),(0,s.jsxs)(q.aY,{className:"space-y-4",children:[(0,s.jsxs)("div",{children:[(0,s.jsxs)("div",{className:"flex items-center justify-between mb-2",children:[s.jsx("span",{className:"text-sm font-medium text-gray-700",children:"進捗"}),(0,s.jsxs)("span",{className:"text-sm text-gray-600",children:[e.progress,"%"]})]}),s.jsx(S.E,{value:e.progress,variant:"engineering",className:"mb-3"})]}),(0,s.jsxs)("div",{className:"space-y-2 text-sm",children:[e.bidding_deadline&&(0,s.jsxs)("div",{className:"flex items-center gap-2 text-orange-600 font-medium",children:[s.jsx(u.Z,{className:"w-4 h-4"}),"入札締切: ",new Date(e.bidding_deadline).toLocaleDateString("ja-JP")]}),(0,s.jsxs)("div",{className:"flex items-center gap-2 text-gray-600",children:[s.jsx(x.Z,{className:"w-4 h-4"}),e.budget?e.budget.toLocaleString("ja-JP"):"未設定","円"]}),(0,s.jsxs)("div",{className:"flex items-center gap-2 text-gray-600",children:[s.jsx(m.Z,{className:"w-4 h-4"}),"納期: ",new Date(e.end_date).toLocaleDateString("ja-JP")]}),e.required_contractors&&e.required_contractors>1&&(0,s.jsxs)("div",{className:"flex items-center gap-2 text-blue-600",children:[s.jsx(g.Z,{className:"w-4 h-4"}),"募集人数: ",e.required_contractors,"名"]}),e.required_level&&s.jsx("div",{className:"flex items-center gap-2",children:(0,s.jsxs)(z.C,{className:E.DY[e.required_level].color,children:["必要レベル: ",E.DY[e.required_level].label]})})]}),(0,s.jsxs)("div",{className:"pt-3 border-t border-gray-100 space-y-3",children:[e.assignee_name&&(0,s.jsxs)("div",{className:"flex items-center gap-3",children:[s.jsx("div",{className:"w-8 h-8 bg-green-100 rounded-full flex items-center justify-center",children:s.jsx(g.Z,{className:"w-4 h-4 text-green-600"})}),(0,s.jsxs)("div",{className:"flex-1",children:[s.jsx("p",{className:"text-xs text-gray-500",children:"担当者"}),s.jsx("p",{className:"text-sm font-medium text-gray-900",children:e.assignee_name})]})]}),(0,s.jsxs)("div",{className:"flex items-center gap-3",children:[s.jsx("div",{className:"w-8 h-8 bg-engineering-blue/10 rounded-full flex items-center justify-center",children:s.jsx(g.Z,{className:"w-4 h-4 text-engineering-blue"})}),(0,s.jsxs)("div",{className:"flex-1",children:[s.jsx("p",{className:"text-xs text-gray-500",children:"受注者"}),s.jsx("p",{className:"text-sm font-medium text-gray-900",children:e.contractor_name}),s.jsx("p",{className:"text-xs text-gray-600",children:e.contractor_email})]})]})]}),(0,s.jsxs)("div",{className:"flex justify-between items-center pt-3 border-t border-gray-100",children:[(0,s.jsxs)("div",{className:"text-xs text-gray-500",children:["案件ID: ",e.id.slice(0,8).toUpperCase()]}),(0,s.jsxs)("div",{className:"flex gap-2",children:[s.jsx(P.z,{variant:"outline",size:"sm",onClick:()=>eZ(e.id),children:s.jsx(h.Z,{className:"w-4 h-4"})}),s.jsx(P.z,{variant:"outline",size:"sm",onClick:()=>eC(e.id),children:s.jsx(p.Z,{className:"w-4 h-4"})}),s.jsx(P.z,{variant:"outline",size:"sm",onClick:()=>eS(e.id),className:"text-red-600 hover:text-red-700",children:s.jsx(y.Z,{className:"w-4 h-4"})}),s.jsx(P.z,{variant:"outline",size:"sm",onClick:()=>eE(e.id),children:s.jsx(f.Z,{className:"w-4 h-4"})}),"bidding"===e.status&&s.jsx(P.z,{variant:"outline",size:"sm",onClick:()=>ez(e.id,"in_progress"),className:"text-blue-600 hover:text-blue-700",children:s.jsx(j,{className:"w-4 h-4"})}),"in_progress"===e.status&&s.jsx(P.z,{variant:"outline",size:"sm",onClick:()=>ez(e.id,"completed"),className:"text-green-600 hover:text-green-700",children:s.jsx(v.Z,{className:"w-4 h-4"})}),("bidding"===e.status||"in_progress"===e.status)&&s.jsx(P.z,{variant:"outline",size:"sm",onClick:()=>ez(e.id,"cancelled"),className:"text-red-600 hover:text-red-700",children:s.jsx(N,{className:"w-4 h-4"})}),("in_progress"===e.status||"bidding"===e.status)&&(0,s.jsxs)(P.z,{variant:"engineering",size:"sm",onClick:()=>e_(e.id),children:[s.jsx(w.Z,{className:"w-4 h-4 mr-1"}),"チャット"]})]})]})]})]})},e.id))})}),0===O.length&&(0,s.jsxs)(i.E.div,{initial:{opacity:0},animate:{opacity:1},className:"text-center py-12",children:[s.jsx(l.Z,{className:"w-16 h-16 text-gray-300 mx-auto mb-4"}),s.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-2",children:"案件が見つかりません"}),s.jsx("p",{className:"text-gray-600 mb-4",children:B?"検索条件に一致する案件がありません。":"まだ案件が登録されていません。"}),(0,s.jsxs)(P.z,{variant:"engineering",onClick:()=>Q(!0),children:[s.jsx(c.Z,{className:"w-4 h-4 mr-2"}),"新規案件登録"]})]})]})]}),s.jsx(n.M,{children:U&&s.jsx(i.E.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:s.jsx(i.E.div,{initial:{scale:.95,opacity:0},animate:{scale:1,opacity:1},exit:{scale:.95,opacity:0},className:"bg-white rounded-lg w-full max-w-2xl max-h-[90vh] overflow-y-auto",children:(0,s.jsxs)(q.Zb,{children:[(0,s.jsxs)(q.Ol,{children:[(0,s.jsxs)(q.ll,{className:"flex items-center gap-2",children:[s.jsx(c.Z,{className:"w-5 h-5 text-engineering-blue"}),"新規案件登録"]}),s.jsx(q.SZ,{children:"新しい案件の詳細を入力してください"})]}),s.jsx(q.aY,{children:(0,s.jsxs)("form",{onSubmit:eN,className:"space-y-4",children:[(0,s.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,s.jsxs)("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"案件名 *"}),s.jsx("input",{type:"text",value:Y.title,onChange:e=>H({...Y,title:e.target.value}),className:"w-full px-3 py-2 border border-gray-200 rounded-lg focus:ring-2 focus:ring-engineering-blue focus:border-transparent",required:!0})]}),(0,s.jsxs)("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"カテゴリ *"}),(0,s.jsxs)("select",{value:Y.category,onChange:e=>H({...Y,category:e.target.value}),className:"w-full px-3 py-2 border border-gray-200 rounded-lg focus:ring-2 focus:ring-engineering-blue focus:border-transparent",required:!0,children:[s.jsx("option",{value:"",children:"選択してください"}),s.jsx("option",{value:"道路設計",children:"道路設計"}),s.jsx("option",{value:"橋梁設計",children:"橋梁設計"}),s.jsx("option",{value:"河川工事",children:"河川工事"}),s.jsx("option",{value:"構造物点検",children:"構造物点検"}),s.jsx("option",{value:"地下構造",children:"地下構造"})]})]})]}),(0,s.jsxs)("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"案件説明 *"}),s.jsx("textarea",{value:Y.description,onChange:e=>H({...Y,description:e.target.value}),rows:3,className:"w-full px-3 py-2 border border-gray-200 rounded-lg focus:ring-2 focus:ring-engineering-blue focus:border-transparent",required:!0})]}),(0,s.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,s.jsxs)("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"予算 * (円)"}),s.jsx("input",{type:"text",value:Y.budget,onChange:e=>{let t=eb(e.target.value);H({...Y,budget:t})},placeholder:"例: 10,000",className:"w-full px-3 py-2 border border-gray-200 rounded-lg focus:ring-2 focus:ring-engineering-blue focus:border-transparent",required:!0})]}),(0,s.jsxs)("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"募集人数 *"}),s.jsx("select",{value:Y.required_contractors,onChange:e=>H({...Y,required_contractors:Number(e.target.value)}),className:"w-full px-3 py-2 border border-gray-200 rounded-lg focus:ring-2 focus:ring-engineering-blue focus:border-transparent",required:!0,children:[1,2,3,4,5,6,7,8,9,10].map(e=>(0,s.jsxs)("option",{value:e,children:[e,"名"]},e))})]})]}),(0,s.jsxs)("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"必要な会員レベル *"}),s.jsx("select",{value:Y.required_level,onChange:e=>H({...Y,required_level:e.target.value}),className:"w-full px-3 py-2 border border-gray-200 rounded-lg focus:ring-2 focus:ring-engineering-blue focus:border-transparent",required:!0,children:Object.values(E.DY).map(e=>(0,s.jsxs)("option",{value:e.level,children:[e.label," - ",e.description]},e.level))})]}),(0,s.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[(0,s.jsxs)("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"開始日 *"}),s.jsx("input",{type:"date",value:Y.start_date,onChange:e=>H({...Y,start_date:e.target.value}),className:"w-full px-3 py-2 border border-gray-200 rounded-lg focus:ring-2 focus:ring-engineering-blue focus:border-transparent",required:!0})]}),(0,s.jsxs)("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"納期 *"}),s.jsx("input",{type:"date",value:Y.end_date,onChange:e=>H({...Y,end_date:e.target.value}),className:"w-full px-3 py-2 border border-gray-200 rounded-lg focus:ring-2 focus:ring-engineering-blue focus:border-transparent",required:!0})]}),(0,s.jsxs)("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"入札締切日 *"}),s.jsx("input",{type:"date",value:Y.bidding_deadline,onChange:e=>H({...Y,bidding_deadline:e.target.value}),className:"w-full px-3 py-2 border border-gray-200 rounded-lg focus:ring-2 focus:ring-engineering-blue focus:border-transparent",required:!0})]})]}),(0,s.jsxs)("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"担当者名"}),s.jsx("input",{type:"text",value:Y.assignee_name,onChange:e=>H({...Y,assignee_name:e.target.value}),placeholder:"例: 田中太郎",className:"w-full px-3 py-2 border border-gray-200 rounded-lg focus:ring-2 focus:ring-engineering-blue focus:border-transparent"}),s.jsx("p",{className:"text-sm text-gray-600 mt-1",children:"案件の社内担当者を指定できます（任意）"})]}),(0,s.jsxs)("div",{className:"flex justify-end gap-3 pt-4",children:[s.jsx(P.z,{type:"button",variant:"outline",onClick:()=>Q(!1),disabled:V,children:"キャンセル"}),s.jsx(P.z,{type:"submit",variant:"engineering",disabled:V,children:V?"作成中...":"案件を登録"})]})]})})]})})})}),s.jsx(n.M,{children:G&&s.jsx(i.E.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:(0,s.jsxs)(i.E.div,{initial:{scale:.95,opacity:0},animate:{scale:1,opacity:1},exit:{scale:.95,opacity:0},className:"bg-white rounded-lg w-full max-w-4xl h-[80vh] flex flex-col",children:[(0,s.jsxs)("div",{className:"flex items-center justify-between p-4 border-b border-gray-200",children:[(0,s.jsxs)("div",{className:"flex items-center gap-3",children:[s.jsx("div",{className:"w-10 h-10 bg-engineering-blue/10 rounded-full flex items-center justify-center",children:s.jsx(w.Z,{className:"w-5 h-5 text-engineering-blue"})}),(0,s.jsxs)("div",{children:[s.jsx("h3",{className:"font-semibold text-gray-900",children:"受注者とのチャット"}),s.jsx("p",{className:"text-sm text-gray-600",children:b.find(e=>e.id===G)?.contractor_name})]})]}),s.jsx(P.z,{variant:"outline",size:"sm",onClick:()=>I(null),children:"\xd7"})]}),s.jsx("div",{className:"flex-1 p-4 overflow-y-auto",children:s.jsx("div",{className:"space-y-4",children:er?(0,s.jsxs)("div",{className:"text-center text-gray-500 py-8",children:[s.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-engineering-blue mx-auto mb-4"}),s.jsx("p",{children:"メッセージを読み込み中..."})]}):0===X.length?(0,s.jsxs)("div",{className:"text-center text-gray-500 py-8",children:[s.jsx(w.Z,{className:"w-12 h-12 mx-auto mb-4 text-gray-300"}),s.jsx("p",{children:"まだメッセージがありません"}),s.jsx("p",{className:"text-sm",children:"受注者とのコミュニケーションを開始しましょう"})]}):X.map((e,t)=>s.jsx("div",{className:`flex ${"client"===e.sender_type?"justify-end":"justify-start"}`,children:(0,s.jsxs)("div",{className:`max-w-xs lg:max-w-md px-4 py-2 rounded-lg ${"client"===e.sender_type?"bg-engineering-blue text-white":"bg-gray-100 text-gray-900"}`,children:[s.jsx("p",{className:"text-sm",children:e.message}),s.jsx("p",{className:`text-xs mt-1 ${"client"===e.sender_type?"text-blue-100":"text-gray-500"}`,children:new Date(e.created_at).toLocaleString("ja-JP")})]})},e.id))})}),s.jsx("div",{className:"p-4 border-t border-gray-200",children:(0,s.jsxs)("div",{className:"flex gap-2",children:[s.jsx("input",{type:"text",placeholder:"メッセージを入力...",value:ee,onChange:e=>et(e.target.value),onKeyPress:e=>{"Enter"===e.key&&G&&ek(G)},className:"flex-1 px-3 py-2 border border-gray-200 rounded-lg focus:ring-2 focus:ring-engineering-blue focus:border-transparent",disabled:ea}),s.jsx(P.z,{variant:"engineering",onClick:()=>G&&ek(G),disabled:ea||!ee.trim(),children:ea?"送信中...":"送信"})]})})]})})}),s.jsx(n.M,{children:eo&&s.jsx(i.E.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:(0,s.jsxs)(i.E.div,{initial:{scale:.95,opacity:0},animate:{scale:1,opacity:1},exit:{scale:.95,opacity:0},className:"bg-white rounded-lg w-full max-w-4xl h-[80vh] flex flex-col",children:[(0,s.jsxs)("div",{className:"flex items-center justify-between p-4 border-b border-gray-200",children:[(0,s.jsxs)("div",{className:"flex items-center gap-3",children:[s.jsx("div",{className:"w-10 h-10 bg-engineering-blue/10 rounded-full flex items-center justify-center",children:s.jsx(f.Z,{className:"w-5 h-5 text-engineering-blue"})}),(0,s.jsxs)("div",{children:[s.jsx("h3",{className:"font-semibold text-gray-900",children:"添付資料管理"}),s.jsx("p",{className:"text-sm text-gray-600",children:b.find(e=>e.id===eo)?.title})]})]}),s.jsx(P.z,{variant:"outline",size:"sm",onClick:()=>eu(null),children:"\xd7"})]}),(0,s.jsxs)("div",{className:"flex-1 p-4 overflow-y-auto",children:[s.jsx("div",{className:"mb-6",children:(0,s.jsxs)("div",{className:"border-2 border-dashed border-gray-300 rounded-lg p-6 text-center",children:[s.jsx(k.Z,{className:"w-12 h-12 text-gray-400 mx-auto mb-4"}),s.jsx("p",{className:"text-gray-600 mb-4",children:"ファイルをドラッグ&ドロップまたはクリックしてアップロード"}),s.jsx("input",{type:"file",id:"file-upload",className:"hidden",onChange:e=>{let t=e.target.files?.[0];t&&eo&&eM(eo,t)},accept:".pdf,.doc,.docx,.xls,.xlsx,.ppt,.pptx,.jpg,.jpeg,.png,.gif,.webp,.txt,.zip,.rar,.dwg,.p21,.sfc,.bfo",disabled:ep}),s.jsx(P.z,{variant:"outline",onClick:()=>document.getElementById("file-upload")?.click(),disabled:ep,children:ep?"アップロード中...":"ファイルを選択"}),s.jsx("p",{className:"text-xs text-gray-500 mt-2",children:"対応形式: PDF, Word, Excel, PowerPoint, 画像, ZIP, RAR, DWG, P21, SFC, BFO (最大200MB)"})]})}),(0,s.jsxs)("div",{children:[s.jsx("h4",{className:"font-medium text-gray-900 mb-4",children:"添付資料一覧"}),eg?(0,s.jsxs)("div",{className:"text-center text-gray-500 py-8",children:[s.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-engineering-blue mx-auto mb-4"}),s.jsx("p",{children:"添付資料を読み込み中..."})]}):0===ex.length?(0,s.jsxs)("div",{className:"text-center text-gray-500 py-8",children:[s.jsx(_.Z,{className:"w-12 h-12 mx-auto mb-4 text-gray-300"}),s.jsx("p",{children:"まだ添付資料がありません"}),s.jsx("p",{className:"text-sm",children:"ファイルをアップロードしてください"})]}):s.jsx("div",{className:"space-y-3",children:ex.map(e=>(0,s.jsxs)("div",{className:"flex items-center justify-between p-3 border border-gray-200 rounded-lg",children:[(0,s.jsxs)("div",{className:"flex items-center gap-3",children:[s.jsx("div",{className:"w-8 h-8 bg-gray-100 rounded flex items-center justify-center",children:s.jsx(_.Z,{className:"w-4 h-4 text-gray-600"})}),(0,s.jsxs)("div",{children:[s.jsx("p",{className:"font-medium text-gray-900",children:e.file_name}),(0,s.jsxs)("p",{className:"text-sm text-gray-600",children:[(e.file_size/1024/1024).toFixed(2)," MB •",new Date(e.created_at).toLocaleDateString("ja-JP")]})]})]}),(0,s.jsxs)("div",{className:"flex items-center gap-2",children:[s.jsx(P.z,{variant:"outline",size:"sm",onClick:()=>{alert("ダウンロード機能は準備中です")},children:"ダウンロード"}),s.jsx(P.z,{variant:"outline",size:"sm",onClick:()=>eo&&eA(eo,e.id),className:"text-red-600 hover:text-red-700",children:s.jsx(Z.Z,{className:"w-4 h-4"})})]})]},e.id))})]})]})]})})}),s.jsx(n.M,{children:ec&&s.jsx(i.E.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:s.jsx(i.E.div,{initial:{scale:.95,opacity:0},animate:{scale:1,opacity:1},exit:{scale:.95,opacity:0},className:"bg-white rounded-lg w-full max-w-2xl max-h-[90vh] overflow-y-auto",children:(0,s.jsxs)(q.Zb,{children:[(0,s.jsxs)(q.Ol,{children:[(0,s.jsxs)(q.ll,{className:"flex items-center gap-2",children:[s.jsx(p.Z,{className:"w-5 h-5 text-engineering-blue"}),"案件編集"]}),s.jsx(q.SZ,{children:"案件の詳細を編集してください"})]}),s.jsx(q.aY,{children:(0,s.jsxs)("form",{onSubmit:eq,className:"space-y-4",children:[(0,s.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,s.jsxs)("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"案件名 *"}),s.jsx("input",{type:"text",value:ec.title,onChange:e=>ed({...ec,title:e.target.value}),className:"w-full px-3 py-2 border border-gray-200 rounded-lg focus:ring-2 focus:ring-engineering-blue focus:border-transparent",required:!0})]}),(0,s.jsxs)("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"カテゴリ *"}),(0,s.jsxs)("select",{value:ec.category,onChange:e=>ed({...ec,category:e.target.value}),className:"w-full px-3 py-2 border border-gray-200 rounded-lg focus:ring-2 focus:ring-engineering-blue focus:border-transparent",required:!0,children:[s.jsx("option",{value:"",children:"選択してください"}),s.jsx("option",{value:"道路設計",children:"道路設計"}),s.jsx("option",{value:"橋梁設計",children:"橋梁設計"}),s.jsx("option",{value:"河川工事",children:"河川工事"}),s.jsx("option",{value:"構造物点検",children:"構造物点検"}),s.jsx("option",{value:"地下構造",children:"地下構造"})]})]})]}),(0,s.jsxs)("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"案件説明 *"}),s.jsx("textarea",{value:ec.description,onChange:e=>ed({...ec,description:e.target.value}),rows:3,className:"w-full px-3 py-2 border border-gray-200 rounded-lg focus:ring-2 focus:ring-engineering-blue focus:border-transparent",required:!0})]}),(0,s.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[(0,s.jsxs)("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"予算 *"}),s.jsx("input",{type:"number",value:ec.budget,onChange:e=>ed({...ec,budget:Number(e.target.value)}),className:"w-full px-3 py-2 border border-gray-200 rounded-lg focus:ring-2 focus:ring-engineering-blue focus:border-transparent",required:!0})]}),(0,s.jsxs)("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"開始日 *"}),s.jsx("input",{type:"date",value:ec.start_date,onChange:e=>ed({...ec,start_date:e.target.value}),className:"w-full px-3 py-2 border border-gray-200 rounded-lg focus:ring-2 focus:ring-engineering-blue focus:border-transparent",required:!0})]}),(0,s.jsxs)("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"納期 *"}),s.jsx("input",{type:"date",value:ec.end_date,onChange:e=>ed({...ec,end_date:e.target.value}),className:"w-full px-3 py-2 border border-gray-200 rounded-lg focus:ring-2 focus:ring-engineering-blue focus:border-transparent",required:!0})]})]}),(0,s.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,s.jsxs)("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"募集人数 *"}),s.jsx("input",{type:"number",min:"1",max:"10",value:ec.required_contractors||1,onChange:e=>ed({...ec,required_contractors:Number(e.target.value)}),className:"w-full px-3 py-2 border border-gray-200 rounded-lg focus:ring-2 focus:ring-engineering-blue focus:border-transparent",required:!0}),s.jsx("p",{className:"text-sm text-gray-600 mt-1",children:"この案件に必要な受注者の人数"})]}),(0,s.jsxs)("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"担当者名"}),s.jsx("input",{type:"text",value:ec.assignee_name||"",onChange:e=>ed({...ec,assignee_name:e.target.value}),placeholder:"例: 田中太郎",className:"w-full px-3 py-2 border border-gray-200 rounded-lg focus:ring-2 focus:ring-engineering-blue focus:border-transparent"}),s.jsx("p",{className:"text-sm text-gray-600 mt-1",children:"案件の社内担当者を指定できます（任意）"})]})]}),(0,s.jsxs)("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"必要な会員レベル *"}),s.jsx("select",{value:ec.required_level||"beginner",onChange:e=>ed({...ec,required_level:e.target.value}),className:"w-full px-3 py-2 border border-gray-200 rounded-lg focus:ring-2 focus:ring-engineering-blue focus:border-transparent",required:!0,children:Object.values(E.DY).map(e=>(0,s.jsxs)("option",{value:e.level,children:[e.label," - ",e.description]},e.level))})]}),(0,s.jsxs)("div",{className:"flex justify-end gap-3 pt-4",children:[s.jsx(P.z,{type:"button",variant:"outline",onClick:()=>ed(null),disabled:V,children:"キャンセル"}),s.jsx(P.z,{type:"submit",variant:"engineering",disabled:V,children:V?"更新中...":"更新"})]})]})})]})})})})]})}function D(){return s.jsx(A.AuthGuard,{requiredRole:"OrgAdmin",children:s.jsx(O,{})})}},76586:(e,t,r)=>{"use strict";r.r(t),r.d(t,{AuthGuard:()=>d,useRoleAccess:()=>u,withAuth:()=>o});var s=r(95344),a=r(3729),i=r(22254),n=r(57916),l=r(42739),c=r(43750);function d({children:e,requiredRole:t,allowedRoles:r,redirectTo:d="/auth/login"}){let{user:o,userRole:u,loading:x}=(0,c.useAuth)(),m=(0,i.useRouter)(),g=(0,i.usePathname)(),h=(0,a.useRef)(!1);return((0,a.useEffect)(()=>{if(!x&&!h.current){if(!o){sessionStorage.setItem("redirectAfterLogin",g),g!==d&&(h.current=!0,m.push(d));return}if(t&&u!==t||r&&r.length>0&&(!u||!r.includes(u))){"/unauthorized"!==g&&(h.current=!0,m.push("/unauthorized"));return}}},[o,u,x,t,r,m,d,g]),x)?s.jsx("div",{className:"min-h-screen bg-gradient-mesh flex items-center justify-center",children:(0,s.jsxs)(n.E.div,{initial:{opacity:0,scale:.9},animate:{opacity:1,scale:1},className:"text-center",children:[s.jsx("div",{className:"w-16 h-16 bg-engineering-blue rounded-xl flex items-center justify-center mx-auto mb-4",children:s.jsx(l.Z,{className:"w-8 h-8 text-white animate-spin"})}),s.jsx("h2",{className:"text-xl font-semibold text-gray-900 mb-2",children:"認証確認中..."}),s.jsx("p",{className:"text-gray-600",children:"しばらくお待ちください"})]})}):!o||t&&u!==t||r&&r.length>0&&(!u||!r.includes(u))?null:s.jsx(s.Fragment,{children:e})}function o(e,t){return function(r){return s.jsx(d,{requiredRole:t,children:s.jsx(e,{...r})})}}function u(){let{userRole:e}=(0,c.useAuth)(),t=t=>e===t,r=t=>!!e&&t.includes(e);return{hasRole:t,hasAnyRole:r,isAdmin:()=>t("OrgAdmin"),isStaff:()=>t("Staff"),isContractor:()=>t("Contractor"),isReviewer:()=>t("Reviewer"),isAuditor:()=>t("Auditor"),canManageProjects:()=>r(["OrgAdmin","Staff"]),canViewFinancials:()=>r(["OrgAdmin","Staff","Auditor"]),canReviewProjects:()=>r(["Reviewer","OrgAdmin"]),canViewAuditLogs:()=>r(["Auditor","OrgAdmin"])}}},26298:(e,t,r)=>{"use strict";r.d(t,{E:()=>v});var s=r(95344),a=r(3729);r(81202);var i=r(45877),n=["a","button","div","form","h2","h3","img","input","label","li","nav","ol","p","select","span","svg","ul"].reduce((e,t)=>{let r=(0,i.Z8)(`Primitive.${t}`),n=a.forwardRef((e,a)=>{let{asChild:i,...n}=e,l=i?r:t;return(0,s.jsx)(l,{...n,ref:a})});return n.displayName=`Primitive.${t}`,{...e,[t]:n}},{}),l="Progress",[c,d]=function(e,t=[]){let r=[],i=()=>{let t=r.map(e=>a.createContext(e));return function(r){let s=r?.[e]||t;return a.useMemo(()=>({[`__scope${e}`]:{...r,[e]:s}}),[r,s])}};return i.scopeName=e,[function(t,i){let n=a.createContext(i),l=r.length;r=[...r,i];let c=t=>{let{scope:r,children:i,...c}=t,d=r?.[e]?.[l]||n,o=a.useMemo(()=>c,Object.values(c));return(0,s.jsx)(d.Provider,{value:o,children:i})};return c.displayName=t+"Provider",[c,function(r,s){let c=s?.[e]?.[l]||n,d=a.useContext(c);if(d)return d;if(void 0!==i)return i;throw Error(`\`${r}\` must be used within \`${t}\``)}]},function(...e){let t=e[0];if(1===e.length)return t;let r=()=>{let r=e.map(e=>({useScope:e(),scopeName:e.scopeName}));return function(e){let s=r.reduce((t,{useScope:r,scopeName:s})=>{let a=r(e)[`__scope${s}`];return{...t,...a}},{});return a.useMemo(()=>({[`__scope${t.scopeName}`]:s}),[s])}};return r.scopeName=t.scopeName,r}(i,...t)]}(l),[o,u]=c(l),x=a.forwardRef((e,t)=>{var r,a;let{__scopeProgress:i,value:l=null,max:c,getValueLabel:d=h,...u}=e;(c||0===c)&&!f(c)&&console.error((r=`${c}`,`Invalid prop \`max\` of value \`${r}\` supplied to \`Progress\`. Only numbers greater than 0 are valid max values. Defaulting to \`100\`.`));let x=f(c)?c:100;null===l||b(l,x)||console.error((a=`${l}`,`Invalid prop \`value\` of value \`${a}\` supplied to \`Progress\`. The \`value\` prop must be:
  - a positive number
  - less than the value passed to \`max\` (or 100 if no \`max\` prop is set)
  - \`null\` or \`undefined\` if the progress is indeterminate.

Defaulting to \`null\`.`));let m=b(l,x)?l:null,g=y(m)?d(m,x):void 0;return(0,s.jsx)(o,{scope:i,value:m,max:x,children:(0,s.jsx)(n.div,{"aria-valuemax":x,"aria-valuemin":0,"aria-valuenow":y(m)?m:void 0,"aria-valuetext":g,role:"progressbar","data-state":p(m,x),"data-value":m??void 0,"data-max":x,...u,ref:t})})});x.displayName=l;var m="ProgressIndicator",g=a.forwardRef((e,t)=>{let{__scopeProgress:r,...a}=e,i=u(m,r);return(0,s.jsx)(n.div,{"data-state":p(i.value,i.max),"data-value":i.value??void 0,"data-max":i.max,...a,ref:t})});function h(e,t){return`${Math.round(e/t*100)}%`}function p(e,t){return null==e?"indeterminate":e===t?"complete":"loading"}function y(e){return"number"==typeof e}function f(e){return y(e)&&!isNaN(e)&&e>0}function b(e,t){return y(e)&&!isNaN(e)&&e<=t&&e>=0}g.displayName=m;var j=r(11453);let v=a.forwardRef(({className:e,value:t,variant:r="default",...a},i)=>s.jsx(x,{ref:i,className:(0,j.cn)("relative h-2 w-full overflow-hidden rounded-full","default"===r&&"bg-primary/20","engineering"===r&&"bg-engineering-blue/20","gradient"===r&&"bg-gradient-to-r from-engineering-blue/20 to-engineering-green/20",e),...a,children:s.jsx(g,{className:(0,j.cn)("h-full w-full flex-1 transition-all","default"===r&&"bg-primary","engineering"===r&&"bg-engineering-blue","gradient"===r&&"gradient-engineering"),style:{transform:`translateX(-${100-(t||0)}%)`}})}));v.displayName=x.displayName},91684:(e,t,r)=>{"use strict";r.d(t,{$9:()=>a,DY:()=>s,qf:()=>i});let s={beginner:{level:"beginner",label:"初級",description:"経験年数3年未満、未経験",color:"bg-green-100 text-green-800"},intermediate:{level:"intermediate",label:"中級",description:"経験年数3年以上7年未満",color:"bg-yellow-100 text-yellow-800"},advanced:{level:"advanced",label:"上級",description:"経験年数7年以上",color:"bg-red-100 text-red-800"}};function a(e,t){if(0===t.length||t.every(e=>"未経験"===e))return"beginner";let r=parseInt(e||"0",10);return r<3?"beginner":r<7?"intermediate":"advanced"}function i(e){return s[e]}},48810:(e,t,r)=>{"use strict";r.r(t),r.d(t,{$$typeof:()=>i,__esModule:()=>a,default:()=>n});let s=(0,r(86843).createProxy)(String.raw`/Users/sayuri/caddonworks/src/app/projects/page.tsx`),{__esModule:a,$$typeof:i}=s,n=s.default}};var t=require("../../webpack-runtime.js");t.C(e);var r=e=>t(t.s=e),s=t.X(0,[1638,4679,3035,7962,5414,5188,1682],()=>r(36373));module.exports=s})();