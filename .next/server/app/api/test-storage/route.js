"use strict";(()=>{var e={};e.id=2600,e.ids=[2600],e.modules={30517:e=>{e.exports=require("next/dist/compiled/next-server/app-route.runtime.prod.js")},13685:e=>{e.exports=require("http")},95687:e=>{e.exports=require("https")},85477:e=>{e.exports=require("punycode")},12781:e=>{e.exports=require("stream")},57310:e=>{e.exports=require("url")},59796:e=>{e.exports=require("zlib")},13392:(e,t,r)=>{r.r(t),r.d(t,{headerHooks:()=>h,originalPathname:()=>f,patchFetch:()=>w,requestAsyncStorage:()=>l,routeModule:()=>u,serverHooks:()=>g,staticGenerationAsyncStorage:()=>d,staticGenerationBailout:()=>I});var s={};r.r(s),r.d(s,{GET:()=>p,POST:()=>m});var a=r(95419),o=r(69108),i=r(99678),n=r(78070),c=r(6517);async function p(e){try{let e=(0,c.ST)(),{data:t,error:r}=await e.storage.listBuckets();if(r)return console.error("バケット一覧取得エラー:",r),n.Z.json({message:"バケット一覧の取得に失敗しました",error:r.message},{status:500});let s=t?.some(e=>"project-attachments"===e.id);return n.Z.json({message:"ストレージバケットの状況を確認しました",buckets:t?.map(e=>({id:e.id,name:e.name,public:e.public,file_size_limit:e.file_size_limit,allowed_mime_types:e.allowed_mime_types})),projectAttachmentsExists:s,totalBuckets:t?.length||0,needsCreation:!s},{status:200})}catch(e){return console.error("ストレージ確認エラー:",e),n.Z.json({message:"サーバーエラーが発生しました",error:e instanceof Error?e.message:"Unknown error"},{status:500})}}async function m(e){try{let e=(0,c.ST)(),{data:t,error:r}=await e.storage.listBuckets();if(r)return console.error("バケット一覧取得エラー:",r),n.Z.json({message:"バケット一覧の取得に失敗しました",error:r.message},{status:500});if(t?.some(e=>"project-attachments"===e.id))return n.Z.json({message:"project-attachmentsバケットは既に存在します",buckets:t?.map(e=>({id:e.id,name:e.name,public:e.public}))},{status:200});let{data:s,error:a}=await e.storage.createBucket("project-attachments",{public:!1,fileSizeLimit:209715200,allowedMimeTypes:["application/pdf","application/msword","application/vnd.openxmlformats-officedocument.wordprocessingml.document","application/vnd.ms-excel","application/vnd.openxmlformats-officedocument.spreadsheetml.sheet","application/vnd.ms-powerpoint","application/vnd.openxmlformats-officedocument.presentationml.presentation","image/jpeg","image/png","image/gif","image/webp","application/zip","application/x-rar-compressed","application/x-rar","application/octet-stream","text/plain"]});if(a)return console.error("バケット作成エラー:",a),n.Z.json({message:"バケットの作成に失敗しました",error:a.message},{status:500});return n.Z.json({message:"project-attachmentsバケットが正常に作成されました",bucket:s,existingBuckets:t?.map(e=>({id:e.id,name:e.name,public:e.public}))},{status:201})}catch(e){return console.error("バケット作成エラー:",e),n.Z.json({message:"サーバーエラーが発生しました",error:e instanceof Error?e.message:"Unknown error"},{status:500})}}let u=new a.AppRouteRouteModule({definition:{kind:o.x.APP_ROUTE,page:"/api/test-storage/route",pathname:"/api/test-storage",filename:"route",bundlePath:"app/api/test-storage/route"},resolvedPagePath:"/Users/sayuri/caddonworks/src/app/api/test-storage/route.ts",nextConfigOutput:"",userland:s}),{requestAsyncStorage:l,staticGenerationAsyncStorage:d,serverHooks:g,headerHooks:h,staticGenerationBailout:I}=u,f="/api/test-storage/route";function w(){return(0,i.patchFetch)({serverHooks:g,staticGenerationAsyncStorage:d})}},6517:(e,t,r)=>{r.d(t,{OQ:()=>a,ST:()=>o});var s=r(32409);let a=(0,s.eI)("https://rxnozwuamddqlcwysxag.supabase.co","eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6InJ4bm96d3VhbWRkcWxjd3lzeGFnIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NTc3NjY4MDMsImV4cCI6MjA3MzM0MjgwM30.0sbl6zWJ1XalGTFbsgeMpth6yH-oQA_P1eTCc8lKoAU"),o=()=>{let e=process.env.SUPABASE_SERVICE_ROLE_KEY||"eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6InJ4bm96d3VhbWRkcWxjd3lzeGFnIiwicm9sZSI6InNlcnZpY2Vfcm9sZSIsImlhdCI6MTc1Nzc2NjgwMywiZXhwIjoyMDczMzQyODAzfQ.w7KcFrtcTRhqoHwTSlgTc6NDNHIJH985rAgT9bD0ipE";return(0,s.eI)("https://rxnozwuamddqlcwysxag.supabase.co",e,{auth:{autoRefreshToken:!1,persistSession:!1}})}}};var t=require("../../../webpack-runtime.js");t.C(e);var r=e=>t(t.s=e),s=t.X(0,[1638,6206,2409],()=>r(13392));module.exports=s})();