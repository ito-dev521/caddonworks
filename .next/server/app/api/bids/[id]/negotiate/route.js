"use strict";
/*
 * ATTENTION: An "eval-source-map" devtool has been used.
 * This devtool is neither made for production nor for readable output files.
 * It uses "eval()" calls to create a separate source file with attached SourceMaps in the browser devtools.
 * If you are trying to read the output file, select a different devtool (https://webpack.js.org/configuration/devtool/)
 * or disable the default devtool with "devtool: false".
 * If you are looking for production-ready output files, see mode: "production" (https://webpack.js.org/configuration/mode/).
 */
(() => {
var exports = {};
exports.id = "app/api/bids/[id]/negotiate/route";
exports.ids = ["app/api/bids/[id]/negotiate/route"];
exports.modules = {

/***/ "next/dist/compiled/next-server/app-route.runtime.dev.js":
/*!**************************************************************************!*\
  !*** external "next/dist/compiled/next-server/app-route.runtime.dev.js" ***!
  \**************************************************************************/
/***/ ((module) => {

module.exports = require("next/dist/compiled/next-server/app-route.runtime.dev.js");

/***/ }),

/***/ "http":
/*!***********************!*\
  !*** external "http" ***!
  \***********************/
/***/ ((module) => {

module.exports = require("http");

/***/ }),

/***/ "https":
/*!************************!*\
  !*** external "https" ***!
  \************************/
/***/ ((module) => {

module.exports = require("https");

/***/ }),

/***/ "punycode":
/*!***************************!*\
  !*** external "punycode" ***!
  \***************************/
/***/ ((module) => {

module.exports = require("punycode");

/***/ }),

/***/ "stream":
/*!*************************!*\
  !*** external "stream" ***!
  \*************************/
/***/ ((module) => {

module.exports = require("stream");

/***/ }),

/***/ "url":
/*!**********************!*\
  !*** external "url" ***!
  \**********************/
/***/ ((module) => {

module.exports = require("url");

/***/ }),

/***/ "zlib":
/*!***********************!*\
  !*** external "zlib" ***!
  \***********************/
/***/ ((module) => {

module.exports = require("zlib");

/***/ }),

/***/ "(rsc)/./node_modules/next/dist/build/webpack/loaders/next-app-loader.js?name=app%2Fapi%2Fbids%2F%5Bid%5D%2Fnegotiate%2Froute&page=%2Fapi%2Fbids%2F%5Bid%5D%2Fnegotiate%2Froute&appPaths=&pagePath=private-next-app-dir%2Fapi%2Fbids%2F%5Bid%5D%2Fnegotiate%2Froute.ts&appDir=%2FUsers%2Fsayuri%2Fcaddonworks%2Fsrc%2Fapp&pageExtensions=tsx&pageExtensions=ts&pageExtensions=jsx&pageExtensions=js&rootDir=%2FUsers%2Fsayuri%2Fcaddonworks&isDev=true&tsconfigPath=tsconfig.json&basePath=&assetPrefix=&nextConfigOutput=&preferredRegion=&middlewareConfig=e30%3D!":
/*!*********************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************!*\
  !*** ./node_modules/next/dist/build/webpack/loaders/next-app-loader.js?name=app%2Fapi%2Fbids%2F%5Bid%5D%2Fnegotiate%2Froute&page=%2Fapi%2Fbids%2F%5Bid%5D%2Fnegotiate%2Froute&appPaths=&pagePath=private-next-app-dir%2Fapi%2Fbids%2F%5Bid%5D%2Fnegotiate%2Froute.ts&appDir=%2FUsers%2Fsayuri%2Fcaddonworks%2Fsrc%2Fapp&pageExtensions=tsx&pageExtensions=ts&pageExtensions=jsx&pageExtensions=js&rootDir=%2FUsers%2Fsayuri%2Fcaddonworks&isDev=true&tsconfigPath=tsconfig.json&basePath=&assetPrefix=&nextConfigOutput=&preferredRegion=&middlewareConfig=e30%3D! ***!
  \*********************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   headerHooks: () => (/* binding */ headerHooks),\n/* harmony export */   originalPathname: () => (/* binding */ originalPathname),\n/* harmony export */   patchFetch: () => (/* binding */ patchFetch),\n/* harmony export */   requestAsyncStorage: () => (/* binding */ requestAsyncStorage),\n/* harmony export */   routeModule: () => (/* binding */ routeModule),\n/* harmony export */   serverHooks: () => (/* binding */ serverHooks),\n/* harmony export */   staticGenerationAsyncStorage: () => (/* binding */ staticGenerationAsyncStorage),\n/* harmony export */   staticGenerationBailout: () => (/* binding */ staticGenerationBailout)\n/* harmony export */ });\n/* harmony import */ var next_dist_server_future_route_modules_app_route_module_compiled__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! next/dist/server/future/route-modules/app-route/module.compiled */ \"(rsc)/./node_modules/next/dist/server/future/route-modules/app-route/module.compiled.js\");\n/* harmony import */ var next_dist_server_future_route_modules_app_route_module_compiled__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(next_dist_server_future_route_modules_app_route_module_compiled__WEBPACK_IMPORTED_MODULE_0__);\n/* harmony import */ var next_dist_server_future_route_kind__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! next/dist/server/future/route-kind */ \"(rsc)/./node_modules/next/dist/server/future/route-kind.js\");\n/* harmony import */ var next_dist_server_lib_patch_fetch__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! next/dist/server/lib/patch-fetch */ \"(rsc)/./node_modules/next/dist/server/lib/patch-fetch.js\");\n/* harmony import */ var next_dist_server_lib_patch_fetch__WEBPACK_IMPORTED_MODULE_2___default = /*#__PURE__*/__webpack_require__.n(next_dist_server_lib_patch_fetch__WEBPACK_IMPORTED_MODULE_2__);\n/* harmony import */ var _Users_sayuri_caddonworks_src_app_api_bids_id_negotiate_route_ts__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./src/app/api/bids/[id]/negotiate/route.ts */ \"(rsc)/./src/app/api/bids/[id]/negotiate/route.ts\");\n\n\n\n\n// We inject the nextConfigOutput here so that we can use them in the route\n// module.\nconst nextConfigOutput = \"\"\nconst routeModule = new next_dist_server_future_route_modules_app_route_module_compiled__WEBPACK_IMPORTED_MODULE_0__.AppRouteRouteModule({\n    definition: {\n        kind: next_dist_server_future_route_kind__WEBPACK_IMPORTED_MODULE_1__.RouteKind.APP_ROUTE,\n        page: \"/api/bids/[id]/negotiate/route\",\n        pathname: \"/api/bids/[id]/negotiate\",\n        filename: \"route\",\n        bundlePath: \"app/api/bids/[id]/negotiate/route\"\n    },\n    resolvedPagePath: \"/Users/sayuri/caddonworks/src/app/api/bids/[id]/negotiate/route.ts\",\n    nextConfigOutput,\n    userland: _Users_sayuri_caddonworks_src_app_api_bids_id_negotiate_route_ts__WEBPACK_IMPORTED_MODULE_3__\n});\n// Pull out the exports that we need to expose from the module. This should\n// be eliminated when we've moved the other routes to the new format. These\n// are used to hook into the route.\nconst { requestAsyncStorage, staticGenerationAsyncStorage, serverHooks, headerHooks, staticGenerationBailout } = routeModule;\nconst originalPathname = \"/api/bids/[id]/negotiate/route\";\nfunction patchFetch() {\n    return (0,next_dist_server_lib_patch_fetch__WEBPACK_IMPORTED_MODULE_2__.patchFetch)({\n        serverHooks,\n        staticGenerationAsyncStorage\n    });\n}\n\n\n//# sourceMappingURL=app-route.js.map//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9ub2RlX21vZHVsZXMvbmV4dC9kaXN0L2J1aWxkL3dlYnBhY2svbG9hZGVycy9uZXh0LWFwcC1sb2FkZXIuanM/bmFtZT1hcHAlMkZhcGklMkZiaWRzJTJGJTVCaWQlNUQlMkZuZWdvdGlhdGUlMkZyb3V0ZSZwYWdlPSUyRmFwaSUyRmJpZHMlMkYlNUJpZCU1RCUyRm5lZ290aWF0ZSUyRnJvdXRlJmFwcFBhdGhzPSZwYWdlUGF0aD1wcml2YXRlLW5leHQtYXBwLWRpciUyRmFwaSUyRmJpZHMlMkYlNUJpZCU1RCUyRm5lZ290aWF0ZSUyRnJvdXRlLnRzJmFwcERpcj0lMkZVc2VycyUyRnNheXVyaSUyRmNhZGRvbndvcmtzJTJGc3JjJTJGYXBwJnBhZ2VFeHRlbnNpb25zPXRzeCZwYWdlRXh0ZW5zaW9ucz10cyZwYWdlRXh0ZW5zaW9ucz1qc3gmcGFnZUV4dGVuc2lvbnM9anMmcm9vdERpcj0lMkZVc2VycyUyRnNheXVyaSUyRmNhZGRvbndvcmtzJmlzRGV2PXRydWUmdHNjb25maWdQYXRoPXRzY29uZmlnLmpzb24mYmFzZVBhdGg9JmFzc2V0UHJlZml4PSZuZXh0Q29uZmlnT3V0cHV0PSZwcmVmZXJyZWRSZWdpb249Jm1pZGRsZXdhcmVDb25maWc9ZTMwJTNEISIsIm1hcHBpbmdzIjoiOzs7Ozs7Ozs7Ozs7Ozs7OztBQUFzRztBQUN2QztBQUNjO0FBQ2tCO0FBQy9GO0FBQ0E7QUFDQTtBQUNBLHdCQUF3QixnSEFBbUI7QUFDM0M7QUFDQSxjQUFjLHlFQUFTO0FBQ3ZCO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQSxZQUFZO0FBQ1osQ0FBQztBQUNEO0FBQ0E7QUFDQTtBQUNBLFFBQVEsdUdBQXVHO0FBQy9HO0FBQ0E7QUFDQSxXQUFXLDRFQUFXO0FBQ3RCO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDNko7O0FBRTdKIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vY2l2aWwtZW5naW5lZXJpbmctcGxhdGZvcm0vPzU3ZjQiXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgQXBwUm91dGVSb3V0ZU1vZHVsZSB9IGZyb20gXCJuZXh0L2Rpc3Qvc2VydmVyL2Z1dHVyZS9yb3V0ZS1tb2R1bGVzL2FwcC1yb3V0ZS9tb2R1bGUuY29tcGlsZWRcIjtcbmltcG9ydCB7IFJvdXRlS2luZCB9IGZyb20gXCJuZXh0L2Rpc3Qvc2VydmVyL2Z1dHVyZS9yb3V0ZS1raW5kXCI7XG5pbXBvcnQgeyBwYXRjaEZldGNoIGFzIF9wYXRjaEZldGNoIH0gZnJvbSBcIm5leHQvZGlzdC9zZXJ2ZXIvbGliL3BhdGNoLWZldGNoXCI7XG5pbXBvcnQgKiBhcyB1c2VybGFuZCBmcm9tIFwiL1VzZXJzL3NheXVyaS9jYWRkb253b3Jrcy9zcmMvYXBwL2FwaS9iaWRzL1tpZF0vbmVnb3RpYXRlL3JvdXRlLnRzXCI7XG4vLyBXZSBpbmplY3QgdGhlIG5leHRDb25maWdPdXRwdXQgaGVyZSBzbyB0aGF0IHdlIGNhbiB1c2UgdGhlbSBpbiB0aGUgcm91dGVcbi8vIG1vZHVsZS5cbmNvbnN0IG5leHRDb25maWdPdXRwdXQgPSBcIlwiXG5jb25zdCByb3V0ZU1vZHVsZSA9IG5ldyBBcHBSb3V0ZVJvdXRlTW9kdWxlKHtcbiAgICBkZWZpbml0aW9uOiB7XG4gICAgICAgIGtpbmQ6IFJvdXRlS2luZC5BUFBfUk9VVEUsXG4gICAgICAgIHBhZ2U6IFwiL2FwaS9iaWRzL1tpZF0vbmVnb3RpYXRlL3JvdXRlXCIsXG4gICAgICAgIHBhdGhuYW1lOiBcIi9hcGkvYmlkcy9baWRdL25lZ290aWF0ZVwiLFxuICAgICAgICBmaWxlbmFtZTogXCJyb3V0ZVwiLFxuICAgICAgICBidW5kbGVQYXRoOiBcImFwcC9hcGkvYmlkcy9baWRdL25lZ290aWF0ZS9yb3V0ZVwiXG4gICAgfSxcbiAgICByZXNvbHZlZFBhZ2VQYXRoOiBcIi9Vc2Vycy9zYXl1cmkvY2FkZG9ud29ya3Mvc3JjL2FwcC9hcGkvYmlkcy9baWRdL25lZ290aWF0ZS9yb3V0ZS50c1wiLFxuICAgIG5leHRDb25maWdPdXRwdXQsXG4gICAgdXNlcmxhbmRcbn0pO1xuLy8gUHVsbCBvdXQgdGhlIGV4cG9ydHMgdGhhdCB3ZSBuZWVkIHRvIGV4cG9zZSBmcm9tIHRoZSBtb2R1bGUuIFRoaXMgc2hvdWxkXG4vLyBiZSBlbGltaW5hdGVkIHdoZW4gd2UndmUgbW92ZWQgdGhlIG90aGVyIHJvdXRlcyB0byB0aGUgbmV3IGZvcm1hdC4gVGhlc2Vcbi8vIGFyZSB1c2VkIHRvIGhvb2sgaW50byB0aGUgcm91dGUuXG5jb25zdCB7IHJlcXVlc3RBc3luY1N0b3JhZ2UsIHN0YXRpY0dlbmVyYXRpb25Bc3luY1N0b3JhZ2UsIHNlcnZlckhvb2tzLCBoZWFkZXJIb29rcywgc3RhdGljR2VuZXJhdGlvbkJhaWxvdXQgfSA9IHJvdXRlTW9kdWxlO1xuY29uc3Qgb3JpZ2luYWxQYXRobmFtZSA9IFwiL2FwaS9iaWRzL1tpZF0vbmVnb3RpYXRlL3JvdXRlXCI7XG5mdW5jdGlvbiBwYXRjaEZldGNoKCkge1xuICAgIHJldHVybiBfcGF0Y2hGZXRjaCh7XG4gICAgICAgIHNlcnZlckhvb2tzLFxuICAgICAgICBzdGF0aWNHZW5lcmF0aW9uQXN5bmNTdG9yYWdlXG4gICAgfSk7XG59XG5leHBvcnQgeyByb3V0ZU1vZHVsZSwgcmVxdWVzdEFzeW5jU3RvcmFnZSwgc3RhdGljR2VuZXJhdGlvbkFzeW5jU3RvcmFnZSwgc2VydmVySG9va3MsIGhlYWRlckhvb2tzLCBzdGF0aWNHZW5lcmF0aW9uQmFpbG91dCwgb3JpZ2luYWxQYXRobmFtZSwgcGF0Y2hGZXRjaCwgIH07XG5cbi8vIyBzb3VyY2VNYXBwaW5nVVJMPWFwcC1yb3V0ZS5qcy5tYXAiXSwibmFtZXMiOltdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///(rsc)/./node_modules/next/dist/build/webpack/loaders/next-app-loader.js?name=app%2Fapi%2Fbids%2F%5Bid%5D%2Fnegotiate%2Froute&page=%2Fapi%2Fbids%2F%5Bid%5D%2Fnegotiate%2Froute&appPaths=&pagePath=private-next-app-dir%2Fapi%2Fbids%2F%5Bid%5D%2Fnegotiate%2Froute.ts&appDir=%2FUsers%2Fsayuri%2Fcaddonworks%2Fsrc%2Fapp&pageExtensions=tsx&pageExtensions=ts&pageExtensions=jsx&pageExtensions=js&rootDir=%2FUsers%2Fsayuri%2Fcaddonworks&isDev=true&tsconfigPath=tsconfig.json&basePath=&assetPrefix=&nextConfigOutput=&preferredRegion=&middlewareConfig=e30%3D!\n");

/***/ }),

/***/ "(rsc)/./src/app/api/bids/[id]/negotiate/route.ts":
/*!**************************************************!*\
  !*** ./src/app/api/bids/[id]/negotiate/route.ts ***!
  \**************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   PUT: () => (/* binding */ PUT)\n/* harmony export */ });\n/* harmony import */ var next_dist_server_web_exports_next_response__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! next/dist/server/web/exports/next-response */ \"(rsc)/./node_modules/next/dist/server/web/exports/next-response.js\");\n/* harmony import */ var _supabase_supabase_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! @supabase/supabase-js */ \"(rsc)/./node_modules/@supabase/supabase-js/dist/module/index.js\");\n\n\nconst supabaseAdmin = (0,_supabase_supabase_js__WEBPACK_IMPORTED_MODULE_1__.createClient)(\"https://rxnozwuamddqlcwysxag.supabase.co\", process.env.SUPABASE_SERVICE_ROLE_KEY, {\n    auth: {\n        autoRefreshToken: false,\n        persistSession: false\n    }\n});\nasync function PUT(request, { params }) {\n    try {\n        const bidId = params.id;\n        const body = await request.json();\n        const { action, rejection_reason, skip_box_creation } = body;\n        // Authorizationヘッダーからユーザー情報を取得\n        const authHeader = request.headers.get(\"authorization\");\n        if (!authHeader) {\n            return next_dist_server_web_exports_next_response__WEBPACK_IMPORTED_MODULE_0__[\"default\"].json({\n                message: \"認証が必要です\"\n            }, {\n                status: 401\n            });\n        }\n        const token = authHeader.replace(\"Bearer \", \"\");\n        const { data: { user }, error: authError } = await supabaseAdmin.auth.getUser(token);\n        if (authError || !user) {\n            console.error(\"認証エラー:\", authError);\n            return next_dist_server_web_exports_next_response__WEBPACK_IMPORTED_MODULE_0__[\"default\"].json({\n                message: \"認証に失敗しました\"\n            }, {\n                status: 401\n            });\n        }\n        // ユーザープロフィールを取得\n        const { data: userProfile, error: userError } = await supabaseAdmin.from(\"users\").select(\"id, email, display_name\").eq(\"auth_user_id\", user.id).single();\n        if (userError || !userProfile) {\n            return next_dist_server_web_exports_next_response__WEBPACK_IMPORTED_MODULE_0__[\"default\"].json({\n                message: \"ユーザープロフィールが見つかりません\"\n            }, {\n                status: 403\n            });\n        }\n        // 入札情報を取得\n        const { data: bid, error: bidError } = await supabaseAdmin.from(\"bids\").select(`\n        *,\n        projects!inner(\n          id,\n          title,\n          org_id,\n          contractor_id\n        )\n      `).eq(\"id\", bidId).single();\n        if (bidError || !bid) {\n            return next_dist_server_web_exports_next_response__WEBPACK_IMPORTED_MODULE_0__[\"default\"].json({\n                message: \"入札が見つかりません\"\n            }, {\n                status: 404\n            });\n        }\n        // 発注者権限をチェック（OrgAdmin もしくは Admin を許可）\n        const { data: allMemberships, error: membershipError } = await supabaseAdmin.from(\"memberships\").select(\"role, org_id\").eq(\"user_id\", userProfile.id);\n        if (membershipError) {\n            return next_dist_server_web_exports_next_response__WEBPACK_IMPORTED_MODULE_0__[\"default\"].json({\n                message: \"メンバーシップ取得に失敗しました\"\n            }, {\n                status: 500\n            });\n        }\n        const hasOrgAdmin = (allMemberships || []).some((m)=>m.role === \"OrgAdmin\" && m.org_id === bid.projects.org_id);\n        const hasAdmin = (allMemberships || []).some((m)=>m.role === \"Admin\");\n        if (!hasOrgAdmin && !hasAdmin) {\n            return next_dist_server_web_exports_next_response__WEBPACK_IMPORTED_MODULE_0__[\"default\"].json({\n                message: \"この操作を実行する権限がありません\",\n                debug: {\n                    orgId: bid.projects.org_id\n                }\n            }, {\n                status: 403\n            });\n        }\n        // アクションに応じて処理\n        if (action === \"approve\") {\n            // 入札を承認（スキーマ互換: status を 'accepted' に更新）\n            const { data: updatedBid, error: updateError } = await supabaseAdmin.from(\"bids\").update({\n                status: \"accepted\"\n            }).eq(\"id\", bidId).select().single();\n            if (updateError) {\n                return next_dist_server_web_exports_next_response__WEBPACK_IMPORTED_MODULE_0__[\"default\"].json({\n                    message: \"入札の承認に失敗しました\",\n                    details: String(updateError.message || updateError)\n                }, {\n                    status: 500\n                });\n            }\n            // Boxフォルダを作成（入札承認後）- skip_box_creationがtrueの場合はスキップ\n            if (!skip_box_creation) {\n                try {\n                    const parentId = process.env.BOX_PROJECTS_ROOT_FOLDER_ID;\n                    if (parentId) {\n                        const folderName = `[PRJ-${bid.projects.id.slice(0, 8)}] ${bid.projects.title}`;\n                        const subfolders = [\n                            \"受取\",\n                            \"作業\",\n                            \"納品\",\n                            \"契約\"\n                        ];\n                        const boxApiUrl = `${process.env.NEXT_PUBLIC_BASE_URL || \"http://localhost:3000\"}/api/box/provision`;\n                        // タイムアウト付きでBOX API呼び出し\n                        const boxPromise = fetch(boxApiUrl, {\n                            method: \"POST\",\n                            headers: {\n                                \"Content-Type\": \"application/json\"\n                            },\n                            body: JSON.stringify({\n                                name: folderName,\n                                parentId,\n                                subfolders\n                            })\n                        });\n                        const timeoutPromise = new Promise((_, reject)=>{\n                            setTimeout(()=>reject(new Error(\"BOX API timeout\")), 5000) // 5秒でタイムアウト\n                            ;\n                        });\n                        const boxResponse = await Promise.race([\n                            boxPromise,\n                            timeoutPromise\n                        ]);\n                        if (boxResponse.ok) {\n                            const { folderId } = await boxResponse.json();\n                            // プロジェクトにBox情報を保存\n                            await supabaseAdmin.from(\"projects\").update({\n                                box_folder_id: folderId\n                            }).eq(\"id\", bid.projects.id);\n                        }\n                    }\n                } catch (boxError) {\n                    console.warn(\"BOX フォルダ作成エラー（入札承認は続行）:\", boxError);\n                // Box作成エラーは入札承認を妨げない\n                }\n            }\n            // 受注者に通知\n            await supabaseAdmin.from(\"notifications\").insert({\n                user_id: bid.contractor_id,\n                title: \"入札が承認されました\",\n                message: `案件「${bid.projects.title}」の入札金額（¥${bid.bid_amount.toLocaleString()}）が承認されました。契約の作成をお待ちください。`,\n                type: \"bid_approved\",\n                data: {\n                    bid_id: bidId,\n                    project_id: bid.projects.id\n                }\n            });\n            return next_dist_server_web_exports_next_response__WEBPACK_IMPORTED_MODULE_0__[\"default\"].json({\n                message: \"入札を承認しました\",\n                bid: updatedBid\n            });\n        } else if (action === \"reject\") {\n            if (!rejection_reason) {\n                return next_dist_server_web_exports_next_response__WEBPACK_IMPORTED_MODULE_0__[\"default\"].json({\n                    message: \"拒否理由を入力してください\"\n                }, {\n                    status: 400\n                });\n            }\n            // 入札を拒否（まず status のみ、列互換のため）\n            const { error: statusErr } = await supabaseAdmin.from(\"bids\").update({\n                status: \"rejected\"\n            }).eq(\"id\", bidId);\n            if (statusErr) {\n                return next_dist_server_web_exports_next_response__WEBPACK_IMPORTED_MODULE_0__[\"default\"].json({\n                    message: \"入札の拒否に失敗しました\",\n                    details: String(statusErr.message || statusErr)\n                }, {\n                    status: 500\n                });\n            }\n            // rejection_reason 列があれば追記\n            try {\n                const probe = await supabaseAdmin.from(\"bids\").select(\"rejection_reason\").limit(1);\n                if (!probe.error) {\n                    await supabaseAdmin.from(\"bids\").update({\n                        rejection_reason\n                    }).eq(\"id\", bidId);\n                }\n            } catch (_) {}\n            const { data: updatedBid, error: fetchError } = await supabaseAdmin.from(\"bids\").select(\"*\").eq(\"id\", bidId).single();\n            if (fetchError) {\n                return next_dist_server_web_exports_next_response__WEBPACK_IMPORTED_MODULE_0__[\"default\"].json({\n                    message: \"入札の拒否に失敗しました\"\n                }, {\n                    status: 500\n                });\n            }\n            // 受注者に通知\n            await supabaseAdmin.from(\"notifications\").insert({\n                user_id: bid.contractor_id,\n                title: \"入札金額について\",\n                message: `案件「${bid.projects.title}」の入札金額について、発注者から以下の理由で拒否されました：\\n\\n${rejection_reason}\\n\\nこの理由に同意されますか？`,\n                type: \"bid_rejected\",\n                data: {\n                    bid_id: bidId,\n                    project_id: bid.projects.id,\n                    rejection_reason: rejection_reason\n                }\n            });\n            return next_dist_server_web_exports_next_response__WEBPACK_IMPORTED_MODULE_0__[\"default\"].json({\n                message: \"入札を拒否しました。受注者に通知を送信しました。\",\n                bid: updatedBid\n            });\n        } else {\n            return next_dist_server_web_exports_next_response__WEBPACK_IMPORTED_MODULE_0__[\"default\"].json({\n                message: \"無効なアクションです\"\n            }, {\n                status: 400\n            });\n        }\n    } catch (error) {\n        return next_dist_server_web_exports_next_response__WEBPACK_IMPORTED_MODULE_0__[\"default\"].json({\n            message: \"サーバーエラーが発生しました\"\n        }, {\n            status: 500\n        });\n    }\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9zcmMvYXBwL2FwaS9iaWRzL1tpZF0vbmVnb3RpYXRlL3JvdXRlLnRzIiwibWFwcGluZ3MiOiI7Ozs7OztBQUF1RDtBQUNIO0FBRXBELE1BQU1FLGdCQUFnQkQsbUVBQVlBLENBQ2hDRSwwQ0FBb0MsRUFDcENBLFFBQVFDLEdBQUcsQ0FBQ0UseUJBQXlCLEVBQ3JDO0lBQ0VDLE1BQU07UUFDSkMsa0JBQWtCO1FBQ2xCQyxnQkFBZ0I7SUFDbEI7QUFDRjtBQUdLLGVBQWVDLElBQ3BCQyxPQUFvQixFQUNwQixFQUFFQyxNQUFNLEVBQThCO0lBRXRDLElBQUk7UUFDRixNQUFNQyxRQUFRRCxPQUFPRSxFQUFFO1FBQ3ZCLE1BQU1DLE9BQU8sTUFBTUosUUFBUUssSUFBSTtRQUMvQixNQUFNLEVBQUVDLE1BQU0sRUFBRUMsZ0JBQWdCLEVBQUVDLGlCQUFpQixFQUFFLEdBQUdKO1FBRXhELCtCQUErQjtRQUMvQixNQUFNSyxhQUFhVCxRQUFRVSxPQUFPLENBQUNDLEdBQUcsQ0FBQztRQUN2QyxJQUFJLENBQUNGLFlBQVk7WUFDZixPQUFPcEIsa0ZBQVlBLENBQUNnQixJQUFJLENBQ3RCO2dCQUFFTyxTQUFTO1lBQVUsR0FDckI7Z0JBQUVDLFFBQVE7WUFBSTtRQUVsQjtRQUVBLE1BQU1DLFFBQVFMLFdBQVdNLE9BQU8sQ0FBQyxXQUFXO1FBQzVDLE1BQU0sRUFBRUMsTUFBTSxFQUFFQyxJQUFJLEVBQUUsRUFBRUMsT0FBT0MsU0FBUyxFQUFFLEdBQUcsTUFBTTVCLGNBQWNLLElBQUksQ0FBQ3dCLE9BQU8sQ0FBQ047UUFFOUUsSUFBSUssYUFBYSxDQUFDRixNQUFNO1lBQ3RCSSxRQUFRSCxLQUFLLENBQUMsVUFBVUM7WUFDeEIsT0FBTzlCLGtGQUFZQSxDQUFDZ0IsSUFBSSxDQUN0QjtnQkFBRU8sU0FBUztZQUFZLEdBQ3ZCO2dCQUFFQyxRQUFRO1lBQUk7UUFFbEI7UUFFQSxnQkFBZ0I7UUFDaEIsTUFBTSxFQUFFRyxNQUFNTSxXQUFXLEVBQUVKLE9BQU9L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LENBQUMsTUFBTXhCLE9BQ1R5QixNQUFNO1lBRVQsSUFBSXlELFlBQVk7Z0JBQ2QsT0FBTy9GLGtGQUFZQSxDQUFDZ0IsSUFBSSxDQUN0QjtvQkFBRU8sU0FBUztnQkFBZSxHQUMxQjtvQkFBRUMsUUFBUTtnQkFBSTtZQUVsQjtZQUVBLFNBQVM7WUFDVCxNQUFNdEIsY0FDSGlDLElBQUksQ0FBQyxpQkFDTGlELE1BQU0sQ0FBQztnQkFDTkMsU0FBUzlDLElBQUkrQyxhQUFhO2dCQUMxQnpCLE9BQU87Z0JBQ1B0QyxTQUFTLENBQUMsR0FBRyxFQUFFZ0IsSUFBSVMsUUFBUSxDQUFDYSxLQUFLLENBQUMsa0NBQWtDLEVBQUUzQyxpQkFBaUIsaUJBQWlCLENBQUM7Z0JBQ3pHdUUsTUFBTTtnQkFDTjlELE1BQU07b0JBQ0orRCxRQUFRN0U7b0JBQ1I4RSxZQUFZcEQsSUFBSVMsUUFBUSxDQUFDbEMsRUFBRTtvQkFDM0JJLGtCQUFrQkE7Z0JBQ3BCO1lBQ0Y7WUFFRixPQUFPbEIsa0ZBQVlBLENBQUNnQixJQUFJLENBQUM7Z0JBQ3ZCTyxTQUFTO2dCQUNUZ0IsS0FBS2E7WUFDUDtRQUVGLE9BQU87WUFDTCxPQUFPcEQsa0ZBQVlBLENBQUNnQixJQUFJLENBQ3RCO2dCQUFFTyxTQUFTO1lBQWEsR0FDeEI7Z0JBQUVDLFFBQVE7WUFBSTtRQUVsQjtJQUVGLEVBQUUsT0FBT0ssT0FBTztRQUNkLE9BQU83QixrRkFBWUEsQ0FBQ2dCLElBQUksQ0FDdEI7WUFBRU8sU0FBUztRQUFpQixHQUM1QjtZQUFFQyxRQUFRO1FBQUk7SUFFbEI7QUFDRiIsInNvdXJjZXMiOlsid2VicGFjazovL2NpdmlsLWVuZ2luZWVyaW5nLXBsYXRmb3JtLy4vc3JjL2FwcC9hcGkvYmlkcy9baWRdL25lZ290aWF0ZS9yb3V0ZS50cz9lYjJhIl0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IE5leHRSZXF1ZXN0LCBOZXh0UmVzcG9uc2UgfSBmcm9tICduZXh0L3NlcnZlcidcbmltcG9ydCB7IGNyZWF0ZUNsaWVudCB9IGZyb20gJ0BzdXBhYmFzZS9zdXBhYmFzZS1qcydcblxuY29uc3Qgc3VwYWJhc2VBZG1pbiA9IGNyZWF0ZUNsaWVudChcbiAgcHJvY2Vzcy5lbnYuTkVYVF9QVUJMSUNfU1VQQUJBU0VfVVJMISxcbiAgcHJvY2Vzcy5lbnYuU1VQQUJBU0VfU0VSVklDRV9ST0xFX0tFWSEsXG4gIHtcbiAgICBhdXRoOiB7XG4gICAgICBhdXRvUmVmcmVzaFRva2VuOiBmYWxzZSxcbiAgICAgIHBlcnNpc3RTZXNzaW9uOiBmYWxzZVxuICAgIH1cbiAgfVxuKVxuXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gUFVUKFxuICByZXF1ZXN0OiBOZXh0UmVxdWVzdCxcbiAgeyBwYXJhbXMgfTogeyBwYXJhbXM6IHsgaWQ6IHN0cmluZyB9IH1cbikge1xuICB0cnkge1xuICAgIGNvbnN0IGJpZElkID0gcGFyYW1zLmlkXG4gICAgY29uc3QgYm9keSA9IGF3YWl0IHJlcXVlc3QuanNvbigpXG4gICAgY29uc3QgeyBhY3Rpb24sIHJlamVjdGlvbl9yZWFzb24sIHNraXBfYm94X2NyZWF0aW9uIH0gPSBib2R5XG5cbiAgICAvLyBBdXRob3JpemF0aW9u44OY44OD44OA44O844GL44KJ44Om44O844K244O85oOF5aCx44KS5Y+W5b6XXG4gICAgY29uc3QgYXV0aEhlYWRlciA9IHJlcXVlc3QuaGVhZGVycy5nZXQoJ2F1dGhvcml6YXRpb24nKVxuICAgIGlmICghYXV0aEhlYWRlcikge1xuICAgICAgcmV0dXJuIE5leHRSZXNwb25zZS5qc29uKFxuICAgICAgICB7IG1lc3NhZ2U6ICfoqo3oqLzjgYzlv4XopoHjgafjgZknIH0sXG4gICAgICAgIHsgc3RhdHVzOiA0MDEgfVxuICAgICAgKVxuICAgIH1cblxuICAgIGNvbnN0IHRva2VuID0gYXV0aEhlYWRlci5yZXBsYWNlKCdCZWFyZXIgJywgJycpXG4gICAgY29uc3QgeyBkYXRhOiB7IHVzZXIgfSwgZXJyb3I6IGF1dGhFcnJvciB9ID0gYXdhaXQgc3VwYWJhc2VBZG1pbi5hdXRoLmdldFVzZXIodG9rZW4pXG4gICAgXG4gICAgaWYgKGF1dGhFcnJvciB8fCAhdXNlcikge1xuICAgICAgY29uc29sZS5lcnJvcign6KqN6Ki844Ko44Op44O8OicsIGF1dGhFcnJvcilcbiAgICAgIHJldHVybiBOZXh0UmVzcG9uc2UuanNvbihcbiAgICAgICAgeyBtZXNzYWdlOiAn6KqN6Ki844Gr5aSx5pWX44GX44G+44GX44GfJyB9LFxuICAgICAgICB7IHN0YXR1czogNDAxIH1cbiAgICAgIClcbiAgICB9XG5cbiAgICAvLyDjg6bjg7zjgrbjg7zjg5fjg63jg5XjgqPjg7zjg6vjgpLlj5blvpdcbiAgICBjb25zdCB7IGRhdGE6IHVzZXJQcm9maWxlLCBlcnJvcjogdXNlckVycm9yIH0gPSBhd2FpdCBzdXBhYmFzZUFkbWluXG4gICAgICAuZnJvbSgndXNlcnMnKVxuICAgICAgLnNlbGVjdCgnaWQsIGVtYWlsLCBkaXNwbGF5X25hbWUnKVxuICAgICAgLmVxKCdhdXRoX3VzZXJfaWQnLCB1c2VyLmlkKVxuICAgICAgLnNpbmdsZSgpXG5cbiAgICBpZiAodXNlckVycm9yIHx8ICF1c2VyUHJvZmlsZSkge1xuICAgICAgcmV0dXJuIE5leHRSZXNwb25zZS5qc29uKFxuICAgICAgICB7IG1lc3NhZ2U6ICfjg6bjg7zjgrbjg7zjg5fjg63jg5XjgqPjg7zjg6vjgYzopovjgaTjgYvjgorjgb7jgZvjgpMnIH0sXG4gICAgICAgIHsgc3RhdHVzOiA0MDMgfVxuICAgICAgKVxuICAgIH1cblxuICAgIC8vIOWFpeacreaDheWgseOCkuWPluW+l1xuICAgIGNvbnN0IHsgZGF0YTogYmlkLCBlcnJvcjogYmlkRXJyb3IgfSA9IGF3YWl0IHN1cGFiYXNlQWRtaW5cbiAgICAgIC5mcm9tKCdiaWRzJylcbiAgICAgIC5zZWxlY3QoYFxuICAgICAgICAqLFxuICAgICAgICBwcm9qZWN0cyFpbm5lcihcbiAgICAgICAgICBpZCxcbiAgICAgICAgICB0aXRsZSxcbiAgICAgICAgICBvcmdfaWQsXG4gICAgICAgICAgY29udHJhY3Rvcl9pZFxuICAgICAgICApXG4gICAgICBgKVxuICAgICAgLmVxKCdpZCcsIGJpZElkKVxuICAgICAgLnNpbmdsZSgpXG5cbiAgICBpZiAoYmlkRXJyb3IgfHwgIWJpZCkge1xuICAgICAgcmV0dXJuIE5leHRSZXNwb25zZS5qc29uKFxuICAgICAgICB7IG1lc3NhZ2U6ICflhaXmnK3jgYzopovjgaTjgYvjgorjgb7jgZvjgpMnIH0sXG4gICAgICAgIHsgc3RhdHVzOiA0MDQgfVxuICAgICAgKVxuICAgIH1cblxuICAgIC8vIOeZuuazqOiAheaoqemZkOOCkuODgeOCp+ODg+OCr++8iE9yZ0FkbWluIOOCguOBl+OBj+OBryBBZG1pbiDjgpLoqLHlj6/vvIlcbiAgICBjb25zdCB7IGRhdGE6IGFsbE1lbWJlcnNoaXBzLCBlcnJvcjogbWVtYmVyc2hpcEVycm9yIH0gPSBhd2FpdCBzdXBhYmFzZUFkbWluXG4gICAgICAuZnJvbSgnbWVtYmVyc2hpcHMnKVxuICAgICAgLnNlbGVjdCgncm9sZSwgb3JnX2lkJylcbiAgICAgIC5lcSgndXNlcl9pZCcsIHVzZXJQcm9maWxlLmlkKVxuXG4gICAgaWYgKG1lbWJlcnNoaXBFcnJvcikge1xuICAgICAgcmV0dXJuIE5leHRSZXNwb25zZS5qc29uKHsgbWVzc2FnZTogJ+ODoeODs+ODkOODvOOCt+ODg+ODl+WPluW+l+OBq+WkseaVl+OBl+OBvuOBl+OBnycgfSwgeyBzdGF0dXM6IDUwMCB9KVxuICAgIH1cblxuICAgIGNvbnN0IGhhc09yZ0FkbWluID0gKGFsbE1lbWJlcnNoaXBzIHx8IFtdKS5zb21lKG0gPT4gbS5yb2xlID09PSAnT3JnQWRtaW4nICYmIG0ub3JnX2lkID09PSBiaWQucHJvamVjdHMub3JnX2lkKVxuICAgIGNvbnN0IGhhc0FkbWluID0gKGFsbE1lbWJlcnNoaXBzIHx8IFtdKS5zb21lKG0gPT4gbS5yb2xlID09PSAnQWRtaW4nKVxuXG4gICAgaWYgKCFoYXNPcmdBZG1pbiAmJiAhaGFzQWRtaW4pIHtcbiAgICAgIHJldHVybiBOZXh0UmVzcG9uc2UuanNvbih7XG4gICAgICAgIG1lc3NhZ2U6ICfjgZPjga7mk43kvZzjgpLlrp/ooYzjgZnjgovmqKnpmZDjgYzjgYLjgorjgb7jgZvjgpMnLFxuICAgICAgICBkZWJ1ZzogeyBvcmdJZDogYmlkLnByb2plY3RzLm9yZ19pZCB9XG4gICAgICB9LCB7IHN0YXR1czogNDAzIH0pXG4gICAgfVxuXG4gICAgLy8g44Ki44Kv44K344On44Oz44Gr5b+c44GY44Gm5Yem55CGXG4gICAgaWYgKGFjdGlvbiA9PT0gJ2FwcHJvdmUnKSB7XG4gICAgICAvLyDlhaXmnK3jgpLmib/oqo3vvIjjgrnjgq3jg7zjg57kupLmj5s6IHN0YXR1cyDjgpIgJ2FjY2VwdGVkJyDjgavmm7TmlrDvvIlcbiAgICAgIGNvbnN0IHsgZGF0YTogdXBkYXRlZEJpZCwgZXJyb3I6IHVwZGF0ZUVycm9yIH0gPSBhd2FpdCBzdXBhYmFzZUFkbWluXG4gICAgICAgIC5mcm9tKCdiaWRzJylcbiAgICAgICAgLnVwZGF0ZSh7IHN0YXR1czogJ2FjY2VwdGVkJyB9KVxuICAgICAgICAuZXEoJ2lkJywgYmlkSWQpXG4gICAgICAgIC5zZWxlY3QoKVxuICAgICAgICAuc2luZ2xlKClcblxuICAgICAgaWYgKHVwZGF0ZUVycm9yKSB7XG4gICAgICAgIHJldHVybiBOZXh0UmVzcG9uc2UuanNvbih7IG1lc3NhZ2U6ICflhaXmnK3jga7mib/oqo3jgavlpLHmlZfjgZfjgb7jgZfjgZ8nLCBkZXRhaWxzOiBTdHJpbmcodXBkYXRlRXJyb3IubWVzc2FnZSB8fCB1cGRhdGVFcnJvcikgfSwgeyBzdGF0dXM6IDUwMCB9KVxuICAgICAgfVxuXG4gICAgICAvLyBCb3jjg5Xjgqnjg6vjg4DjgpLkvZzmiJDvvIjlhaXmnK3mib/oqo3lvozvvIktIHNraXBfYm94X2NyZWF0aW9u44GMdHJ1ZeOBruWgtOWQiOOBr+OCueOCreODg+ODl1xuICAgICAgaWYgKCFza2lwX2JveF9jcmVhdGlvbikge1xuICAgICAgICB0cnkge1xuICAgICAgICAgIGNvbnN0IHBhcmVudElkID0gcHJvY2Vzcy5lbnYuQk9YX1BST0pFQ1RTX1JPT1RfRk9MREVSX0lEXG5cbiAgICAgICAgICBpZiAocGFyZW50SWQpIHtcbiAgICAgICAgICAgIGNvbnN0IGZvbGRlck5hbWUgPSBgW1BSSi0ke2JpZC5wcm9qZWN0cy5pZC5zbGljZSgwLCA4KX1dICR7YmlkLnByb2plY3RzLnRpdGxlfWBcbiAgICAgICAgICAgIGNvbnN0IHN1YmZvbGRlcnMgPSBbJ+WPl+WPlicsICfkvZzmpa0nLCAn57SN5ZOBJywgJ+Wlkee0hCddXG5cbiAgICAgICAgICAgIGNvbnN0IGJveEFwaVVybCA9IGAke3Byb2Nlc3MuZW52Lk5FWFRfUFVCTElDX0JBU0VfVVJMIHx8ICdodHRwOi8vbG9jYWxob3N0OjMwMDAnfS9hcGkvYm94L3Byb3Zpc2lvbmBcblxuICAgICAgICAgICAgLy8g44K/44Kk44Og44Ki44Km44OI5LuY44GN44GnQk9YIEFQSeWRvOOBs+WHuuOBl1xuICAgICAgICAgICAgY29uc3QgYm94UHJvbWlzZSA9IGZldGNoKGJveEFwaVVybCwge1xuICAgICAgICAgICAgICBtZXRob2Q6ICdQT1NUJyxcbiAgICAgICAgICAgICAgaGVhZGVyczogeyAnQ29udGVudC1UeXBlJzogJ2FwcGxpY2F0aW9uL2pzb24nIH0sXG4gICAgICAgICAgICAgIGJvZHk6IEpTT04uc3RyaW5naWZ5KHtcbiAgICAgICAgICAgICAgICBuYW1lOiBmb2xkZXJOYW1lLFxuICAgICAgICAgICAgICAgIHBhcmVudElkLFxuICAgICAgICAgICAgICAgIHN1YmZvbGRlcnNcbiAgICAgICAgICAgICAgfSlcbiAgICAgICAgICAgIH0pXG5cbiAgICAgICAgICAgIGNvbnN0IHRpbWVvdXRQcm9taXNlID0gbmV3IFByb21pc2UoKF8sIHJlamVjdCkgPT4ge1xuICAgICAgICAgICAgICBzZXRUaW1lb3V0KCgpID0+IHJlamVjdChuZXcgRXJyb3IoJ0JPWCBBUEkgdGltZW91dCcpKSwgNTAwMCkgLy8gNeenkuOBp+OCv+OCpOODoOOCouOCpuODiFxuICAgICAgICAgICAgfSlcblxuICAgICAgICAgICAgY29uc3QgYm94UmVzcG9uc2UgPSBhd2FpdCBQcm9taXNlLnJhY2UoW2JveFByb21pc2UsIHRpbWVvdXRQcm9taXNlXSkgYXMgUmVzcG9uc2VcblxuICAgICAgICAgICAgaWYgKGJveFJlc3BvbnNlLm9rKSB7XG4gICAgICAgICAgICAgIGNvbnN0IHsgZm9sZGVySWQgfSA9IGF3YWl0IGJveFJlc3BvbnNlLmpzb24oKVxuXG4gICAgICAgICAgICAgIC8vIOODl+ODreOCuOOCp+OCr+ODiOOBq0JveOaDheWgseOCkuS/neWtmFxuICAgICAgICAgICAgICBhd2FpdCBzdXBhYmFzZUFkbWluXG4gICAgICAgICAgICAgICAgLmZyb20oJ3Byb2plY3RzJylcbiAgICAgICAgICAgICAgICAudXBkYXRlKHtcbiAgICAgICAgICAgICAgICAgIGJveF9mb2xkZXJfaWQ6IGZvbGRlcklkXG4gICAgICAgICAgICAgICAgICAvLyBib3hfc3ViZm9sZGVyc+OCq+ODqeODoOOBjOWtmOWcqOOBl+OBquOBhOOBn+OCgeS4gOaZgueahOOBq+mZpOWkllxuICAgICAgICAgICAgICAgIH0pXG4gICAgICAgICAgICAgICAgLmVxKCdpZCcsIGJpZC5wcm9qZWN0cy5pZClcbiAgICAgICAgICAgIH1cbiAgICAgICAgICB9XG4gICAgICAgIH0gY2F0Y2ggKGJveEVycm9yKSB7XG4gICAgICAgICAgY29uc29sZS53YXJuKCdCT1gg44OV44Kp44Or44OA5L2c5oiQ44Ko44Op44O877yI5YWl5pyt5om/6KqN44Gv57aa6KGM77yJOicsIGJveEVycm9yKVxuICAgICAgICAgIC8vIEJveOS9nOaIkOOCqOODqeODvOOBr+WFpeacreaJv+iqjeOCkuWmqOOBkuOBquOBhFxuICAgICAgICB9XG4gICAgICB9XG5cbiAgICAgIC8vIOWPl+azqOiAheOBq+mAmuefpVxuICAgICAgYXdhaXQgc3VwYWJhc2VBZG1pblxuICAgICAgICAuZnJvbSgnbm90aWZpY2F0aW9ucycpXG4gICAgICAgIC5pbnNlcnQoe1xuICAgICAgICAgIHVzZXJfaWQ6IGJpZC5jb250cmFjdG9yX2lkLFxuICAgICAgICAgIHRpdGxlOiAn5YWl5pyt44GM5om/6KqN44GV44KM44G+44GX44GfJyxcbiAgICAgICAgICBtZXNzYWdlOiBg5qGI5Lu244CMJHtiaWQucHJvamVjdHMudGl0bGV944CN44Gu5YWl5pyt6YeR6aGN77yIwqUke2JpZC5iaWRfYW1vdW50LnRvTG9jYWxlU3RyaW5nKCl977yJ44GM5om/6KqN44GV44KM44G+44GX44Gf44CC5aWR57SE44Gu5L2c5oiQ44KS44GK5b6F44Gh44GP44Gg44GV44GE44CCYCxcbiAgICAgICAgICB0eXBlOiAnYmlkX2FwcHJvdmVkJyxcbiAgICAgICAgICBkYXRhOiB7XG4gICAgICAgICAgICBiaWRfaWQ6IGJpZElkLFxuICAgICAgICAgICAgcHJvamVjdF9pZDogYmlkLnByb2plY3RzLmlkXG4gICAgICAgICAgfVxuICAgICAgICB9KVxuXG4gICAgICByZXR1cm4gTmV4dFJlc3BvbnNlLmpzb24oe1xuICAgICAgICBtZXNzYWdlOiAn5YWl5pyt44KS5om/6KqN44GX44G+44GX44GfJyxcbiAgICAgICAgYmlkOiB1cGRhdGVkQmlkXG4gICAgICB9KVxuXG4gICAgfSBlbHNlIGlmIChhY3Rpb24gPT09ICdyZWplY3QnKSB7XG4gICAgICBpZiAoIXJlamVjdGlvbl9yZWFzb24pIHtcbiAgICAgICAgcmV0dXJuIE5leHRSZXNwb25zZS5qc29uKHsgbWVzc2FnZTogJ+aLkuWQpueQhueUseOCkuWFpeWKm+OBl+OBpuOBj+OBoOOBleOBhCcgfSwgeyBzdGF0dXM6IDQwMCB9KVxuICAgICAgfVxuXG4gICAgICAvLyDlhaXmnK3jgpLmi5LlkKbvvIjjgb7jgZogc3RhdHVzIOOBruOBv+OAgeWIl+S6kuaPm+OBruOBn+OCge+8iVxuICAgICAgY29uc3QgeyBlcnJvcjogc3RhdHVzRXJyIH0gPSBhd2FpdCBzdXBhYmFzZUFkbWluXG4gICAgICAgIC5mcm9tKCdiaWRzJylcbiAgICAgICAgLnVwZGF0ZSh7IHN0YXR1czogJ3JlamVjdGVkJyB9KVxuICAgICAgICAuZXEoJ2lkJywgYmlkSWQpXG4gICAgICBpZiAoc3RhdHVzRXJyKSB7XG4gICAgICAgIHJldHVybiBOZXh0UmVzcG9uc2UuanNvbih7IG1lc3NhZ2U6ICflhaXmnK3jga7mi5LlkKbjgavlpLHmlZfjgZfjgb7jgZfjgZ8nLCBkZXRhaWxzOiBTdHJpbmcoc3RhdHVzRXJyLm1lc3NhZ2UgfHwgc3RhdHVzRXJyKSB9LCB7IHN0YXR1czogNTAwIH0pXG4gICAgICB9XG5cbiAgICAgIC8vIHJlamVjdGlvbl9yZWFzb24g5YiX44GM44GC44KM44Gw6L+96KiYXG4gICAgICB0cnkge1xuICAgICAgICBjb25zdCBwcm9iZSA9IGF3YWl0IHN1cGFiYXNlQWRtaW4uZnJvbSgnYmlkcycpLnNlbGVjdCgncmVqZWN0aW9uX3JlYXNvbicpLmxpbWl0KDEpXG4gICAgICAgIGlmICghcHJvYmUuZXJyb3IpIHtcbiAgICAgICAgICBhd2FpdCBzdXBhYmFzZUFkbWluLmZyb20oJ2JpZHMnKS51cGRhdGUoeyByZWplY3Rpb25fcmVhc29uIH0pLmVxKCdpZCcsIGJpZElkKVxuICAgICAgICB9XG4gICAgICB9IGNhdGNoIChfKSB7fVxuXG4gICAgICBjb25zdCB7IGRhdGE6IHVwZGF0ZWRCaWQsIGVycm9yOiBmZXRjaEVycm9yIH0gPSBhd2FpdCBzdXBhYmFzZUFkbWluXG4gICAgICAgIC5mcm9tKCdiaWRzJylcbiAgICAgICAgLnNlbGVjdCgnKicpXG4gICAgICAgIC5lcSgnaWQnLCBiaWRJZClcbiAgICAgICAgLnNpbmdsZSgpXG5cbiAgICAgIGlmIChmZXRjaEVycm9yKSB7XG4gICAgICAgIHJldHVybiBOZXh0UmVzcG9uc2UuanNvbihcbiAgICAgICAgICB7IG1lc3NhZ2U6ICflhaXmnK3jga7mi5LlkKbjgavlpLHmlZfjgZfjgb7jgZfjgZ8nIH0sXG4gICAgICAgICAgeyBzdGF0dXM6IDUwMCB9XG4gICAgICAgIClcbiAgICAgIH1cblxuICAgICAgLy8g5Y+X5rOo6ICF44Gr6YCa55+lXG4gICAgICBhd2FpdCBzdXBhYmFzZUFkbWluXG4gICAgICAgIC5mcm9tKCdub3RpZmljYXRpb25zJylcbiAgICAgICAgLmluc2VydCh7XG4gICAgICAgICAgdXNlcl9pZDogYmlkLmNvbnRyYWN0b3JfaWQsXG4gICAgICAgICAgdGl0bGU6ICflhaXmnK3ph5HpoY3jgavjgaTjgYTjgaYnLFxuICAgICAgICAgIG1lc3NhZ2U6IGDmoYjku7bjgIwke2JpZC5wcm9qZWN0cy50aXRsZX3jgI3jga7lhaXmnK3ph5HpoY3jgavjgaTjgYTjgabjgIHnmbrms6jogIXjgYvjgonku6XkuIvjga7nkIbnlLHjgafmi5LlkKbjgZXjgozjgb7jgZfjgZ/vvJpcXG5cXG4ke3JlamVjdGlvbl9yZWFzb259XFxuXFxu44GT44Gu55CG55Sx44Gr5ZCM5oSP44GV44KM44G+44GZ44GL77yfYCxcbiAgICAgICAgICB0eXBlOiAnYmlkX3JlamVjdGVkJyxcbiAgICAgICAgICBkYXRhOiB7XG4gICAgICAgICAgICBiaWRfaWQ6IGJpZElkLFxuICAgICAgICAgICAgcHJvamVjdF9pZDogYmlkLnByb2plY3RzLmlkLFxuICAgICAgICAgICAgcmVqZWN0aW9uX3JlYXNvbjogcmVqZWN0aW9uX3JlYXNvblxuICAgICAgICAgIH1cbiAgICAgICAgfSlcblxuICAgICAgcmV0dXJuIE5leHRSZXNwb25zZS5qc29uKHtcbiAgICAgICAgbWVzc2FnZTogJ+WFpeacreOCkuaLkuWQpuOBl+OBvuOBl+OBn+OAguWPl+azqOiAheOBq+mAmuefpeOCkumAgeS/oeOBl+OBvuOBl+OBn+OAgicsXG4gICAgICAgIGJpZDogdXBkYXRlZEJpZFxuICAgICAgfSlcblxuICAgIH0gZWxzZSB7XG4gICAgICByZXR1cm4gTmV4dFJlc3BvbnNlLmpzb24oXG4gICAgICAgIHsgbWVzc2FnZTogJ+eEoeWKueOBquOCouOCr+OCt+ODp+ODs+OBp+OBmScgfSxcbiAgICAgICAgeyBzdGF0dXM6IDQwMCB9XG4gICAgICApXG4gICAgfVxuXG4gIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgcmV0dXJuIE5leHRSZXNwb25zZS5qc29uKFxuICAgICAgeyBtZXNzYWdlOiAn44K144O844OQ44O844Ko44Op44O844GM55m655Sf44GX44G+44GX44GfJyB9LFxuICAgICAgeyBzdGF0dXM6IDUwMCB9XG4gICAgKVxuICB9XG59XG4iXSwibmFtZXMiOlsiTmV4dFJlc3BvbnNlIiwiY3JlYXRlQ2xpZW50Iiwic3VwYWJhc2VBZG1pbiIsInByb2Nlc3MiLCJlbnYiLCJORVhUX1BVQkxJQ19TVVBBQkFTRV9VUkwiLCJTVVBBQkFTRV9TRVJWSUNFX1JPTEVfS0VZIiwiYXV0aCIsImF1dG9SZWZyZXNoVG9rZW4iLCJwZXJzaXN0U2Vzc2lvbiIsIlBVVCIsInJlcXVlc3QiLCJwYXJhbXMiLCJiaWRJZCIsImlkIiwiYm9keSIsImpzb24iLCJhY3Rpb24iLCJyZWplY3Rpb25fcmVhc29uIiwic2tpcF9ib3hfY3JlYXRpb24iLCJhdXRoSGVhZGVyIiwiaGVhZGVycyIsImdldCIsIm1lc3NhZ2UiLCJzdGF0dXMiLCJ0b2tlbiIsInJlcGxhY2UiLCJkYXRhIiwidXNlciIsImVycm9yIiwiYXV0aEVycm9yIiwiZ2V0VXNlciIsImNvbnNvbGUiLCJ1c2VyUHJvZmlsZSIsInVzZXJFcnJvciIsImZyb20iLCJzZWxlY3QiLCJlcSIsInNpbmdsZSIsImJpZCIsImJpZEVycm9yIiwiYWxsTWVtYmVyc2hpcHMiLCJtZW1iZXJzaGlwRXJyb3IiLCJoYXNPcmdBZG1pbiIsInNvbWUiLCJtIiwicm9sZSIsIm9yZ19pZCIsInByb2plY3RzIiwiaGFzQWRtaW4iLCJkZWJ1ZyIsIm9yZ0lkIiwidXBkYXRlZEJpZCIsInVwZGF0ZUVycm9yIiwidXBkYXRlIiwiZGV0YWlscyIsIlN0cmluZyIsInBhcmVudElkIiwiQk9YX1BST0pFQ1RTX1JPT1RfRk9MREVSX0lEIiwiZm9sZGVyTmFtZSIsInNsaWNlIiwidGl0bGUiLCJzdWJmb2xkZXJzIiwiYm94QXBpVXJsIiwiTkVYVF9QVUJMSUNfQkFTRV9VUkwiLCJib3hQcm9taXNlIiwiZmV0Y2giLCJtZXRob2QiLCJKU09OIiwic3RyaW5naWZ5IiwibmFtZSIsInRpbWVvdXRQcm9taXNlIiwiUHJvbWlzZSIsIl8iLCJyZWplY3QiLCJzZXRUaW1lb3V0IiwiRXJyb3IiLCJib3hSZXNwb25zZSIsInJhY2UiLCJvayIsImZvbGRlcklkIiwiYm94X2ZvbGRlcl9pZCIsImJveEVycm9yIiwid2FybiIsImluc2VydCIsInVzZXJfaWQiLCJjb250cmFjdG9yX2lkIiwiYmlkX2Ftb3VudCIsInRvTG9jYWxlU3RyaW5nIiwidHlwZSIsImJpZF9pZCIsInByb2plY3RfaWQiLCJzdGF0dXNFcnIiLCJwcm9iZSIsImxpbWl0IiwiZmV0Y2hFcnJvciJdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///(rsc)/./src/app/api/bids/[id]/negotiate/route.ts\n");

/***/ })

};
;

// load runtime
var __webpack_require__ = require("../../../../../webpack-runtime.js");
__webpack_require__.C(exports);
var __webpack_exec__ = (moduleId) => (__webpack_require__(__webpack_require__.s = moduleId))
var __webpack_exports__ = __webpack_require__.X(0, ["vendor-chunks/next","vendor-chunks/@supabase","vendor-chunks/tr46","vendor-chunks/whatwg-url","vendor-chunks/webidl-conversions"], () => (__webpack_exec__("(rsc)/./node_modules/next/dist/build/webpack/loaders/next-app-loader.js?name=app%2Fapi%2Fbids%2F%5Bid%5D%2Fnegotiate%2Froute&page=%2Fapi%2Fbids%2F%5Bid%5D%2Fnegotiate%2Froute&appPaths=&pagePath=private-next-app-dir%2Fapi%2Fbids%2F%5Bid%5D%2Fnegotiate%2Froute.ts&appDir=%2FUsers%2Fsayuri%2Fcaddonworks%2Fsrc%2Fapp&pageExtensions=tsx&pageExtensions=ts&pageExtensions=jsx&pageExtensions=js&rootDir=%2FUsers%2Fsayuri%2Fcaddonworks&isDev=true&tsconfigPath=tsconfig.json&basePath=&assetPrefix=&nextConfigOutput=&preferredRegion=&middlewareConfig=e30%3D!")));
module.exports = __webpack_exports__;

})();