"use strict";(()=>{var e={};e.id=2403,e.ids=[2403],e.modules={30517:e=>{e.exports=require("next/dist/compiled/next-server/app-route.runtime.prod.js")},13685:e=>{e.exports=require("http")},95687:e=>{e.exports=require("https")},85477:e=>{e.exports=require("punycode")},12781:e=>{e.exports=require("stream")},57310:e=>{e.exports=require("url")},59796:e=>{e.exports=require("zlib")},31233:(e,r,o)=>{o.r(r),o.d(r,{headerHooks:()=>p,originalPathname:()=>k,patchFetch:()=>P,requestAsyncStorage:()=>u,routeModule:()=>l,serverHooks:()=>g,staticGenerationAsyncStorage:()=>m,staticGenerationBailout:()=>h});var t={};o.r(t),o.d(t,{GET:()=>d});var a=o(95419),s=o(69108),n=o(99678),i=o(78070);let c=(0,o(32409).eI)("https://rxnozwuamddqlcwysxag.supabase.co",process.env.SUPABASE_SERVICE_ROLE_KEY,{auth:{autoRefreshToken:!1,persistSession:!1}});async function d(e){try{console.log("check-admin-org API: 開始");let{data:e,error:r}=await c.from("users").select("*").eq("email","admin@demo.com");if(console.log("check-admin-org API: 発注者ユーザー情報",{count:e?.length||0,error:r?.message}),r||!e||0===e.length)return i.Z.json({message:"発注者アカウントが見つかりません",error:r?.message});let o=e[0];console.log("check-admin-org API: 発注者ユーザー詳細",o);let{data:t,error:a}=await c.from("memberships").select(`
        id,
        role,
        org_id,
        organizations (
          id,
          name,
          email,
          description
        )
      `).eq("user_id",o.id);console.log("check-admin-org API: メンバーシップ情報",{count:t?.length||0,error:a?.message});let s=[];if(t&&t.length>0){let e=t.map(e=>e.org_id),{data:r,error:o}=await c.from("projects").select("*").in("org_id",e);console.log("check-admin-org API: 発注者の案件",{count:r?.length||0,error:o?.message}),s=r||[]}let{data:n,error:d}=await c.from("projects").select("*");return console.log("check-admin-org API: 全案件",{count:n?.length||0,error:d?.message}),i.Z.json({message:"発注者組織情報確認完了",data:{adminUser:o,memberships:t||[],adminProjects:s||[],allProjects:n||[]}})}catch(e){return console.error("check-admin-org API: エラー",e),i.Z.json({message:"発注者組織情報確認エラー",error:e instanceof Error?e.message:"Unknown error"},{status:500})}}let l=new a.AppRouteRouteModule({definition:{kind:s.x.APP_ROUTE,page:"/api/check-admin-org/route",pathname:"/api/check-admin-org",filename:"route",bundlePath:"app/api/check-admin-org/route"},resolvedPagePath:"/Users/sayuri/caddonworks/src/app/api/check-admin-org/route.ts",nextConfigOutput:"",userland:t}),{requestAsyncStorage:u,staticGenerationAsyncStorage:m,serverHooks:g,headerHooks:p,staticGenerationBailout:h}=l,k="/api/check-admin-org/route";function P(){return(0,n.patchFetch)({serverHooks:g,staticGenerationAsyncStorage:m})}}};var r=require("../../../webpack-runtime.js");r.C(e);var o=e=>r(r.s=e),t=r.X(0,[1638,6206,2409],()=>o(31233));module.exports=t})();