"use strict";(()=>{var e={};e.id=3731,e.ids=[3731],e.modules={30517:e=>{e.exports=require("next/dist/compiled/next-server/app-route.runtime.prod.js")},25291:(e,t,a)=>{a.r(t),a.d(t,{headerHooks:()=>g,originalPathname:()=>m,patchFetch:()=>w,requestAsyncStorage:()=>c,routeModule:()=>u,serverHooks:()=>f,staticGenerationAsyncStorage:()=>p,staticGenerationBailout:()=>h});var r={};a.r(r),a.d(r,{GET:()=>d});var o=a(95419),n=a(69108),i=a(99678),s=a(78070),l=a(95564);async function d(e){try{let{searchParams:t}=new URL(e.url),a=t.get("type")||"invoice",r=t.get("title")||("order"===a?"注文書":"ack"===a?"請書":"請求書"),o=Number(t.get("total")||"0"),n=await l.PDFDocument.create(),i=n.addPage([595.28,841.89]),d=null,u=async()=>{try{let e=new AbortController,t=setTimeout(()=>e.abort(),1e4),a=await fetch("https://fonts.gstatic.com/s/notosansjp/v52/o-0IIpQlx3QUlC5A4PNr5TRASf6M7Q.woff2",{signal:e.signal});if(clearTimeout(t),a.ok){let e=await a.arrayBuffer(),t=new Uint8Array(e);d=await n.embedFont(t,{subset:!1})}else throw Error(`Font fetch failed: ${a.status}`)}catch(e){}d||(d=await n.embedFont(l.StandardFonts.Helvetica))};await u();let c=e=>d&&("Helvetica"===d.name||d.encodeText===l.PDFFont.prototype.encodeText)?e.replace(/[\u0100-\uFFFF]/g,""):e,p=(e,t,a,r=12)=>{i.drawText(c(e),{x:t,y:a,size:r,font:d,color:(0,l.rgb)(0,0,0)})};p(r,240,800,18),p(`発行日: ${new Date().toLocaleDateString("ja-JP")}`,50,770,10),p(`書類種別: ${a}`,50,755,10),i.drawRectangle({x:50,y:650,width:495,height:80,borderColor:(0,l.rgb)(0,0,0),borderWidth:1}),p("金額",60,710,12),p(`${o.toLocaleString("ja-JP")} 円`,60,685,20),p("注: 本書類は電子契約につき収入印紙は不要です。",50,630,10),p("（レイアウトは雛形に基づく簡易版。正式テンプレは今後差し替え）",50,610,10);let f=Buffer.from(await n.save());return new s.Z(f,{status:200,headers:{"Content-Type":"application/pdf","Content-Disposition":'inline; filename="document.pdf"'}})}catch(e){return console.error("pdf generation error",e),s.Z.json({message:"failed"},{status:500})}}let u=new o.AppRouteRouteModule({definition:{kind:n.x.APP_ROUTE,page:"/api/billing/pdf/route",pathname:"/api/billing/pdf",filename:"route",bundlePath:"app/api/billing/pdf/route"},resolvedPagePath:"/Users/sayuri/caddonworks/src/app/api/billing/pdf/route.ts",nextConfigOutput:"",userland:r}),{requestAsyncStorage:c,staticGenerationAsyncStorage:p,serverHooks:f,headerHooks:g,staticGenerationBailout:h}=u,m="/api/billing/pdf/route";function w(){return(0,i.patchFetch)({serverHooks:f,staticGenerationAsyncStorage:p})}}};var t=require("../../../../webpack-runtime.js");t.C(e);var a=e=>t(t.s=e),r=t.X(0,[1638,6206,5564],()=>a(25291));module.exports=r})();