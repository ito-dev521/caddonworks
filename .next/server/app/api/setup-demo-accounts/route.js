"use strict";(()=>{var e={};e.id=5096,e.ids=[5096],e.modules={30517:e=>{e.exports=require("next/dist/compiled/next-server/app-route.runtime.prod.js")},13685:e=>{e.exports=require("http")},95687:e=>{e.exports=require("https")},85477:e=>{e.exports=require("punycode")},12781:e=>{e.exports=require("stream")},57310:e=>{e.exports=require("url")},59796:e=>{e.exports=require("zlib")},42171:(e,a,s)=>{s.r(a),s.d(a,{headerHooks:()=>g,originalPathname:()=>f,patchFetch:()=>I,requestAsyncStorage:()=>u,routeModule:()=>c,serverHooks:()=>p,staticGenerationAsyncStorage:()=>d,staticGenerationBailout:()=>h});var i={};s.r(i),s.d(i,{POST:()=>l});var r=s(95419),t=s(69108),o=s(99678),m=s(78070),n=s(6517);async function l(e){try{let e=(0,n.ST)(),a=[];for(let s of[{email:"admin@demo.com",password:"demo123",displayName:"運営者デモ",role:"Admin",organizationName:"システム運営"},{email:"orgadmin@demo.com",password:"demo123",displayName:"発注者デモ",role:"OrgAdmin",organizationName:"デモ建設株式会社"},{email:"orgadmin2@demo.com",password:"demo123",displayName:"発注者デモ2",role:"OrgAdmin",organizationName:"デモ建設株式会社2"},{email:"contractor@demo.com",password:"demo123",displayName:"受注者デモ",role:"Contractor",specialties:["道路設計","橋梁設計"],qualifications:["技術士（建設部門）","一級建築士"]},{email:"contractor2@demo.com",password:"demo123",displayName:"受注者デモ2",role:"Contractor",specialties:["構造設計","設備設計"],qualifications:["技術士（機械部門）","一級建築士"]},{email:"reviewer@demo.com",password:"demo123",displayName:"監督員デモ",role:"Reviewer",organizationName:"デモ建設株式会社"}])try{let{data:i}=await e.from("users").select("id").eq("email",s.email).single();if(i){a.push({email:s.email,status:"already_exists",message:"既に存在します"});continue}let{data:r,error:t}=await e.auth.admin.createUser({email:s.email,password:s.password,email_confirm:!0,user_metadata:{display_name:s.displayName,role:s.role}});if(t){a.push({email:s.email,status:"auth_error",message:t.message});continue}if(!r.user){a.push({email:s.email,status:"auth_error",message:"ユーザー作成に失敗しました"});continue}let{data:o,error:m}=await e.from("users").insert({auth_user_id:r.user.id,email:s.email,display_name:s.displayName,specialties:s.specialties||[],qualifications:s.qualifications||[]}).select().single();if(m){a.push({email:s.email,status:"profile_error",message:m.message});continue}let n=null;if(s.organizationName){let{data:i}=await e.from("organizations").select("id").eq("name",s.organizationName).single();if(i)n=i.id;else{let{data:i,error:r}=await e.from("organizations").insert({name:s.organizationName,description:"デモ用の組織です",billing_email:s.email,system_fee:5e4,active:!0}).select().single();if(r){a.push({email:s.email,status:"org_error",message:r.message});continue}n=i.id}}let l={user_id:o.id,role:s.role};if(n)l.org_id=n;else if("Contractor"===s.role){let{data:i}=await e.from("organizations").select("id").eq("name","デフォルト組織").single();if(i)l.org_id=i.id;else{let{data:i,error:r}=await e.from("organizations").insert({name:"デフォルト組織",description:"受注者用のデフォルト組織",billing_email:"default@example.com",system_fee:0,active:!0}).select().single();if(r){a.push({email:s.email,status:"org_error",message:r.message});continue}l.org_id=i.id}}let{error:c}=await e.from("memberships").insert(l);if(c){a.push({email:s.email,status:"membership_error",message:c.message});continue}a.push({email:s.email,status:"success",message:"デモアカウントを作成しました"})}catch(e){a.push({email:s.email,status:"error",message:"予期しないエラーが発生しました"})}return m.Z.json({message:"デモアカウントのセットアップが完了しました",results:a},{status:200})}catch(e){return console.error("Demo accounts setup error:",e),m.Z.json({message:"サーバーエラーが発生しました"},{status:500})}}let c=new r.AppRouteRouteModule({definition:{kind:t.x.APP_ROUTE,page:"/api/setup-demo-accounts/route",pathname:"/api/setup-demo-accounts",filename:"route",bundlePath:"app/api/setup-demo-accounts/route"},resolvedPagePath:"/Users/sayuri/caddonworks/src/app/api/setup-demo-accounts/route.ts",nextConfigOutput:"",userland:i}),{requestAsyncStorage:u,staticGenerationAsyncStorage:d,serverHooks:p,headerHooks:g,staticGenerationBailout:h}=c,f="/api/setup-demo-accounts/route";function I(){return(0,o.patchFetch)({serverHooks:p,staticGenerationAsyncStorage:d})}},6517:(e,a,s)=>{s.d(a,{OQ:()=>r,ST:()=>t});var i=s(32409);let r=(0,i.eI)("https://rxnozwuamddqlcwysxag.supabase.co","eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6InJ4bm96d3VhbWRkcWxjd3lzeGFnIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NTc3NjY4MDMsImV4cCI6MjA3MzM0MjgwM30.0sbl6zWJ1XalGTFbsgeMpth6yH-oQA_P1eTCc8lKoAU"),t=()=>{let e=process.env.SUPABASE_SERVICE_ROLE_KEY||"eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6InJ4bm96d3VhbWRkcWxjd3lzeGFnIiwicm9sZSI6InNlcnZpY2Vfcm9sZSIsImlhdCI6MTc1Nzc2NjgwMywiZXhwIjoyMDczMzQyODAzfQ.w7KcFrtcTRhqoHwTSlgTc6NDNHIJH985rAgT9bD0ipE";return(0,i.eI)("https://rxnozwuamddqlcwysxag.supabase.co",e,{auth:{autoRefreshToken:!1,persistSession:!1}})}}};var a=require("../../../webpack-runtime.js");a.C(e);var s=e=>a(a.s=e),i=a.X(0,[1638,6206,2409],()=>s(42171));module.exports=i})();