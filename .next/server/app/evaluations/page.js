(()=>{var e={};e.id=5014,e.ids=[5014],e.modules={47849:e=>{"use strict";e.exports=require("next/dist/client/components/action-async-storage.external")},72934:e=>{"use strict";e.exports=require("next/dist/client/components/action-async-storage.external.js")},55403:e=>{"use strict";e.exports=require("next/dist/client/components/request-async-storage.external")},54580:e=>{"use strict";e.exports=require("next/dist/client/components/request-async-storage.external.js")},94749:e=>{"use strict";e.exports=require("next/dist/client/components/static-generation-async-storage.external")},45869:e=>{"use strict";e.exports=require("next/dist/client/components/static-generation-async-storage.external.js")},20399:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},13685:e=>{"use strict";e.exports=require("http")},95687:e=>{"use strict";e.exports=require("https")},85477:e=>{"use strict";e.exports=require("punycode")},12781:e=>{"use strict";e.exports=require("stream")},57310:e=>{"use strict";e.exports=require("url")},59796:e=>{"use strict";e.exports=require("zlib")},43198:(e,s,t)=>{"use strict";t.r(s),t.d(s,{GlobalError:()=>i.ZP,__next_app__:()=>x,originalPathname:()=>o,pages:()=>d,routeModule:()=>m,tree:()=>c});var r=t(50482),a=t(69108),i=t(83543),n=t(68300),l={};for(let e in n)0>["default","tree","pages","GlobalError","originalPathname","__next_app__","routeModule"].indexOf(e)&&(l[e]=()=>n[e]);t.d(s,l);let c=["",{children:["evaluations",{children:["__PAGE__",{},{page:[()=>Promise.resolve().then(t.bind(t,6079)),"/Users/sayuri/caddonworks/src/app/evaluations/page.tsx"]}]},{}]},{layout:[()=>Promise.resolve().then(t.bind(t,61623)),"/Users/sayuri/caddonworks/src/app/layout.tsx"],error:[()=>Promise.resolve().then(t.bind(t,24117)),"/Users/sayuri/caddonworks/src/app/error.tsx"],"not-found":[()=>Promise.resolve().then(t.bind(t,48206)),"/Users/sayuri/caddonworks/src/app/not-found.tsx"]}],d=["/Users/sayuri/caddonworks/src/app/evaluations/page.tsx"],o="/evaluations/page",x={require:t,loadChunk:()=>Promise.resolve()},m=new r.AppPageRouteModule({definition:{kind:a.x.APP_PAGE,page:"/evaluations/page",pathname:"/evaluations",bundlePath:"",filename:"",appPaths:[]},userland:{loaderTree:c}})},31811:(e,s,t)=>{Promise.resolve().then(t.bind(t,41811))},55794:(e,s,t)=>{"use strict";t.d(s,{Z:()=>r});/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let r=(0,t(69224).Z)("Calendar",[["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",ry:"2",key:"eu3xkr"}],["line",{x1:"16",x2:"16",y1:"2",y2:"6",key:"m3sa8f"}],["line",{x1:"8",x2:"8",y1:"2",y2:"6",key:"18kwsl"}],["line",{x1:"3",x2:"21",y1:"10",y2:"10",key:"xt86sb"}]])},42739:(e,s,t)=>{"use strict";t.d(s,{Z:()=>r});/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let r=(0,t(69224).Z)("Loader2",[["path",{d:"M21 12a9 9 0 1 1-6.219-8.56",key:"13zald"}]])},38852:(e,s,t)=>{"use strict";t.d(s,{Z:()=>r});/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let r=(0,t(69224).Z)("MessageSquare",[["path",{d:"M21 15a2 2 0 0 1-2 2H7l-4 4V5a2 2 0 0 1 2-2h14a2 2 0 0 1 2 2z",key:"1lielz"}]])},41811:(e,s,t)=>{"use strict";t.r(s),t.d(s,{default:()=>g});var r=t(95344),a=t(3729),i=t(57916),n=t(76755),l=t(55794),c=t(38852),d=t(23673),o=t(19591),x=t(76586),m=t(83655),u=t(43750),h=t(18704);function g(){return r.jsx(x.AuthGuard,{allowedRoles:["Contractor"],children:r.jsx(p,{})})}function p(){let{userProfile:e,userRole:s}=(0,u.useAuth)(),[t,x]=(0,a.useState)([]),[g,p]=(0,a.useState)(!0),[j,y]=(0,a.useState)(null),b=async()=>{if(e&&"Contractor"===s)try{p(!0);let{data:{session:s}}=await h.OQ.auth.getSession();if(!s)return;let t=await fetch(`/api/evaluations/contractor?contractor_id=${e.id}`,{headers:{Authorization:`Bearer ${s.access_token}`}});if(t.ok){let e=await t.json();x(e.evaluations||[])}else y("評価データの取得に失敗しました")}catch(e){console.error("評価取得エラー:",e),y("ネットワークエラーが発生しました")}finally{p(!1)}};(0,a.useEffect)(()=>{b()},[e,s]);let v=({score:e})=>(0,r.jsxs)("div",{className:"flex items-center gap-1",children:[[1,2,3,4,5].map(s=>r.jsx(n.Z,{className:`w-4 h-4 ${s<=e?"text-yellow-400 fill-yellow-400":"text-gray-300"}`},s)),r.jsx("span",{className:"ml-2 text-sm text-gray-600",children:e.toFixed(1)})]}),f=e=>e>=4.5?{label:"優秀",color:"bg-green-100 text-green-800"}:e>=3.5?{label:"良好",color:"bg-blue-100 text-blue-800"}:e>=2.5?{label:"普通",color:"bg-yellow-100 text-yellow-800"}:e>=1.5?{label:"要改善",color:"bg-orange-100 text-orange-800"}:{label:"不十分",color:"bg-red-100 text-red-800"};return g?(0,r.jsxs)("div",{className:"min-h-screen bg-gradient-mesh",children:[r.jsx(m.W,{}),r.jsx("div",{className:"md:ml-64 transition-all duration-300",children:r.jsx("div",{className:"flex items-center justify-center min-h-screen",children:(0,r.jsxs)("div",{className:"text-center",children:[r.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-engineering-blue mx-auto mb-4"}),r.jsx("p",{className:"text-gray-600",children:"評価データを読み込み中..."})]})})})]}):j?(0,r.jsxs)("div",{className:"min-h-screen bg-gradient-mesh",children:[r.jsx(m.W,{}),r.jsx("div",{className:"md:ml-64 transition-all duration-300",children:r.jsx("div",{className:"flex items-center justify-center min-h-screen",children:(0,r.jsxs)("div",{className:"text-center",children:[r.jsx("div",{className:"text-red-500 text-xl mb-4",children:"⚠️"}),r.jsx("p",{className:"text-gray-600",children:j}),r.jsx("button",{onClick:b,className:"mt-4 px-4 py-2 bg-engineering-blue text-white rounded-lg hover:bg-blue-700",children:"再試行"})]})})})]}):(0,r.jsxs)("div",{className:"min-h-screen bg-gradient-mesh",children:[r.jsx(m.W,{}),(0,r.jsxs)("div",{className:"md:ml-64 transition-all duration-300",children:[r.jsx(i.E.header,{initial:{opacity:0,y:-20},animate:{opacity:1,y:0},className:"bg-white/80 backdrop-blur-sm border-b border-gray-200 sticky top-0 z-30",children:r.jsx("div",{className:"px-6 py-4",children:(0,r.jsxs)("div",{className:"flex items-center justify-between",children:[(0,r.jsxs)("div",{children:[(0,r.jsxs)("h1",{className:"text-2xl font-bold text-gray-900 flex items-center gap-2",children:[r.jsx(n.Z,{className:"w-6 h-6 text-yellow-500"}),"受注者評価"]}),r.jsx("p",{className:"text-gray-600",children:"発注者からの評価とコメントを確認できます"})]}),(0,r.jsxs)(o.C,{variant:"engineering",children:[t.length,"件の評価"]})]})})}),r.jsx("main",{className:"px-6 py-8",children:0===t.length?(0,r.jsxs)(i.E.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},className:"text-center py-12",children:[r.jsx(n.Z,{className:"w-16 h-16 text-gray-300 mx-auto mb-4"}),r.jsx("h2",{className:"text-xl font-semibold text-gray-900 mb-2",children:"まだ評価がありません"}),r.jsx("p",{className:"text-gray-600",children:"案件完了後に発注者からの評価が表示されます"})]}):r.jsx("div",{className:"space-y-6",children:t.map((e,s)=>{let t=f(e.average_score);return r.jsx(i.E.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.1*s},children:(0,r.jsxs)(d.Zb,{className:"hover:shadow-lg transition-shadow",children:[r.jsx(d.Ol,{children:(0,r.jsxs)("div",{className:"flex items-start justify-between",children:[(0,r.jsxs)("div",{children:[r.jsx(d.ll,{className:"text-lg font-semibold text-gray-900 mb-2",children:e.projects.title}),r.jsx("div",{className:"flex items-center gap-4 text-sm text-gray-600",children:(0,r.jsxs)("div",{className:"flex items-center gap-1",children:[r.jsx(l.Z,{className:"w-4 h-4"}),new Date(e.created_at).toLocaleDateString("ja-JP")]})})]}),(0,r.jsxs)("div",{className:"text-right",children:[r.jsx("div",{className:"flex items-center gap-2 mb-2",children:r.jsx(v,{score:e.average_score})}),r.jsx(o.C,{className:t.color,children:t.label})]})]})}),r.jsx(d.aY,{children:(0,r.jsxs)("div",{className:"space-y-4",children:[(0,r.jsxs)("div",{className:"grid grid-cols-2 md:grid-cols-5 gap-4",children:[(0,r.jsxs)("div",{className:"text-center p-3 bg-gray-50 rounded-lg",children:[r.jsx("div",{className:"text-sm text-gray-600 mb-1",children:"納期"}),r.jsx(v,{score:e.deadline_score})]}),(0,r.jsxs)("div",{className:"text-center p-3 bg-gray-50 rounded-lg",children:[r.jsx("div",{className:"text-sm text-gray-600 mb-1",children:"成果品の質"}),r.jsx(v,{score:e.quality_score})]}),(0,r.jsxs)("div",{className:"text-center p-3 bg-gray-50 rounded-lg",children:[r.jsx("div",{className:"text-sm text-gray-600 mb-1",children:"コミュニケーション"}),r.jsx(v,{score:e.communication_score})]}),(0,r.jsxs)("div",{className:"text-center p-3 bg-gray-50 rounded-lg",children:[r.jsx("div",{className:"text-sm text-gray-600 mb-1",children:"理解度"}),r.jsx(v,{score:e.understanding_score})]}),(0,r.jsxs)("div",{className:"text-center p-3 bg-gray-50 rounded-lg",children:[r.jsx("div",{className:"text-sm text-gray-600 mb-1",children:"プロフェッショナリズム"}),r.jsx(v,{score:e.professionalism_score})]})]}),e.comment&&(0,r.jsxs)("div",{className:"border-t pt-4",children:[(0,r.jsxs)("div",{className:"flex items-center gap-2 mb-2",children:[r.jsx(c.Z,{className:"w-4 h-4 text-gray-600"}),r.jsx("span",{className:"text-sm font-medium text-gray-700",children:"コメント"})]}),r.jsx("div",{className:"bg-blue-50 p-4 rounded-lg",children:(0,r.jsxs)("p",{className:"text-gray-700 italic",children:['"',e.comment,'"']})})]})]})})]})},e.id)})})})]})]})}},76586:(e,s,t)=>{"use strict";t.r(s),t.d(s,{AuthGuard:()=>d,useRoleAccess:()=>x,withAuth:()=>o});var r=t(95344),a=t(3729),i=t(22254),n=t(57916),l=t(42739),c=t(43750);function d({children:e,requiredRole:s,allowedRoles:t,redirectTo:d="/auth/login"}){let{user:o,userRole:x,loading:m}=(0,c.useAuth)(),u=(0,i.useRouter)(),h=(0,i.usePathname)(),g=(0,a.useRef)(!1);return((0,a.useEffect)(()=>{if(!m&&!g.current){if(!o){sessionStorage.setItem("redirectAfterLogin",h),h!==d&&(g.current=!0,u.push(d));return}if(s&&x!==s||t&&t.length>0&&(!x||!t.includes(x))){"/unauthorized"!==h&&(g.current=!0,u.push("/unauthorized"));return}}},[o,x,m,s,t,u,d,h]),m)?r.jsx("div",{className:"min-h-screen bg-gradient-mesh flex items-center justify-center",children:(0,r.jsxs)(n.E.div,{initial:{opacity:0,scale:.9},animate:{opacity:1,scale:1},className:"text-center",children:[r.jsx("div",{className:"w-16 h-16 bg-engineering-blue rounded-xl flex items-center justify-center mx-auto mb-4",children:r.jsx(l.Z,{className:"w-8 h-8 text-white animate-spin"})}),r.jsx("h2",{className:"text-xl font-semibold text-gray-900 mb-2",children:"認証確認中..."}),r.jsx("p",{className:"text-gray-600",children:"しばらくお待ちください"})]})}):!o||s&&x!==s||t&&t.length>0&&(!x||!t.includes(x))?null:r.jsx(r.Fragment,{children:e})}function o(e,s){return function(t){return r.jsx(d,{requiredRole:s,children:r.jsx(e,{...t})})}}function x(){let{userRole:e}=(0,c.useAuth)(),s=s=>e===s,t=s=>!!e&&s.includes(e);return{hasRole:s,hasAnyRole:t,isAdmin:()=>s("OrgAdmin"),isStaff:()=>s("Staff"),isContractor:()=>s("Contractor"),isReviewer:()=>s("Reviewer"),isAuditor:()=>s("Auditor"),canManageProjects:()=>t(["OrgAdmin","Staff"]),canViewFinancials:()=>t(["OrgAdmin","Staff","Auditor"]),canReviewProjects:()=>t(["Reviewer","OrgAdmin"]),canViewAuditLogs:()=>t(["Auditor","OrgAdmin"])}}},6079:(e,s,t)=>{"use strict";t.r(s),t.d(s,{$$typeof:()=>i,__esModule:()=>a,default:()=>n});let r=(0,t(86843).createProxy)(String.raw`/Users/sayuri/caddonworks/src/app/evaluations/page.tsx`),{__esModule:a,$$typeof:i}=r,n=r.default}};var s=require("../../webpack-runtime.js");s.C(e);var t=e=>s(s.s=e),r=s.X(0,[1638,4679,3035,7962,5414,5188,1682],()=>t(43198));module.exports=r})();