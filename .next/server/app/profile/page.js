(()=>{var e={};e.id=4178,e.ids=[4178],e.modules={47849:e=>{"use strict";e.exports=require("next/dist/client/components/action-async-storage.external")},72934:e=>{"use strict";e.exports=require("next/dist/client/components/action-async-storage.external.js")},55403:e=>{"use strict";e.exports=require("next/dist/client/components/request-async-storage.external")},54580:e=>{"use strict";e.exports=require("next/dist/client/components/request-async-storage.external.js")},94749:e=>{"use strict";e.exports=require("next/dist/client/components/static-generation-async-storage.external")},45869:e=>{"use strict";e.exports=require("next/dist/client/components/static-generation-async-storage.external.js")},20399:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},13685:e=>{"use strict";e.exports=require("http")},95687:e=>{"use strict";e.exports=require("https")},85477:e=>{"use strict";e.exports=require("punycode")},12781:e=>{"use strict";e.exports=require("stream")},57310:e=>{"use strict";e.exports=require("url")},59796:e=>{"use strict";e.exports=require("zlib")},10251:(e,r,s)=>{"use strict";s.r(r),s.d(r,{GlobalError:()=>i.ZP,__next_app__:()=>m,originalPathname:()=>d,pages:()=>o,routeModule:()=>u,tree:()=>c});var a=s(50482),t=s(69108),i=s(83543),n=s(68300),l={};for(let e in n)0>["default","tree","pages","GlobalError","originalPathname","__next_app__","routeModule"].indexOf(e)&&(l[e]=()=>n[e]);s.d(r,l);let c=["",{children:["profile",{children:["__PAGE__",{},{page:[()=>Promise.resolve().then(s.bind(s,65648)),"/Users/sayuri/caddonworks/src/app/profile/page.tsx"]}]},{}]},{layout:[()=>Promise.resolve().then(s.bind(s,61623)),"/Users/sayuri/caddonworks/src/app/layout.tsx"],error:[()=>Promise.resolve().then(s.bind(s,24117)),"/Users/sayuri/caddonworks/src/app/error.tsx"],"not-found":[()=>Promise.resolve().then(s.bind(s,48206)),"/Users/sayuri/caddonworks/src/app/not-found.tsx"]}],o=["/Users/sayuri/caddonworks/src/app/profile/page.tsx"],d="/profile/page",m={require:s,loadChunk:()=>Promise.resolve()},u=new a.AppPageRouteModule({definition:{kind:t.x.APP_PAGE,page:"/profile/page",pathname:"/profile",bundlePath:"",filename:"",appPaths:[]},userland:{loaderTree:c}})},19865:(e,r,s)=>{Promise.resolve().then(s.bind(s,29060))},65187:(e,r,s)=>{"use strict";s.d(r,{Z:()=>a});/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let a=(0,s(69224).Z)("Award",[["circle",{cx:"12",cy:"8",r:"6",key:"1vp47v"}],["path",{d:"M15.477 12.89 17 22l-5-3-5 3 1.523-9.11",key:"em7aur"}]])},78638:(e,r,s)=>{"use strict";s.d(r,{Z:()=>a});/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let a=(0,s(69224).Z)("Building",[["rect",{width:"16",height:"20",x:"4",y:"2",rx:"2",ry:"2",key:"76otgf"}],["path",{d:"M9 22v-4h6v4",key:"r93iot"}],["path",{d:"M8 6h.01",key:"1dz90k"}],["path",{d:"M16 6h.01",key:"1x0f13"}],["path",{d:"M12 6h.01",key:"1vi96p"}],["path",{d:"M12 10h.01",key:"1nrarc"}],["path",{d:"M12 14h.01",key:"1etili"}],["path",{d:"M16 10h.01",key:"1m94wz"}],["path",{d:"M16 14h.01",key:"1gbofw"}],["path",{d:"M8 10h.01",key:"19clt8"}],["path",{d:"M8 14h.01",key:"6423bh"}]])},42739:(e,r,s)=>{"use strict";s.d(r,{Z:()=>a});/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let a=(0,s(69224).Z)("Loader2",[["path",{d:"M21 12a9 9 0 1 1-6.219-8.56",key:"13zald"}]])},75695:(e,r,s)=>{"use strict";s.d(r,{Z:()=>a});/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let a=(0,s(69224).Z)("PenSquare",[["path",{d:"M11 4H4a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7",key:"1qinfi"}],["path",{d:"M18.5 2.5a2.12 2.12 0 0 1 3 3L12 15l-4 1 1-4Z",key:"w2jsv5"}]])},40626:(e,r,s)=>{"use strict";s.d(r,{Z:()=>a});/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let a=(0,s(69224).Z)("Phone",[["path",{d:"M22 16.92v3a2 2 0 0 1-2.18 2 19.79 19.79 0 0 1-8.63-3.07 19.5 19.5 0 0 1-6-6 19.79 19.79 0 0 1-3.07-8.67A2 2 0 0 1 4.11 2h3a2 2 0 0 1 2 1.72 12.84 12.84 0 0 0 .7 2.81 2 2 0 0 1-.45 2.11L8.09 9.91a16 16 0 0 0 6 6l1.27-1.27a2 2 0 0 1 2.11-.45 12.84 12.84 0 0 0 2.81.7A2 2 0 0 1 22 16.92z",key:"foiqr5"}]])},51838:(e,r,s)=>{"use strict";s.d(r,{Z:()=>a});/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let a=(0,s(69224).Z)("Plus",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]])},31498:(e,r,s)=>{"use strict";s.d(r,{Z:()=>a});/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let a=(0,s(69224).Z)("Save",[["path",{d:"M19 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h11l5 5v11a2 2 0 0 1-2 2z",key:"1owoqh"}],["polyline",{points:"17 21 17 13 7 13 7 21",key:"1md35c"}],["polyline",{points:"7 3 7 8 15 8",key:"8nz8an"}]])},76755:(e,r,s)=>{"use strict";s.d(r,{Z:()=>a});/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let a=(0,s(69224).Z)("Star",[["polygon",{points:"12 2 15.09 8.26 22 9.27 17 14.14 18.18 21.02 12 17.77 5.82 21.02 7 14.14 2 9.27 8.91 8.26 12 2",key:"8f66p6"}]])},29060:(e,r,s)=>{"use strict";s.r(r),s.d(r,{default:()=>Z});var a=s(95344),t=s(3729),i=s(57916),n=s(18822),l=s(75695),c=s(14513),o=s(31498);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let d=(0,s(69224).Z)("Camera",[["path",{d:"M14.5 4h-5L7 7H4a2 2 0 0 0-2 2v9a2 2 0 0 0 2 2h16a2 2 0 0 0 2-2V9a2 2 0 0 0-2-2h-3l-2.5-3z",key:"1tc9qg"}],["circle",{cx:"12",cy:"13",r:"3",key:"1vg3eu"}]]);var m=s(65187),u=s(51838),x=s(78638),p=s(76755),g=s(76586),h=s(59659),b=s(5094),y=s(23673),f=s(19591),j=s(26298),v=s(43750),N=s(18704),_=s(91684),w=s(40626);function k(){let{userProfile:e,userRole:r}=(0,v.useAuth)(),[s,n]=(0,t.useState)(null),[d,m]=(0,t.useState)(!1),[u,p]=(0,t.useState)(!0),[g,h]=(0,t.useState)(!1),[f,j]=(0,t.useState)({id:"",name:"",description:"",address:"",phone:"",email:"",website:"",employee_count:0,business_type:"",registration_number:"",contact_person:"",created_at:"",updated_at:""}),_=async()=>{try{p(!0);let{data:{session:e}}=await N.OQ.auth.getSession();if(!e)throw Error("セッションが見つかりません");let r=await fetch("/api/organization/profile",{headers:{Authorization:`Bearer ${e.access_token}`,"Content-Type":"application/json"}});if(!r.ok)throw Error("組織情報の取得に失敗しました");let s=await r.json();n(s.organization),j(s.organization)}catch(e){console.error("組織情報取得エラー:",e),alert("組織情報の取得に失敗しました")}finally{p(!1)}},k=async()=>{try{h(!0);let{data:{session:e}}=await N.OQ.auth.getSession();if(!e)throw Error("セッションが見つかりません");let r=await fetch("/api/organization/profile",{method:"PUT",headers:{Authorization:`Bearer ${e.access_token}`,"Content-Type":"application/json"},body:JSON.stringify({organizationData:f})});if(!r.ok)throw Error("組織情報の更新に失敗しました");let s=await r.json();n(s.organization),m(!1),alert("組織情報が正常に更新されました")}catch(e){console.error("組織情報保存エラー:",e),alert("組織情報の更新に失敗しました")}finally{h(!1)}};return((0,t.useEffect)(()=>{_()},[]),u)?(0,a.jsxs)("div",{className:"text-center py-8",children:[a.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-engineering-blue mx-auto"}),a.jsx("p",{className:"mt-4 text-gray-600",children:"読み込み中..."})]}):(0,a.jsxs)("div",{className:"space-y-6",children:[a.jsx(i.E.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.5},children:(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsxs)("div",{children:[a.jsx("h1",{className:"text-3xl font-bold text-gray-900",children:"法人プロフィール"}),a.jsx("p",{className:"text-gray-600 mt-2",children:"組織の基本情報を管理します"})]}),a.jsx("div",{className:"flex gap-3",children:d?(0,a.jsxs)(a.Fragment,{children:[(0,a.jsxs)(b.z,{onClick:k,disabled:g,className:"bg-engineering-blue hover:bg-engineering-blue/90",children:[a.jsx(o.Z,{className:"w-4 h-4 mr-2"}),g?"保存中...":"保存"]}),(0,a.jsxs)(b.z,{variant:"outline",onClick:()=>{j(s||f),m(!1)},disabled:g,children:[a.jsx(c.Z,{className:"w-4 h-4 mr-2"}),"キャンセル"]})]}):(0,a.jsxs)(b.z,{onClick:()=>m(!0),className:"bg-engineering-blue hover:bg-engineering-blue/90",children:[a.jsx(l.Z,{className:"w-4 h-4 mr-2"}),"編集"]})})]})}),a.jsx(i.E.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.1},children:(0,a.jsxs)(y.Zb,{className:"hover-lift",children:[(0,a.jsxs)(y.Ol,{children:[(0,a.jsxs)(y.ll,{className:"flex items-center gap-2",children:[a.jsx(x.Z,{className:"w-5 h-5"}),"基本情報"]}),a.jsx(y.SZ,{children:"法人の基本情報を入力してください"})]}),(0,a.jsxs)(y.aY,{className:"space-y-4",children:[(0,a.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,a.jsxs)("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"法人名 *"}),d?a.jsx("input",{type:"text",value:f.name,onChange:e=>j(r=>({...r,name:e.target.value})),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-engineering-blue focus:border-transparent",placeholder:"株式会社サンプル",required:!0}):a.jsx("p",{className:"text-gray-900",children:s?.name||"未設定"})]}),(0,a.jsxs)("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"事業種別"}),d?a.jsx("input",{type:"text",value:f.business_type,onChange:e=>j(r=>({...r,business_type:e.target.value})),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-engineering-blue focus:border-transparent",placeholder:"建設業"}):a.jsx("p",{className:"text-gray-900",children:s?.business_type||"未設定"})]})]}),(0,a.jsxs)("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"法人番号"}),d?a.jsx("input",{type:"text",value:f.registration_number,onChange:e=>j(r=>({...r,registration_number:e.target.value})),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-engineering-blue focus:border-transparent",placeholder:"1234567890123"}):a.jsx("p",{className:"text-gray-900",children:s?.registration_number||"未設定"})]}),(0,a.jsxs)("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"担当者名"}),d?a.jsx("input",{type:"text",value:f.contact_person,onChange:e=>j(r=>({...r,contact_person:e.target.value})),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-engineering-blue focus:border-transparent",placeholder:"管理者デモ"}):a.jsx("p",{className:"text-gray-900",children:s?.contact_person||"未設定"})]}),(0,a.jsxs)("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"従業員数"}),d?a.jsx("input",{type:"number",min:"0",value:f.employee_count,onChange:e=>j(r=>({...r,employee_count:Number(e.target.value)})),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-engineering-blue focus:border-transparent",placeholder:"50"}):a.jsx("p",{className:"text-gray-900",children:s?.employee_count?`${s.employee_count}名`:"未設定"})]}),(0,a.jsxs)("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"事業内容"}),d?a.jsx("textarea",{value:f.description,onChange:e=>j(r=>({...r,description:e.target.value})),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-engineering-blue focus:border-transparent",rows:3,placeholder:"土木設計、建設コンサルタント業務など"}):a.jsx("p",{className:"text-gray-900 whitespace-pre-wrap",children:s?.description||"未設定"})]})]})]})}),a.jsx(i.E.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.2},children:(0,a.jsxs)(y.Zb,{className:"hover-lift",children:[(0,a.jsxs)(y.Ol,{children:[(0,a.jsxs)(y.ll,{className:"flex items-center gap-2",children:[a.jsx(w.Z,{className:"w-5 h-5"}),"連絡先情報"]}),a.jsx(y.SZ,{children:"法人の連絡先情報を入力してください"})]}),(0,a.jsxs)(y.aY,{className:"space-y-4",children:[(0,a.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,a.jsxs)("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"電話番号"}),d?a.jsx("input",{type:"tel",value:f.phone,onChange:e=>j(r=>({...r,phone:e.target.value})),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-engineering-blue focus:border-transparent",placeholder:"03-1234-5678"}):a.jsx("p",{className:"text-gray-900",children:s?.phone||"未設定"})]}),(0,a.jsxs)("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"メールアドレス"}),d?a.jsx("input",{type:"email",value:f.email,onChange:e=>j(r=>({...r,email:e.target.value})),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-engineering-blue focus:border-transparent",placeholder:"info@company.com"}):a.jsx("p",{className:"text-gray-900",children:s?.email||"未設定"})]})]}),(0,a.jsxs)("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"住所"}),d?a.jsx("input",{type:"text",value:f.address,onChange:e=>j(r=>({...r,address:e.target.value})),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-engineering-blue focus:border-transparent",placeholder:"東京都渋谷区..."}):a.jsx("p",{className:"text-gray-900",children:s?.address||"未設定"})]}),(0,a.jsxs)("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"ウェブサイト"}),d?a.jsx("input",{type:"url",value:f.website,onChange:e=>j(r=>({...r,website:e.target.value})),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-engineering-blue focus:border-transparent",placeholder:"https://www.company.com"}):a.jsx("p",{className:"text-gray-900",children:s?.website?a.jsx("a",{href:s.website,target:"_blank",rel:"noopener noreferrer",className:"text-engineering-blue hover:underline",children:s.website}):"未設定"})]})]})]})})]})}function Z(){return a.jsx(g.AuthGuard,{children:a.jsx(C,{})})}function C(){let{user:e,userProfile:r,userRole:s,updateProfile:g}=(0,v.useAuth)(),[w,Z]=(0,t.useState)(!1),[C,q]=(0,t.useState)(!1),[A,P]=(0,t.useState)(!1),[z,M]=(0,t.useState)({display_name:r?.display_name||"",specialties:r?.specialties||[],qualifications:r?.qualifications||[],experience_years:r?.experience_years||"",phone:"",location:"",bio:"",linkedin:"",github:"",formal_name:r?.formal_name||"",postal_code:r?.postal_code||"",address:r?.address||"",address_detail:r?.address_detail||"",phone_number:r?.phone_number||"",company_number:r?.company_number||"",registration_number:r?.registration_number||""}),S=async()=>{if(!z.formal_name.trim()){alert("氏名を入力してください");return}if(!z.phone_number.trim()){alert("電話番号を入力してください");return}if(!z.address.trim()){alert("住所を入力してください");return}if(z.specialties.some(e=>"未経験"!==e)&&!z.experience_years.trim()){alert("未経験以外の専門分野を選択した場合は経験年数を入力してください");return}q(!0);try{console.log("プロフィール更新開始:",{display_name:z.display_name,formal_name:z.formal_name,postal_code:z.postal_code,address:z.address,address_detail:z.address_detail,phone_number:z.phone_number,company_number:z.company_number,registration_number:z.registration_number}),await g({display_name:z.display_name,specialties:z.specialties,qualifications:z.qualifications,experience_years:z.experience_years||void 0,formal_name:z.formal_name||void 0,postal_code:z.postal_code||void 0,address:z.address||void 0,address_detail:z.address_detail||void 0,phone_number:z.phone_number||void 0,company_number:z.company_number||void 0,registration_number:z.registration_number||void 0}),console.log("プロフィール更新成功"),Z(!1),alert("プロフィールが正常に更新されました")}catch(e){console.error("Error updating profile:",e),alert("プロフィールの更新に失敗しました: "+(e instanceof Error?e.message:"不明なエラー"))}finally{q(!1)}},E=async e=>{if(7===e.length)try{let r=await fetch(`https://zipcloud.ibsnet.co.jp/api/search?zipcode=${e}`),s=await r.json();if(200===s.status&&s.results&&s.results.length>0){let e=s.results[0],r=`${e.address1}${e.address2}${e.address3}`;M(e=>({...e,address:r}))}else console.log("住所が見つかりませんでした")}catch(e){console.error("住所取得エラー:",e)}},$=e=>{let r=e.replace(/[^0-9]/g,"");M(e=>({...e,postal_code:r})),7===r.length&&E(r)},O=e=>{z.specialties.includes(e)||M(r=>({...r,specialties:[...r.specialties,e]}))},R=e=>{M(r=>({...r,specialties:r.specialties.filter(r=>r!==e)}))},T=e=>{z.qualifications.includes(e)||M(r=>({...r,qualifications:[...r.qualifications,e]}))},L=e=>{M(r=>({...r,qualifications:r.qualifications.filter(r=>r!==e)}))},U=async r=>{if(e&&r)try{P(!0);let{data:{session:e}}=await N.OQ.auth.getSession();if(!e){console.error("セッションが見つかりません");return}let s=new FormData;s.append("avatar",r),console.log("アバターアップロード開始:",{fileName:r.name,fileSize:r.size,fileType:r.type});let a=await fetch("/api/profile/avatar",{method:"POST",headers:{Authorization:`Bearer ${e.access_token}`},body:s}),t=await a.json();a.ok?(console.log("アバターアップロード成功:",t),window.location.reload()):(console.error("アバターアップロードエラー:",t.message),alert("アバターのアップロードに失敗しました: "+t.message))}catch(e){console.error("Error uploading avatar:",e),alert("アバターのアップロードに失敗しました: "+(e instanceof Error?e.message:"不明なエラー"))}finally{P(!1)}},Y=()=>{let e=[z.display_name,z.specialties.length>0,z.qualifications.length>0,z.experience_years,z.bio,z.location,z.formal_name,z.address,z.phone_number,z.company_number,z.registration_number];return Math.round(e.filter(Boolean).length/e.length*100)};return"OrgAdmin"===s?(0,a.jsxs)("div",{className:"min-h-screen bg-gray-50",children:[a.jsx(h.W,{}),a.jsx("div",{className:"container mx-auto px-4 py-8",children:a.jsx(k,{})})]}):(0,a.jsxs)("div",{className:"min-h-screen bg-gradient-mesh",children:[a.jsx(h.W,{}),(0,a.jsxs)("div",{className:"md:ml-64 transition-all duration-300",children:[a.jsx(i.E.header,{initial:{opacity:0,y:-20},animate:{opacity:1,y:0},className:"bg-white/80 backdrop-blur-sm border-b border-gray-200 sticky top-0 z-30",children:a.jsx("div",{className:"px-6 py-4",children:(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsxs)("div",{children:[(0,a.jsxs)("h1",{className:"text-2xl font-bold text-gray-900 flex items-center gap-2",children:[a.jsx(n.Z,{className:"w-6 h-6 text-engineering-blue"}),"プロフィール管理"]}),a.jsx("p",{className:"text-gray-600",children:"あなたの専門情報と設定を管理"})]}),(0,a.jsxs)("div",{className:"flex items-center gap-3",children:[(0,a.jsxs)(f.C,{variant:"engineering",children:["プロフィール完成度: ",Y(),"%"]}),w?(0,a.jsxs)("div",{className:"flex gap-2",children:[(0,a.jsxs)(b.z,{variant:"outline",onClick:()=>{M({display_name:r?.display_name||"",specialties:r?.specialties||[],qualifications:r?.qualifications||[],experience_years:r?.experience_years||"",phone:"",location:"",bio:"",linkedin:"",github:"",formal_name:r?.formal_name||"",postal_code:r?.postal_code||"",address:r?.address||"",address_detail:r?.address_detail||"",phone_number:r?.phone_number||"",company_number:r?.company_number||"",registration_number:r?.registration_number||""}),Z(!1)},children:[a.jsx(c.Z,{className:"w-4 h-4 mr-2"}),"キャンセル"]}),(0,a.jsxs)(b.z,{variant:"engineering",onClick:S,disabled:C,children:[a.jsx(o.Z,{className:"w-4 h-4 mr-2"}),"保存"]})]}):(0,a.jsxs)(b.z,{variant:"engineering",onClick:()=>Z(!0),children:[a.jsx(l.Z,{className:"w-4 h-4 mr-2"}),"編集"]})]})]})})}),a.jsx("main",{className:"px-6 py-8",children:(0,a.jsxs)("div",{className:"max-w-4xl mx-auto space-y-6",children:[a.jsx(i.E.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},children:a.jsx(y.Zb,{variant:"engineering",children:(0,a.jsxs)(y.aY,{className:"p-6",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between mb-4",children:[a.jsx("h3",{className:"text-lg font-semibold text-white",children:"プロフィール完成度"}),(0,a.jsxs)("span",{className:"text-2xl font-bold text-white",children:[Y(),"%"]})]}),a.jsx(j.E,{value:Y(),className:"mb-4"}),a.jsx("p",{className:"text-white/80 text-sm",children:"プロフィールを完成させると、より適切な案件のマッチングや評価を受けられます。"})]})})}),a.jsx(i.E.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.1},children:(0,a.jsxs)(y.Zb,{className:"hover-lift",children:[a.jsx(y.Ol,{children:(0,a.jsxs)(y.ll,{className:"flex items-center gap-2",children:[a.jsx(n.Z,{className:"w-5 h-5"}),"基本情報"]})}),a.jsx(y.aY,{className:"space-y-4",children:(0,a.jsxs)("div",{className:"flex items-center gap-6",children:[(0,a.jsxs)("div",{className:"relative",children:[r?.avatar_url?a.jsx("img",{src:r.avatar_url,alt:"プロフィール画像",className:"w-24 h-24 rounded-full object-cover border-2 border-gray-200"}):a.jsx("div",{className:"w-24 h-24 bg-engineering-blue rounded-full flex items-center justify-center text-white text-2xl font-bold",children:z.display_name.charAt(0)||"U"}),w&&(0,a.jsxs)("label",{className:"absolute -bottom-2 -right-2 w-8 h-8 bg-white border-2 border-gray-300 rounded-full flex items-center justify-center hover:bg-gray-50 cursor-pointer",children:[a.jsx(d,{className:"w-4 h-4 text-gray-600"}),a.jsx("input",{type:"file",accept:"image/*",onChange:e=>{let r=e.target.files?.[0];r&&U(r)},className:"hidden",disabled:A})]}),A&&a.jsx("div",{className:"absolute inset-0 bg-black/50 rounded-full flex items-center justify-center",children:a.jsx("div",{className:"animate-spin rounded-full h-6 w-6 border-b-2 border-white"})})]}),(0,a.jsxs)("div",{className:"flex-1",children:[(0,a.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,a.jsxs)("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"表示名"}),w?a.jsx("input",{type:"text",value:z.display_name,onChange:e=>M(r=>({...r,display_name:e.target.value})),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-engineering-blue focus:border-transparent"}):a.jsx("p",{className:"text-gray-900 font-medium",children:r?.display_name})]}),(0,a.jsxs)("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"メールアドレス"}),a.jsx("p",{className:"text-gray-900",children:e?.email}),a.jsx(f.C,{variant:"outline",className:"mt-1 text-xs",children:"認証済み"})]})]}),(0,a.jsxs)("div",{className:"mt-4 grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,a.jsxs)("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"ロール"}),a.jsx(f.C,{variant:"engineering",children:s})]}),(0,a.jsxs)("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"会員レベル"}),(()=>{let e=(0,_.$9)(z.experience_years,z.specialties),r=(0,_.qf)(e);return a.jsx(f.C,{className:r.color,children:r.label})})()]})]})]})]})})]})}),a.jsx(i.E.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.2},children:(0,a.jsxs)(y.Zb,{className:"hover-lift",children:[a.jsx(y.Ol,{children:(0,a.jsxs)(y.ll,{className:"flex items-center gap-2",children:[a.jsx(m.Z,{className:"w-5 h-5"}),"専門情報"]})}),(0,a.jsxs)(y.aY,{className:"space-y-6",children:[(0,a.jsxs)("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-3",children:"専門分野"}),w?(0,a.jsxs)("div",{className:"space-y-3",children:[a.jsx("div",{className:"grid grid-cols-2 md:grid-cols-3 gap-2",children:["未経験","道路設計","橋梁設計","河川工事","上下水道設計","トンネル設計","地下構造","構造物点検","測量業務","地質調査","環境評価","施工管理"].filter(e=>!z.specialties.includes(e)).map(e=>(0,a.jsxs)("button",{type:"button",onClick:()=>O(e),className:"px-3 py-2 text-sm border border-gray-200 rounded-lg hover:border-engineering-blue hover:bg-engineering-blue/5 transition-colors",children:[a.jsx(u.Z,{className:"w-3 h-3 inline mr-1"}),e]},e))}),z.specialties.length>0&&a.jsx("div",{className:"flex flex-wrap gap-2",children:z.specialties.map(e=>(0,a.jsxs)(f.C,{variant:"engineering",className:"cursor-pointer",onClick:()=>R(e),children:[e,a.jsx(c.Z,{className:"w-3 h-3 ml-1"})]},e))})]}):a.jsx("div",{className:"flex flex-wrap gap-2",children:r?.specialties?.map(e=>a.jsx(f.C,{variant:"engineering",children:e},e))||a.jsx("p",{className:"text-gray-500",children:"未設定"})})]}),(0,a.jsxs)("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-3",children:"資格・免許"}),w?(0,a.jsxs)("div",{className:"space-y-3",children:[a.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-2",children:["技術士（建設部門）","技術士（上下水道部門）","技術士（その他）","技術士補","一級建築士","測量士","土木施工管理技士","管工事施工管理技士","造園施工管理技士","土地家屋調査士"].filter(e=>!z.qualifications.includes(e)).map(e=>(0,a.jsxs)("button",{type:"button",onClick:()=>T(e),className:"px-3 py-2 text-sm border border-gray-200 rounded-lg hover:border-engineering-blue hover:bg-engineering-blue/5 transition-colors text-left",children:[a.jsx(u.Z,{className:"w-3 h-3 inline mr-1"}),e]},e))}),z.qualifications.length>0&&a.jsx("div",{className:"flex flex-wrap gap-2",children:z.qualifications.map(e=>(0,a.jsxs)(f.C,{variant:"success",className:"cursor-pointer",onClick:()=>L(e),children:[e,a.jsx(c.Z,{className:"w-3 h-3 ml-1"})]},e))})]}):a.jsx("div",{className:"flex flex-wrap gap-2",children:r?.qualifications?.map(e=>a.jsx(f.C,{variant:"success",children:e},e))||a.jsx("p",{className:"text-gray-500",children:"未設定"})})]}),(0,a.jsxs)("div",{children:[(0,a.jsxs)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:["経験年数 ",z.specialties.some(e=>"未経験"!==e)&&"*"]}),w?a.jsx("input",{type:"number",min:"0",max:"50",value:z.experience_years,onChange:e=>M(r=>({...r,experience_years:e.target.value})),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-engineering-blue focus:border-transparent",placeholder:"5",required:z.specialties.some(e=>"未経験"!==e)}):r?.experience_years?(0,a.jsxs)("p",{className:"text-gray-900",children:[r.experience_years,"年"]}):a.jsx("p",{className:"text-gray-500",children:"未設定"}),w&&z.specialties.some(e=>"未経験"!==e)&&a.jsx("p",{className:"text-sm text-gray-500 mt-1",children:"未経験以外の専門分野を選択した場合は必須です"})]})]})]})}),a.jsx(i.E.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.25},children:(0,a.jsxs)(y.Zb,{className:"hover-lift",children:[(0,a.jsxs)(y.Ol,{children:[(0,a.jsxs)(y.ll,{className:"flex items-center gap-2",children:[a.jsx(x.Z,{className:"w-5 h-5"}),"個人情報"]}),a.jsx(y.SZ,{children:"氏名、住所（自動入力）、電話番号は必須項目です。住所（その他）、会社番号、インボイス番号は任意で入力してください"})]}),(0,a.jsxs)(y.aY,{className:"space-y-4",children:[(0,a.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,a.jsxs)("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"氏名 *"}),w?a.jsx("input",{type:"text",value:z.formal_name,onChange:e=>M(r=>({...r,formal_name:e.target.value})),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-engineering-blue focus:border-transparent",placeholder:"田中 太郎",required:!0}):a.jsx("p",{className:"text-gray-900",children:r?.formal_name||"未設定"})]}),(0,a.jsxs)("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"電話番号 *"}),w?a.jsx("input",{type:"tel",value:z.phone_number,onChange:e=>M(r=>({...r,phone_number:e.target.value})),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-engineering-blue focus:border-transparent",placeholder:"03-1234-5678",required:!0}):a.jsx("p",{className:"text-gray-900",children:r?.phone_number||"未設定"})]})]}),(0,a.jsxs)("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"郵便番号"}),w?a.jsx("input",{type:"text",value:z.postal_code,onChange:e=>$(e.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-engineering-blue focus:border-transparent",placeholder:"1234567",maxLength:7}):a.jsx("p",{className:"text-gray-900",children:r?.postal_code||"未設定"}),w&&a.jsx("p",{className:"text-sm text-gray-500 mt-1",children:"7桁の郵便番号を入力すると住所が自動入力されます"})]}),(0,a.jsxs)("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"住所（自動入力） *"}),w?a.jsx("input",{type:"text",value:z.address,onChange:e=>M(r=>({...r,address:e.target.value})),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-engineering-blue focus:border-transparent",placeholder:"東京都渋谷区...",required:!0}):a.jsx("p",{className:"text-gray-900",children:r?.address||"未設定"}),w&&a.jsx("p",{className:"text-sm text-gray-500 mt-1",children:"郵便番号から自動入力されます（手動でも編集可能）"})]}),(0,a.jsxs)("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"住所（その他）"}),w?a.jsx("input",{type:"text",value:z.address_detail,onChange:e=>M(r=>({...r,address_detail:e.target.value})),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-engineering-blue focus:border-transparent",placeholder:"マンション名、部屋番号など"}):a.jsx("p",{className:"text-gray-900",children:r?.address_detail||"未設定"}),w&&a.jsx("p",{className:"text-sm text-gray-500 mt-1",children:"マンション名、部屋番号、建物名などを入力してください"})]}),(0,a.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,a.jsxs)("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"会社番号（法人番号）"}),w?a.jsx("input",{type:"text",value:z.company_number,onChange:e=>M(r=>({...r,company_number:e.target.value})),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-engineering-blue focus:border-transparent",placeholder:"1234567890123"}):a.jsx("p",{className:"text-gray-900",children:r?.company_number||"未設定"})]}),(0,a.jsxs)("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"インボイス番号（Tを除く）"}),w?a.jsx("input",{type:"text",value:z.registration_number,onChange:e=>{let r=e.target.value.replace(/[^0-9]/g,"");M(e=>({...e,registration_number:r}))},className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-engineering-blue focus:border-transparent",placeholder:"1234567890123",maxLength:13}):a.jsx("p",{className:"text-gray-900",children:r?.registration_number?`T${r.registration_number}`:"未設定"})]})]})]})]})}),r&&a.jsx(i.E.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.3},children:(0,a.jsxs)(y.Zb,{className:"hover-lift",children:[a.jsx(y.Ol,{children:(0,a.jsxs)(y.ll,{className:"flex items-center gap-2",children:[a.jsx(p.Z,{className:"w-5 h-5"}),"パフォーマンス"]})}),a.jsx(y.aY,{children:(0,a.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6",children:[(0,a.jsxs)("div",{className:"text-center",children:[a.jsx("div",{className:"text-3xl font-bold text-engineering-blue mb-2",children:r.rating?r.rating.toFixed(1):"N/A"}),a.jsx("p",{className:"text-sm text-gray-600",children:"平均評価"}),a.jsx("div",{className:"flex justify-center mt-2",children:[1,2,3,4,5].map(e=>a.jsx(p.Z,{className:`w-4 h-4 ${r.rating&&e<=r.rating?"text-yellow-500 fill-current":"text-gray-300"}`},e))})]}),(0,a.jsxs)("div",{className:"text-center",children:[a.jsx("div",{className:"text-3xl font-bold text-engineering-green mb-2",children:"12"}),a.jsx("p",{className:"text-sm text-gray-600",children:"完了プロジェクト"})]}),(0,a.jsxs)("div",{className:"text-center",children:[a.jsx("div",{className:"text-3xl font-bold text-purple-600 mb-2",children:"98%"}),a.jsx("p",{className:"text-sm text-gray-600",children:"納期達成率"})]})]})})]})})]})})]})]})}},76586:(e,r,s)=>{"use strict";s.r(r),s.d(r,{AuthGuard:()=>o,useRoleAccess:()=>m,withAuth:()=>d});var a=s(95344),t=s(3729),i=s(22254),n=s(57916),l=s(42739),c=s(43750);function o({children:e,requiredRole:r,allowedRoles:s,redirectTo:o="/auth/login"}){let{user:d,userRole:m,loading:u}=(0,c.useAuth)(),x=(0,i.useRouter)(),p=(0,i.usePathname)(),g=(0,t.useRef)(!1);return((0,t.useEffect)(()=>{if(!u&&!g.current){if(!d){sessionStorage.setItem("redirectAfterLogin",p),p!==o&&(g.current=!0,x.push(o));return}if(r&&m!==r||s&&s.length>0&&(!m||!s.includes(m))){"/unauthorized"!==p&&(g.current=!0,x.push("/unauthorized"));return}}},[d,m,u,r,s]),u)?a.jsx("div",{className:"min-h-screen bg-gradient-mesh flex items-center justify-center",children:(0,a.jsxs)(n.E.div,{initial:{opacity:0,scale:.9},animate:{opacity:1,scale:1},className:"text-center",children:[a.jsx("div",{className:"w-16 h-16 bg-engineering-blue rounded-xl flex items-center justify-center mx-auto mb-4",children:a.jsx(l.Z,{className:"w-8 h-8 text-white animate-spin"})}),a.jsx("h2",{className:"text-xl font-semibold text-gray-900 mb-2",children:"認証確認中..."}),a.jsx("p",{className:"text-gray-600",children:"しばらくお待ちください"})]})}):!d||r&&m!==r||s&&s.length>0&&(!m||!s.includes(m))?null:a.jsx(a.Fragment,{children:e})}function d(e,r){return function(s){return a.jsx(o,{requiredRole:r,children:a.jsx(e,{...s})})}}function m(){let{userRole:e}=(0,c.useAuth)(),r=r=>e===r,s=r=>!!e&&r.includes(e);return{hasRole:r,hasAnyRole:s,isAdmin:()=>r("OrgAdmin"),isStaff:()=>r("Staff"),isContractor:()=>r("Contractor"),isReviewer:()=>r("Reviewer"),isAuditor:()=>r("Auditor"),canManageProjects:()=>s(["OrgAdmin","Staff"]),canViewFinancials:()=>s(["OrgAdmin","Staff","Auditor"]),canReviewProjects:()=>s(["Reviewer","OrgAdmin"]),canViewAuditLogs:()=>s(["Auditor","OrgAdmin"])}}},26298:(e,r,s)=>{"use strict";s.d(r,{E:()=>v});var a=s(95344),t=s(3729);s(81202);var i=s(45877),n=["a","button","div","form","h2","h3","img","input","label","li","nav","ol","p","select","span","svg","ul"].reduce((e,r)=>{let s=(0,i.Z8)(`Primitive.${r}`),n=t.forwardRef((e,t)=>{let{asChild:i,...n}=e,l=i?s:r;return(0,a.jsx)(l,{...n,ref:t})});return n.displayName=`Primitive.${r}`,{...e,[r]:n}},{}),l="Progress",[c,o]=function(e,r=[]){let s=[],i=()=>{let r=s.map(e=>t.createContext(e));return function(s){let a=s?.[e]||r;return t.useMemo(()=>({[`__scope${e}`]:{...s,[e]:a}}),[s,a])}};return i.scopeName=e,[function(r,i){let n=t.createContext(i),l=s.length;s=[...s,i];let c=r=>{let{scope:s,children:i,...c}=r,o=s?.[e]?.[l]||n,d=t.useMemo(()=>c,Object.values(c));return(0,a.jsx)(o.Provider,{value:d,children:i})};return c.displayName=r+"Provider",[c,function(s,a){let c=a?.[e]?.[l]||n,o=t.useContext(c);if(o)return o;if(void 0!==i)return i;throw Error(`\`${s}\` must be used within \`${r}\``)}]},function(...e){let r=e[0];if(1===e.length)return r;let s=()=>{let s=e.map(e=>({useScope:e(),scopeName:e.scopeName}));return function(e){let a=s.reduce((r,{useScope:s,scopeName:a})=>{let t=s(e)[`__scope${a}`];return{...r,...t}},{});return t.useMemo(()=>({[`__scope${r.scopeName}`]:a}),[a])}};return s.scopeName=r.scopeName,s}(i,...r)]}(l),[d,m]=c(l),u=t.forwardRef((e,r)=>{var s,t;let{__scopeProgress:i,value:l=null,max:c,getValueLabel:o=g,...m}=e;(c||0===c)&&!y(c)&&console.error((s=`${c}`,`Invalid prop \`max\` of value \`${s}\` supplied to \`Progress\`. Only numbers greater than 0 are valid max values. Defaulting to \`100\`.`));let u=y(c)?c:100;null===l||f(l,u)||console.error((t=`${l}`,`Invalid prop \`value\` of value \`${t}\` supplied to \`Progress\`. The \`value\` prop must be:
  - a positive number
  - less than the value passed to \`max\` (or 100 if no \`max\` prop is set)
  - \`null\` or \`undefined\` if the progress is indeterminate.

Defaulting to \`null\`.`));let x=f(l,u)?l:null,p=b(x)?o(x,u):void 0;return(0,a.jsx)(d,{scope:i,value:x,max:u,children:(0,a.jsx)(n.div,{"aria-valuemax":u,"aria-valuemin":0,"aria-valuenow":b(x)?x:void 0,"aria-valuetext":p,role:"progressbar","data-state":h(x,u),"data-value":x??void 0,"data-max":u,...m,ref:r})})});u.displayName=l;var x="ProgressIndicator",p=t.forwardRef((e,r)=>{let{__scopeProgress:s,...t}=e,i=m(x,s);return(0,a.jsx)(n.div,{"data-state":h(i.value,i.max),"data-value":i.value??void 0,"data-max":i.max,...t,ref:r})});function g(e,r){return`${Math.round(e/r*100)}%`}function h(e,r){return null==e?"indeterminate":e===r?"complete":"loading"}function b(e){return"number"==typeof e}function y(e){return b(e)&&!isNaN(e)&&e>0}function f(e,r){return b(e)&&!isNaN(e)&&e<=r&&e>=0}p.displayName=x;var j=s(11453);let v=t.forwardRef(({className:e,value:r,variant:s="default",...t},i)=>a.jsx(u,{ref:i,className:(0,j.cn)("relative h-2 w-full overflow-hidden rounded-full","default"===s&&"bg-primary/20","engineering"===s&&"bg-engineering-blue/20","gradient"===s&&"bg-gradient-to-r from-engineering-blue/20 to-engineering-green/20",e),...t,children:a.jsx(p,{className:(0,j.cn)("h-full w-full flex-1 transition-all","default"===s&&"bg-primary","engineering"===s&&"bg-engineering-blue","gradient"===s&&"gradient-engineering"),style:{transform:`translateX(-${100-(r||0)}%)`}})}));v.displayName=u.displayName},91684:(e,r,s)=>{"use strict";s.d(r,{$9:()=>t,DY:()=>a,qf:()=>i});let a={beginner:{level:"beginner",label:"初級",description:"経験年数3年未満、未経験",color:"bg-green-100 text-green-800"},intermediate:{level:"intermediate",label:"中級",description:"経験年数3年以上7年未満",color:"bg-yellow-100 text-yellow-800"},advanced:{level:"advanced",label:"上級",description:"経験年数7年以上",color:"bg-red-100 text-red-800"}};function t(e,r){if(0===r.length||r.every(e=>"未経験"===e))return"beginner";let s=parseInt(e||"0",10);return s<3?"beginner":s<7?"intermediate":"advanced"}function i(e){return a[e]}},65648:(e,r,s)=>{"use strict";s.r(r),s.d(r,{$$typeof:()=>i,__esModule:()=>t,default:()=>n});let a=(0,s(86843).createProxy)(String.raw`/Users/sayuri/caddonworks/src/app/profile/page.tsx`),{__esModule:t,$$typeof:i}=a,n=a.default}};var r=require("../../webpack-runtime.js");r.C(e);var s=e=>r(r.s=e),a=r.X(0,[1638,4679,3035,7962,4835,8710,6152],()=>s(10251));module.exports=a})();