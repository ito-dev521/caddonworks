(()=>{var e={};e.id=5913,e.ids=[5913],e.modules={47849:e=>{"use strict";e.exports=require("next/dist/client/components/action-async-storage.external")},72934:e=>{"use strict";e.exports=require("next/dist/client/components/action-async-storage.external.js")},55403:e=>{"use strict";e.exports=require("next/dist/client/components/request-async-storage.external")},54580:e=>{"use strict";e.exports=require("next/dist/client/components/request-async-storage.external.js")},94749:e=>{"use strict";e.exports=require("next/dist/client/components/static-generation-async-storage.external")},45869:e=>{"use strict";e.exports=require("next/dist/client/components/static-generation-async-storage.external.js")},20399:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},13685:e=>{"use strict";e.exports=require("http")},95687:e=>{"use strict";e.exports=require("https")},85477:e=>{"use strict";e.exports=require("punycode")},12781:e=>{"use strict";e.exports=require("stream")},57310:e=>{"use strict";e.exports=require("url")},59796:e=>{"use strict";e.exports=require("zlib")},1325:(e,t,s)=>{"use strict";s.r(t),s.d(t,{GlobalError:()=>n.ZP,__next_app__:()=>x,originalPathname:()=>o,pages:()=>d,routeModule:()=>m,tree:()=>c});var a=s(50482),r=s(69108),n=s(83543),i=s(68300),l={};for(let e in i)0>["default","tree","pages","GlobalError","originalPathname","__next_app__","routeModule"].indexOf(e)&&(l[e]=()=>i[e]);s.d(t,l);let c=["",{children:["contracts",{children:["__PAGE__",{},{page:[()=>Promise.resolve().then(s.bind(s,30434)),"/Users/sayuri/caddonworks/src/app/contracts/page.tsx"]}]},{}]},{layout:[()=>Promise.resolve().then(s.bind(s,61623)),"/Users/sayuri/caddonworks/src/app/layout.tsx"],error:[()=>Promise.resolve().then(s.bind(s,24117)),"/Users/sayuri/caddonworks/src/app/error.tsx"],"not-found":[()=>Promise.resolve().then(s.bind(s,48206)),"/Users/sayuri/caddonworks/src/app/not-found.tsx"]}],d=["/Users/sayuri/caddonworks/src/app/contracts/page.tsx"],o="/contracts/page",x={require:s,loadChunk:()=>Promise.resolve()},m=new a.AppPageRouteModule({definition:{kind:r.x.APP_PAGE,page:"/contracts/page",pathname:"/contracts",bundlePath:"",filename:"",appPaths:[]},userland:{loaderTree:c}})},63947:(e,t,s)=>{Promise.resolve().then(s.bind(s,67397))},55794:(e,t,s)=>{"use strict";s.d(t,{Z:()=>a});/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let a=(0,s(69224).Z)("Calendar",[["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",ry:"2",key:"eu3xkr"}],["line",{x1:"16",x2:"16",y1:"2",y2:"6",key:"m3sa8f"}],["line",{x1:"8",x2:"8",y1:"2",y2:"6",key:"18kwsl"}],["line",{x1:"3",x2:"21",y1:"10",y2:"10",key:"xt86sb"}]])},25545:(e,t,s)=>{"use strict";s.d(t,{Z:()=>a});/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let a=(0,s(69224).Z)("Clock",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["polyline",{points:"12 6 12 12 16 14",key:"68esgv"}]])},53148:(e,t,s)=>{"use strict";s.d(t,{Z:()=>a});/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let a=(0,s(69224).Z)("Eye",[["path",{d:"M2 12s3-7 10-7 10 7 10 7-3 7-10 7-10-7-10-7Z",key:"rwhkz3"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]])},42739:(e,t,s)=>{"use strict";s.d(t,{Z:()=>a});/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let a=(0,s(69224).Z)("Loader2",[["path",{d:"M21 12a9 9 0 1 1-6.219-8.56",key:"13zald"}]])},38852:(e,t,s)=>{"use strict";s.d(t,{Z:()=>a});/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let a=(0,s(69224).Z)("MessageSquare",[["path",{d:"M21 15a2 2 0 0 1-2 2H7l-4 4V5a2 2 0 0 1 2-2h14a2 2 0 0 1 2 2z",key:"1lielz"}]])},67397:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>f});var a=s(95344),r=s(3729),n=s(57916),i=s(66138),l=s(37121),c=s(55794),d=s(53148),o=s(38852),x=s(25545),m=s(5094),h=s(23673),g=s(19591),u=s(43750),p=s(76586),j=s(59659),y=s(22254),b=s(18704);function N(){let{userProfile:e,userRole:t}=(0,u.useAuth)(),s=(0,y.useRouter)(),[p,N]=(0,r.useState)([]),[f,v]=(0,r.useState)([]),[w,_]=(0,r.useState)([]),[k,S]=(0,r.useState)([]),[A,P]=(0,r.useState)(!0),[C,Z]=(0,r.useState)(null),[z,D]=(0,r.useState)("signed"),O=(0,r.useRef)(null),L=async()=>{try{P(!0);let{data:{session:e},error:t}=await b.OQ.auth.getSession();if(t||!e){console.error("セッション取得エラー:",t),Z("認証が必要です");return}let s=await fetch("/api/contracts",{headers:{Authorization:`Bearer ${e.access_token}`,"Content-Type":"application/json"}}),a=await s.json();if(s.ok){let e=a.contracts||[];if(0===e.length)N([]),v([]);else{let t=e.filter(e=>"signed"===e.status||"completed"===e.status),s=e.filter(e=>"pending_contractor"===e.status||"pending_org"===e.status);N(t),v(s)}}else console.error("契約取得エラー:",a.message),Z(a.message||"契約データの取得に失敗しました")}catch(e){console.error("契約取得エラー:",e),Z("サーバーエラーが発生しました")}finally{P(!1)}},$=async()=>{try{let{data:{session:e},error:t}=await b.OQ.auth.getSession();if(t||!e){console.error("セッション取得エラー:",t);return}let s=await fetch("/api/projects?status=completed",{headers:{Authorization:`Bearer ${e.access_token}`,"Content-Type":"application/json"}});if(s.ok){let e=await s.json();_(e.projects||[])}}catch(e){console.error("完了案件取得エラー:",e)}},q=async()=>{try{let{data:{session:e},error:t}=await b.OQ.auth.getSession();if(t||!e){console.error("セッション取得エラー:",t);return}let s=await fetch("/api/invoices",{headers:{Authorization:`Bearer ${e.access_token}`,"Content-Type":"application/json"}});if(s.ok){let e=await s.json();S(e.invoices||[])}}catch(e){console.error("請求書取得エラー:",e)}};(0,r.useEffect)(()=>{if(!e||!t){P(!1);return}let s=`${e.id}:${t}`;O.current!==s&&(O.current=s,L(),"OrgAdmin"===t?$():"Contractor"===t&&q())},[e,t]);let J=async e=>{try{let{data:{session:t},error:s}=await b.OQ.auth.getSession();if(s||!t){console.error("セッション取得エラー:",s),Z("認証が必要です");return}let a=await fetch(`/api/contracts/${e}/sign`,{method:"POST",headers:{Authorization:`Bearer ${t.access_token}`,"Content-Type":"application/json"}}),r=await a.json();a.ok?await L():Z(r.message||"契約の署名に失敗しました")}catch(e){console.error("契約署名エラー:",e),Z("サーバーエラーが発生しました")}},R=async e=>{try{let{data:{session:t},error:s}=await b.OQ.auth.getSession();if(s||!t){console.error("セッション取得エラー:",s),alert("認証が必要です");return}let a=await fetch("/api/invoices",{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${t.access_token}`},body:JSON.stringify({project_id:e,type:"completion"})}),r=await a.json();a.ok?(alert("業務完了届が作成されました。受注者に通知が送信されます。"),await $()):alert("業務完了届作成に失敗しました: "+r.message)}catch(e){console.error("業務完了届作成エラー:",e),alert("ネットワークエラーが発生しました")}};return A?a.jsx("div",{className:"min-h-screen bg-gradient-mesh flex items-center justify-center",children:(0,a.jsxs)("div",{className:"text-center",children:[a.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-engineering-blue mx-auto mb-4"}),a.jsx("p",{className:"text-gray-600",children:"データを読み込み中..."})]})}):e&&t?C?a.jsx("div",{className:"min-h-screen bg-gradient-mesh flex items-center justify-center",children:(0,a.jsxs)("div",{className:"text-center bg-white p-8 rounded-lg shadow-xl max-w-md",children:[a.jsx(i.Z,{className:"w-12 h-12 text-red-500 mx-auto mb-4"}),a.jsx("h2",{className:"text-xl font-semibold text-gray-900 mb-2",children:"エラーが発生しました"}),a.jsx("p",{className:"text-gray-600 mb-4",children:C}),a.jsx(m.z,{onClick:L,variant:"engineering",children:"再試行"})]})}):(0,a.jsxs)("div",{className:"min-h-screen bg-gradient-mesh",children:[a.jsx(j.W,{}),a.jsx("div",{className:"container mx-auto px-4 py-8",children:(0,a.jsxs)(n.E.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.5},className:"max-w-6xl mx-auto",children:[(0,a.jsxs)("div",{className:"mb-8",children:[a.jsx("h1",{className:"text-3xl font-bold text-gray-900 mb-2",children:"契約管理"}),a.jsx("p",{className:"text-gray-600",children:"OrgAdmin"===t?"発注者としての契約一覧":"受注者としての契約一覧"})]}),a.jsx("div",{className:"mb-6",children:a.jsx("div",{className:"border-b border-gray-200",children:(0,a.jsxs)("nav",{className:"-mb-px flex space-x-8",children:[(0,a.jsxs)("button",{onClick:()=>D("signed"),className:`py-2 px-1 border-b-2 font-medium text-sm ${"signed"===z?"border-engineering-blue text-engineering-blue":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300"}`,children:["署名済み契約",p.length>0&&a.jsx("span",{className:"ml-2 bg-engineering-blue text-white text-xs px-2 py-1 rounded-full",children:p.length})]}),(0,a.jsxs)("button",{onClick:()=>D("pending"),className:`py-2 px-1 border-b-2 font-medium text-sm ${"pending"===z?"border-engineering-blue text-engineering-blue":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300"}`,children:["署名待ち契約",f.length>0&&a.jsx("span",{className:"ml-2 bg-yellow-500 text-white text-xs px-2 py-1 rounded-full",children:f.length})]}),(0,a.jsxs)("button",{onClick:()=>D("invoices"),className:`py-2 px-1 border-b-2 font-medium text-sm ${"invoices"===z?"border-engineering-blue text-engineering-blue":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300"}`,children:["OrgAdmin"===t?"業務完了届発行":"請求書","OrgAdmin"===t&&w.length>0&&a.jsx("span",{className:"ml-2 bg-green-500 text-white text-xs px-2 py-1 rounded-full",children:w.length}),"Contractor"===t&&k.length>0&&a.jsx("span",{className:"ml-2 bg-blue-500 text-white text-xs px-2 py-1 rounded-full",children:k.length})]})]})})}),"signed"===z&&(0===p.length?(0,a.jsxs)(h.Zb,{className:"p-8 text-center",children:[a.jsx(l.Z,{className:"w-16 h-16 text-gray-400 mx-auto mb-4"}),a.jsx("h3",{className:"text-xl font-semibold text-gray-900 mb-2",children:"署名済み契約がありません"}),a.jsx("p",{className:"text-gray-600",children:"まだ署名済みの契約がありません。"})]}):a.jsx("div",{className:"space-y-8",children:Object.values(p.reduce((e,t)=>{let s=new Date(t.created_at),a=`${s.getFullYear()}-${String(s.getMonth()+1).padStart(2,"0")}`;return e[a]||(e[a]={monthName:s.toLocaleDateString("ja-JP",{year:"numeric",month:"long"}),contracts:[]}),e[a].contracts.push(t),e},{})).sort((e,t)=>t.monthName.localeCompare(e.monthName)).map((e,r)=>(0,a.jsxs)("div",{children:[(0,a.jsxs)("h2",{className:"text-xl font-semibold text-gray-900 mb-4 flex items-center",children:[a.jsx(c.Z,{className:"w-5 h-5 mr-2"}),e.monthName,(0,a.jsxs)("span",{className:"ml-2 text-sm font-normal text-gray-500",children:["(",e.contracts.length,"件)"]})]}),a.jsx("div",{className:"grid gap-4",children:e.contracts.map(e=>a.jsx(n.E.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.3},children:(0,a.jsxs)(h.Zb,{className:"p-6 border-l-4 border-l-green-500",children:[(0,a.jsxs)("div",{className:"flex justify-between items-start mb-4",children:[(0,a.jsxs)("div",{children:[a.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-1",children:e.project_title}),(0,a.jsxs)("p",{className:"text-sm text-gray-600 mb-2",children:["契約ID: ",e.id.slice(0,8).toUpperCase()]}),a.jsx(g.C,{variant:"default",className:"bg-green-100 text-green-800",children:"署名完了"})]}),(0,a.jsxs)("div",{className:"text-right",children:[(0,a.jsxs)("p",{className:"text-2xl font-bold text-engineering-blue",children:["\xa5",e.bid_amount.toLocaleString()]}),(0,a.jsxs)("p",{className:"text-xs text-gray-500 mt-1",children:["署名日: ",e.signed_at?new Date(e.signed_at).toLocaleDateString("ja-JP"):"不明"]})]})]}),(0,a.jsxs)("div",{className:"grid grid-cols-2 gap-4 mb-4 text-sm",children:[(0,a.jsxs)("div",{children:[(0,a.jsxs)("span",{className:"text-gray-600",children:["OrgAdmin"===t?"受注者":"発注者",":"]}),a.jsx("p",{className:"font-medium text-gray-900",children:"OrgAdmin"===t?e.contractor_name:e.org_name})]}),(0,a.jsxs)("div",{children:[a.jsx("span",{className:"text-gray-600",children:"契約期間:"}),(0,a.jsxs)("p",{className:"text-gray-900",children:[new Date(e.start_date).toLocaleDateString("ja-JP")," - ",new Date(e.end_date).toLocaleDateString("ja-JP")]})]})]}),(0,a.jsxs)("div",{className:"flex justify-between items-center",children:[(0,a.jsxs)(m.z,{variant:"outline",size:"sm",onClick:()=>s.push(`/contracts/${e.id}`),children:[a.jsx(d.Z,{className:"w-4 h-4 mr-2"}),"詳細表示"]}),(0,a.jsxs)(m.z,{variant:"engineering",size:"sm",onClick:()=>s.push(`/chat?contractId=${e.id}`),children:[a.jsx(o.Z,{className:"w-4 h-4 mr-2"}),"チャット開始"]})]})]})},e.id))})]},r))})),"pending"===z&&(0===f.length?(0,a.jsxs)(h.Zb,{className:"p-8 text-center",children:[a.jsx(x.Z,{className:"w-16 h-16 text-gray-400 mx-auto mb-4"}),a.jsx("h3",{className:"text-xl font-semibold text-gray-900 mb-2",children:"署名待ち契約がありません"}),a.jsx("p",{className:"text-gray-600",children:"現在署名待ちの契約はありません。"})]}):a.jsx("div",{className:"space-y-6",children:f.map(e=>a.jsx(n.E.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.3},children:(0,a.jsxs)(h.Zb,{className:"p-6 border-l-4 border-l-yellow-500",children:[(0,a.jsxs)("div",{className:"flex justify-between items-start mb-4",children:[(0,a.jsxs)("div",{children:[a.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-1",children:e.project_title}),(0,a.jsxs)("p",{className:"text-sm text-gray-600 mb-2",children:["契約ID: ",e.id.slice(0,8).toUpperCase()]}),a.jsx(g.C,{variant:"outline",className:"bg-yellow-50 text-yellow-700 border-yellow-300",children:"署名待ち"})]}),(0,a.jsxs)("div",{className:"text-right",children:[(0,a.jsxs)("p",{className:"text-2xl font-bold text-engineering-blue",children:["\xa5",e.bid_amount.toLocaleString()]}),(0,a.jsxs)("p",{className:"text-xs text-gray-500 mt-1",children:["作成日: ",new Date(e.created_at).toLocaleDateString("ja-JP")]})]})]}),(0,a.jsxs)("div",{className:"grid grid-cols-2 gap-4 mb-4 text-sm",children:[(0,a.jsxs)("div",{children:[(0,a.jsxs)("span",{className:"text-gray-600",children:["OrgAdmin"===t?"受注者":"発注者",":"]}),a.jsx("p",{className:"font-medium text-gray-900",children:"OrgAdmin"===t?e.contractor_name:e.org_name})]}),(0,a.jsxs)("div",{children:[a.jsx("span",{className:"text-gray-600",children:"契約期間:"}),(0,a.jsxs)("p",{className:"text-gray-900",children:[new Date(e.start_date).toLocaleDateString("ja-JP")," - ",new Date(e.end_date).toLocaleDateString("ja-JP")]})]})]}),(0,a.jsxs)("div",{className:"flex justify-between items-center",children:[(0,a.jsxs)(m.z,{variant:"outline",size:"sm",onClick:()=>s.push(`/contracts/${e.id}`),children:[a.jsx(d.Z,{className:"w-4 h-4 mr-2"}),"詳細表示"]}),(0,a.jsxs)("div",{className:"flex gap-2",children:["pending_contractor"===e.status&&"Contractor"===t&&a.jsx(m.z,{onClick:()=>J(e.id),variant:"engineering",size:"sm",children:"署名する"}),"pending_org"===e.status&&"OrgAdmin"===t&&a.jsx(m.z,{onClick:()=>J(e.id),variant:"engineering",size:"sm",children:"署名する"})]})]}),a.jsx("div",{className:"border-t pt-4 mt-4",children:(0,a.jsxs)("div",{className:"grid grid-cols-2 gap-4 text-sm",children:[(0,a.jsxs)("div",{children:[a.jsx("span",{className:"text-gray-600",children:"発注者署名:"}),a.jsx("span",{className:`ml-2 ${e.org_signed_at?"text-green-600":"text-gray-400"}`,children:e.org_signed_at?new Date(e.org_signed_at).toLocaleString("ja-JP"):"未署名"})]}),(0,a.jsxs)("div",{children:[a.jsx("span",{className:"text-gray-600",children:"受注者署名:"}),a.jsx("span",{className:`ml-2 ${e.contractor_signed_at?"text-green-600":"text-gray-400"}`,children:e.contractor_signed_at?new Date(e.contractor_signed_at).toLocaleString("ja-JP"):"未署名"})]})]})})]})},e.id))})),"invoices"===z&&("OrgAdmin"===t?0===w.length?(0,a.jsxs)(h.Zb,{className:"p-8 text-center",children:[a.jsx(l.Z,{className:"w-16 h-16 text-gray-400 mx-auto mb-4"}),a.jsx("h3",{className:"text-xl font-semibold text-gray-900 mb-2",children:"完了案件がありません"}),a.jsx("p",{className:"text-gray-600",children:"業務完了届発行可能な完了案件がありません。"})]}):(0,a.jsxs)("div",{className:"space-y-6",children:[(0,a.jsxs)("div",{className:"bg-blue-50 p-4 rounded-lg",children:[a.jsx("h3",{className:"font-semibold text-blue-900 mb-2",children:"業務完了届発行について"}),a.jsx("p",{className:"text-sm text-blue-800",children:"完了した案件の業務完了届を発行できます。業務完了届は受注者に送信され、PDF形式でダウンロードも可能です。"})]}),a.jsx("div",{className:"grid gap-4",children:w.map(e=>a.jsx(h.Zb,{className:"p-6",children:(0,a.jsxs)("div",{className:"flex justify-between items-start",children:[(0,a.jsxs)("div",{className:"flex-1",children:[a.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-2",children:e.title}),(0,a.jsxs)("div",{className:"grid grid-cols-2 gap-4 text-sm text-gray-600 mb-4",children:[(0,a.jsxs)("div",{children:[a.jsx("span",{className:"font-medium",children:"受注者:"})," ",e.contractor_name]}),(0,a.jsxs)("div",{children:[a.jsx("span",{className:"font-medium",children:"完了日:"})," ",new Date(e.end_date).toLocaleDateString("ja-JP")]}),(0,a.jsxs)("div",{children:[a.jsx("span",{className:"font-medium",children:"契約金額:"})," \xa5",e.budget.toLocaleString()]}),(0,a.jsxs)("div",{children:[a.jsx("span",{className:"font-medium",children:"カテゴリ:"})," ",e.category]})]}),a.jsx(g.C,{className:"bg-green-100 text-green-800",children:"完了済み"})]}),(0,a.jsxs)("div",{className:"flex gap-2 ml-4",children:[(0,a.jsxs)(m.z,{variant:"outline",size:"sm",onClick:()=>R(e.id),children:[a.jsx(l.Z,{className:"w-4 h-4 mr-2"}),"業務完了届作成"]}),(0,a.jsxs)(m.z,{variant:"outline",size:"sm",onClick:()=>s.push(`/contracts/${e.id}`),children:[a.jsx(d.Z,{className:"w-4 h-4 mr-2"}),"詳細"]})]})]})},e.id))})]}):0===k.length?(0,a.jsxs)(h.Zb,{className:"p-8 text-center",children:[a.jsx(l.Z,{className:"w-16 h-16 text-gray-400 mx-auto mb-4"}),a.jsx("h3",{className:"text-xl font-semibold text-gray-900 mb-2",children:"請求書がありません"}),a.jsx("p",{className:"text-gray-600",children:"まだ請求書が発行されていません。"})]}):(0,a.jsxs)("div",{className:"space-y-6",children:[(0,a.jsxs)("div",{className:"bg-green-50 p-4 rounded-lg",children:[a.jsx("h3",{className:"font-semibold text-green-900 mb-2",children:"請求書について"}),a.jsx("p",{className:"text-sm text-green-800",children:"発注者から発行された請求書の一覧です。支払い状況を確認し、PDF形式でダウンロードできます。"})]}),a.jsx("div",{className:"grid gap-4",children:k.map(e=>a.jsx(h.Zb,{className:"p-6",children:(0,a.jsxs)("div",{className:"flex justify-between items-start",children:[(0,a.jsxs)("div",{className:"flex-1",children:[(0,a.jsxs)("div",{className:"flex items-center gap-2 mb-2",children:[(0,a.jsxs)("h3",{className:"text-lg font-semibold text-gray-900",children:["請求書番号: ",e.invoice_number]}),a.jsx(g.C,{className:"paid"===e.status?"bg-green-100 text-green-800":"overdue"===e.status?"bg-red-100 text-red-800":"bg-yellow-100 text-yellow-800",children:"paid"===e.status?"支払済み":"overdue"===e.status?"支払期限超過":"sent"===e.status?"送信済み":"発行済み"})]}),a.jsx("p",{className:"text-gray-600 mb-4",children:e.description}),(0,a.jsxs)("div",{className:"grid grid-cols-2 gap-4 text-sm text-gray-600 mb-4",children:[(0,a.jsxs)("div",{children:[a.jsx("span",{className:"font-medium",children:"発行日:"})," ",new Date(e.issue_date).toLocaleDateString("ja-JP")]}),(0,a.jsxs)("div",{children:[a.jsx("span",{className:"font-medium",children:"支払期限:"})," ",new Date(e.due_date).toLocaleDateString("ja-JP")]}),(0,a.jsxs)("div",{children:[a.jsx("span",{className:"font-medium",children:"税抜金額:"})," \xa5",e.amount.toLocaleString()]}),(0,a.jsxs)("div",{children:[a.jsx("span",{className:"font-medium",children:"税込金額:"})," \xa5",e.total_amount.toLocaleString()]})]}),e.paid_date&&(0,a.jsxs)("div",{className:"text-sm text-green-600 mb-2",children:["支払完了日: ",new Date(e.paid_date).toLocaleDateString("ja-JP")]})]}),a.jsx("div",{className:"flex gap-2 ml-4",children:(0,a.jsxs)(m.z,{variant:"outline",size:"sm",onClick:()=>{alert("PDF生成機能は準備中です")},children:[a.jsx(l.Z,{className:"w-4 h-4 mr-2"}),"PDF表示"]})})]})},e.id))})]}))]})})]}):a.jsx("div",{className:"min-h-screen bg-gradient-mesh flex items-center justify-center",children:(0,a.jsxs)("div",{className:"text-center bg-white p-8 rounded-lg shadow-xl max-w-md",children:[a.jsx("h2",{className:"text-xl font-semibold text-gray-900 mb-2",children:"ログインが必要です"}),a.jsx("p",{className:"text-gray-600 mb-4",children:"契約管理ページにアクセスするにはログインしてください。"}),a.jsx(m.z,{onClick:()=>window.location.href="/auth/login",variant:"engineering",children:"ログインページへ"})]})})}function f(){return a.jsx(p.AuthGuard,{allowedRoles:["OrgAdmin","Contractor"],children:a.jsx(N,{})})}},76586:(e,t,s)=>{"use strict";s.r(t),s.d(t,{AuthGuard:()=>d,useRoleAccess:()=>x,withAuth:()=>o});var a=s(95344),r=s(3729),n=s(22254),i=s(57916),l=s(42739),c=s(43750);function d({children:e,requiredRole:t,allowedRoles:s,redirectTo:d="/auth/login"}){let{user:o,userRole:x,loading:m}=(0,c.useAuth)(),h=(0,n.useRouter)(),g=(0,n.usePathname)(),u=(0,r.useRef)(!1);return((0,r.useEffect)(()=>{if(!m&&!u.current){if(!o){sessionStorage.setItem("redirectAfterLogin",g),g!==d&&(u.current=!0,h.push(d));return}if(t&&x!==t||s&&s.length>0&&(!x||!s.includes(x))){"/unauthorized"!==g&&(u.current=!0,h.push("/unauthorized"));return}}},[o,x,m,t,s]),m)?a.jsx("div",{className:"min-h-screen bg-gradient-mesh flex items-center justify-center",children:(0,a.jsxs)(i.E.div,{initial:{opacity:0,scale:.9},animate:{opacity:1,scale:1},className:"text-center",children:[a.jsx("div",{className:"w-16 h-16 bg-engineering-blue rounded-xl flex items-center justify-center mx-auto mb-4",children:a.jsx(l.Z,{className:"w-8 h-8 text-white animate-spin"})}),a.jsx("h2",{className:"text-xl font-semibold text-gray-900 mb-2",children:"認証確認中..."}),a.jsx("p",{className:"text-gray-600",children:"しばらくお待ちください"})]})}):!o||t&&x!==t||s&&s.length>0&&(!x||!s.includes(x))?null:a.jsx(a.Fragment,{children:e})}function o(e,t){return function(s){return a.jsx(d,{requiredRole:t,children:a.jsx(e,{...s})})}}function x(){let{userRole:e}=(0,c.useAuth)(),t=t=>e===t,s=t=>!!e&&t.includes(e);return{hasRole:t,hasAnyRole:s,isAdmin:()=>t("OrgAdmin"),isStaff:()=>t("Staff"),isContractor:()=>t("Contractor"),isReviewer:()=>t("Reviewer"),isAuditor:()=>t("Auditor"),canManageProjects:()=>s(["OrgAdmin","Staff"]),canViewFinancials:()=>s(["OrgAdmin","Staff","Auditor"]),canReviewProjects:()=>s(["Reviewer","OrgAdmin"]),canViewAuditLogs:()=>s(["Auditor","OrgAdmin"])}}},30434:(e,t,s)=>{"use strict";s.r(t),s.d(t,{$$typeof:()=>n,__esModule:()=>r,default:()=>i});let a=(0,s(86843).createProxy)(String.raw`/Users/sayuri/caddonworks/src/app/contracts/page.tsx`),{__esModule:r,$$typeof:n}=a,i=a.default}};var t=require("../../webpack-runtime.js");t.C(e);var s=e=>t(t.s=e),a=t.X(0,[1638,4679,3035,7962,4835,8710,6152],()=>s(1325));module.exports=a})();