(()=>{var e={};e.id=9109,e.ids=[9109],e.modules={47849:e=>{"use strict";e.exports=require("next/dist/client/components/action-async-storage.external")},72934:e=>{"use strict";e.exports=require("next/dist/client/components/action-async-storage.external.js")},55403:e=>{"use strict";e.exports=require("next/dist/client/components/request-async-storage.external")},54580:e=>{"use strict";e.exports=require("next/dist/client/components/request-async-storage.external.js")},94749:e=>{"use strict";e.exports=require("next/dist/client/components/static-generation-async-storage.external")},45869:e=>{"use strict";e.exports=require("next/dist/client/components/static-generation-async-storage.external.js")},20399:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},13685:e=>{"use strict";e.exports=require("http")},95687:e=>{"use strict";e.exports=require("https")},85477:e=>{"use strict";e.exports=require("punycode")},12781:e=>{"use strict";e.exports=require("stream")},57310:e=>{"use strict";e.exports=require("url")},59796:e=>{"use strict";e.exports=require("zlib")},65994:(e,s,t)=>{"use strict";t.r(s),t.d(s,{GlobalError:()=>i.ZP,__next_app__:()=>x,originalPathname:()=>o,pages:()=>d,routeModule:()=>u,tree:()=>c});var a=t(50482),r=t(69108),i=t(83543),l=t(68300),n={};for(let e in l)0>["default","tree","pages","GlobalError","originalPathname","__next_app__","routeModule"].indexOf(e)&&(n[e]=()=>l[e]);t.d(s,n);let c=["",{children:["jobs",{children:["__PAGE__",{},{page:[()=>Promise.resolve().then(t.bind(t,40615)),"/Users/sayuri/caddonworks/src/app/jobs/page.tsx"]}]},{}]},{layout:[()=>Promise.resolve().then(t.bind(t,61623)),"/Users/sayuri/caddonworks/src/app/layout.tsx"],error:[()=>Promise.resolve().then(t.bind(t,24117)),"/Users/sayuri/caddonworks/src/app/error.tsx"],"not-found":[()=>Promise.resolve().then(t.bind(t,48206)),"/Users/sayuri/caddonworks/src/app/not-found.tsx"]}],d=["/Users/sayuri/caddonworks/src/app/jobs/page.tsx"],o="/jobs/page",x={require:t,loadChunk:()=>Promise.resolve()},u=new a.AppPageRouteModule({definition:{kind:r.x.APP_PAGE,page:"/jobs/page",pathname:"/jobs",bundlePath:"",filename:"",appPaths:[]},userland:{loaderTree:c}})},66310:(e,s,t)=>{Promise.resolve().then(t.bind(t,62295))},78638:(e,s,t)=>{"use strict";t.d(s,{Z:()=>a});/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let a=(0,t(69224).Z)("Building",[["rect",{width:"16",height:"20",x:"4",y:"2",rx:"2",ry:"2",key:"76otgf"}],["path",{d:"M9 22v-4h6v4",key:"r93iot"}],["path",{d:"M8 6h.01",key:"1dz90k"}],["path",{d:"M16 6h.01",key:"1x0f13"}],["path",{d:"M12 6h.01",key:"1vi96p"}],["path",{d:"M12 10h.01",key:"1nrarc"}],["path",{d:"M12 14h.01",key:"1etili"}],["path",{d:"M16 10h.01",key:"1m94wz"}],["path",{d:"M16 14h.01",key:"1gbofw"}],["path",{d:"M8 10h.01",key:"19clt8"}],["path",{d:"M8 14h.01",key:"6423bh"}]])},55794:(e,s,t)=>{"use strict";t.d(s,{Z:()=>a});/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let a=(0,t(69224).Z)("Calendar",[["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",ry:"2",key:"eu3xkr"}],["line",{x1:"16",x2:"16",y1:"2",y2:"6",key:"m3sa8f"}],["line",{x1:"8",x2:"8",y1:"2",y2:"6",key:"18kwsl"}],["line",{x1:"3",x2:"21",y1:"10",y2:"10",key:"xt86sb"}]])},25545:(e,s,t)=>{"use strict";t.d(s,{Z:()=>a});/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let a=(0,t(69224).Z)("Clock",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["polyline",{points:"12 6 12 12 16 14",key:"68esgv"}]])},48411:(e,s,t)=>{"use strict";t.d(s,{Z:()=>a});/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let a=(0,t(69224).Z)("DollarSign",[["line",{x1:"12",x2:"12",y1:"2",y2:"22",key:"7eqyqh"}],["path",{d:"M17 5H9.5a3.5 3.5 0 0 0 0 7h5a3.5 3.5 0 0 1 0 7H6",key:"1b0p4s"}]])},53148:(e,s,t)=>{"use strict";t.d(s,{Z:()=>a});/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let a=(0,t(69224).Z)("Eye",[["path",{d:"M2 12s3-7 10-7 10 7 10 7-3 7-10 7-10-7-10-7Z",key:"rwhkz3"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]])},17418:(e,s,t)=>{"use strict";t.d(s,{Z:()=>a});/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let a=(0,t(69224).Z)("Filter",[["polygon",{points:"22 3 2 3 10 12.46 10 19 14 21 14 12.46 22 3",key:"1yg77f"}]])},42739:(e,s,t)=>{"use strict";t.d(s,{Z:()=>a});/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let a=(0,t(69224).Z)("Loader2",[["path",{d:"M21 12a9 9 0 1 1-6.219-8.56",key:"13zald"}]])},80508:(e,s,t)=>{"use strict";t.d(s,{Z:()=>a});/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let a=(0,t(69224).Z)("MapPin",[["path",{d:"M20 10c0 6-8 12-8 12s-8-6-8-12a8 8 0 0 1 16 0Z",key:"2oe9fu"}],["circle",{cx:"12",cy:"10",r:"3",key:"ilqhr7"}]])},28765:(e,s,t)=>{"use strict";t.d(s,{Z:()=>a});/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let a=(0,t(69224).Z)("Search",[["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}],["path",{d:"m21 21-4.3-4.3",key:"1qie3q"}]])},62295:(e,s,t)=>{"use strict";t.r(s),t.d(s,{default:()=>S});var a=t(95344),r=t(3729),i=t(57916),l=t(73644),n=t(78638),c=t(46404),d=t(28765),o=t(17418),x=t(25545),u=t(48411),m=t(55794),h=t(18822),g=t(66138),p=t(80508),b=t(53148),j=t(37121),f=t(14513),y=t(59659),N=t(23673),v=t(19591),w=t(5094),_=t(11453),k=t(43750),D=t(18704),C=t(76586),Z=t(91684);function P(){let{userProfile:e,userRole:s,loading:t}=(0,k.useAuth)(),[C,P]=(0,r.useState)([]),[S,q]=(0,r.useState)([]),[A,z]=(0,r.useState)("available"),[M,E]=(0,r.useState)(""),[J,L]=(0,r.useState)(""),[O,R]=(0,r.useState)(null),[$,T]=(0,r.useState)(!0),[B,G]=(0,r.useState)({project_id:"",bid_amount:"",proposal:"",budget_approved:!1}),[I,U]=(0,r.useState)(!1),[F,Y]=(0,r.useState)(null),[Q,H]=(0,r.useState)([]),[K,V]=(0,r.useState)(!1),W=(0,r.useRef)(null),X=e=>null==e?"0":String(e).replace(/[^\d]/g,"").replace(/\B(?=(\d{3})+(?!\d))/g,","),ee=e=>null==e?0:parseInt(String(e).replace(/[^\d]/g,""),10)||0,es=e=>{if(!e)return null;let s=new Date;return Math.ceil((new Date(e).getTime()-s.getTime())/864e5)},et=e=>{let s=es(e);return null===s?"text-gray-600":s<=0?"text-red-600":s<=3?"text-orange-600 font-medium":"text-gray-600"},ea=async()=>{try{console.log("fetchJobs: 開始"),T(!0);let{data:{session:e}}=await D.OQ.auth.getSession();if(console.log("fetchJobs: セッション確認",e?"あり":"なし"),!e){console.error("fetchJobs: セッションが見つかりません"),T(!1),window.location.href="/auth/login";return}console.log("fetchJobs: APIリクエスト開始",{hasAccessToken:!!e.access_token,tokenLength:e.access_token?.length,tokenPreview:e.access_token?.substring(0,20)+"..."});let s=await fetch("/api/jobs",{method:"GET",headers:{Authorization:`Bearer ${e.access_token}`,"Content-Type":"application/json"}});console.log("fetchJobs: APIレスポンス",s.status,s.statusText);let t=await s.json();if(console.log("fetchJobs: API結果",t),s.ok)console.log("fetchJobs: 成功, 案件数:",t.jobs?.length||0),P(t.jobs),q(t.jobs);else{if(console.error("fetchJobs: 案件データの取得に失敗:",{status:s.status,statusText:s.statusText,message:t.message}),401===s.status){console.log("fetchJobs: 認証エラー、ログインページにリダイレクト"),window.location.href="/auth/login";return}P([]),q([])}}catch(e){if(console.error("fetchJobs: データ取得エラー:",e),e instanceof Error&&e.message.includes("401")){console.log("fetchJobs: 認証エラー、ログインページにリダイレクト"),window.location.href="/auth/login";return}P([]),q([])}finally{console.log("fetchJobs: 終了"),T(!1)}};(0,r.useEffect)(()=>{if(console.log("useEffect: 認証状態確認",{userProfile:e?"あり":"なし",userRole:s,loading:t,userProfileId:e?.id,userEmail:e?.email}),!e||"Contractor"!==s){console.log("useEffect: 認証条件未満のため、データ取得をスキップ",{hasUserProfile:!!e,userRole:s,expectedRole:"Contractor"}),T(!1),e&&s&&"Contractor"!==s&&(console.log("useEffect: 権限不足でリダイレクト",{userRole:s}),alert("このページにアクセスするには受注者権限が必要です"),window.location.href="/dashboard");return}let a=`${e.id}:${s}`;W.current!==a&&(W.current=a,console.log("useEffect: 認証OK、データ取得開始",{userRole:s,userProfileId:e.id}),ea())},[e,s]),(0,r.useEffect)(()=>{let e=C;if("available"===A){e=e.filter(e=>"bidding"===e.status);let s=new Date;e=e.filter(e=>!e.bidding_deadline||new Date(e.bidding_deadline)>s)}else"awarded"===A&&(e=e.filter(e=>"bidding"!==e.status));J&&(e=e.filter(e=>e.category===J)),M&&(e=e.filter(e=>e.title.toLowerCase().includes(M.toLowerCase())||e.org_name.toLowerCase().includes(M.toLowerCase())||e.category.toLowerCase().includes(M.toLowerCase())||e.description.toLowerCase().includes(M.toLowerCase()))),q(e)},[C,A,J,M]);let er=async e=>{if(e.preventDefault(),!O)return;let s=C.find(e=>e.id===O);if(s&&!s.can_bid){alert("この案件の募集人数に達しているため、入札できません");return}if(!B.budget_approved){alert("発注者側の予算に同意してください");return}if(!B.budget_approved&&(!B.bid_amount||0>=ee(B.bid_amount))){alert("有効な入札金額を入力してください");return}U(!0);try{let{data:{session:e}}=await D.OQ.auth.getSession();if(!e){alert("ログインが必要です");return}let s=await fetch("/api/bids",{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${e.access_token}`},body:JSON.stringify({project_id:O,bid_amount:B.budget_approved?ee(X(C.find(e=>e.id===O)?.budget||0)):ee(B.bid_amount),proposal:B.proposal,budget_approved:B.budget_approved})}),t=await s.json();s.ok?(alert("入札が正常に送信されました"),R(null),G({project_id:"",bid_amount:"",proposal:"",budget_approved:!1}),ea()):alert("入札の送信に失敗しました: "+t.message)}catch(e){console.error("入札送信エラー:",e),alert("ネットワークエラーが発生しました")}finally{U(!1)}},ei=e=>{R(e),G({project_id:e,bid_amount:"",proposal:"",budget_approved:!1})},el=async e=>{V(!0);try{let{data:{session:s}}=await D.OQ.auth.getSession();if(!s){console.error("セッションが見つかりません");return}let t=await fetch(`/api/contractor/projects/${e}/attachments`,{method:"GET",headers:{Authorization:`Bearer ${s.access_token}`,"Content-Type":"application/json"}}),a=await t.json();t.ok?H(a.attachments||[]):(console.error("添付資料の取得に失敗:",a.message),H([]))}catch(e){console.error("添付資料取得エラー:",e),H([])}finally{V(!1)}},en=e=>{if(0===e)return"0 Bytes";let s=Math.floor(Math.log(e)/Math.log(1024));return parseFloat((e/Math.pow(1024,s)).toFixed(2))+" "+["Bytes","KB","MB","GB"][s]},ec=e=>e.includes("pdf")?"\uD83D\uDCC4":e.includes("image")?"\uD83D\uDDBC️":e.includes("word")?"\uD83D\uDCDD":e.includes("excel")||e.includes("spreadsheet")?"\uD83D\uDCCA":e.includes("powerpoint")||e.includes("presentation")?"\uD83D\uDCFD️":e.includes("zip")||e.includes("rar")?"\uD83D\uDDDC️":e.includes("text")||e.includes("plain")?"\uD83D\uDCC3":e.includes("dwg")?"\uD83C\uDFD7️":e.includes("step")||e.includes("p21")?"\uD83D\uDD27":e.includes("sfc")?"⚙️":e.includes("bfo")?"\uD83D\uDCD0":"\uD83D\uDCCE",ed=e=>{Y(e),el(e)},eo=e=>{switch(e){case"bidding":return"text-blue-600 bg-blue-100";case"in_progress":return"text-green-600 bg-green-100";case"completed":default:return"text-gray-600 bg-gray-100";case"cancelled":return"text-red-600 bg-red-100"}},ex=e=>{switch(e){case"bidding":return"入札受付中";case"in_progress":return"進行中";case"completed":return"完了";case"cancelled":return"キャンセル";default:return e}};return t||$?a.jsx("div",{className:"min-h-screen bg-gradient-mesh flex items-center justify-center",children:(0,a.jsxs)("div",{className:"text-center",children:[a.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-engineering-blue mx-auto mb-4"}),a.jsx("p",{className:"text-gray-600",children:t?"認証情報を読み込み中...":"案件データを読み込み中..."}),(0,a.jsxs)("div",{className:"mt-4 text-xs text-gray-500",children:[(0,a.jsxs)("p",{children:["Loading: ",t?"true":"false"]}),(0,a.jsxs)("p",{children:["DataLoading: ",$?"true":"false"]}),(0,a.jsxs)("p",{children:["User: ",e?"あり":"なし"]}),(0,a.jsxs)("p",{children:["Role: ",s||"なし"]})]}),a.jsx("div",{className:"mt-4",children:a.jsx("button",{onClick:()=>window.location.reload(),className:"text-blue-600 hover:underline text-sm",children:"ページを再読み込み"})})]})}):"Contractor"!==s?(console.log("JobsPage: 権限チェック失敗",{userRole:s,userProfile:!!e}),a.jsx("div",{className:"min-h-screen bg-gradient-mesh flex items-center justify-center",children:a.jsx(N.Zb,{className:"w-full max-w-md",children:(0,a.jsxs)(N.aY,{className:"p-6 text-center",children:[a.jsx(n.Z,{className:"w-12 h-12 text-red-500 mx-auto mb-4"}),a.jsx("h2",{className:"text-xl font-semibold text-gray-900 mb-2",children:"アクセス権限がありません"}),a.jsx("p",{className:"text-gray-600",children:"このページは受注者（Contractor）のみアクセス可能です。"}),(0,a.jsxs)("div",{className:"mt-4 text-xs text-gray-500",children:[(0,a.jsxs)("p",{children:["現在のロール: ",s||"なし"]}),(0,a.jsxs)("p",{children:["ユーザープロフィール: ",e?"あり":"なし"]})]}),(0,a.jsxs)("div",{className:"mt-4 space-y-2",children:[a.jsx("a",{href:"/auth/login",className:"block text-blue-600 hover:underline",children:"ログインページへ"}),a.jsx("button",{onClick:()=>window.location.reload(),className:"block text-blue-600 hover:underline",children:"ページを再読み込み"})]})]})})})):(0,a.jsxs)("div",{className:"min-h-screen bg-gradient-mesh",children:[a.jsx(y.W,{}),(0,a.jsxs)("div",{className:"md:ml-64 transition-all duration-300",children:[a.jsx(i.E.header,{initial:{opacity:0,y:-20},animate:{opacity:1,y:0},className:"bg-white/80 backdrop-blur-sm border-b border-gray-200 sticky top-0 z-30",children:a.jsx("div",{className:"px-6 py-4",children:(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsxs)("div",{children:[(0,a.jsxs)("h1",{className:"text-2xl font-bold text-gray-900 flex items-center gap-2",children:[a.jsx(c.Z,{className:"w-6 h-6 text-engineering-blue"}),"案件一覧"]}),a.jsx("p",{className:"text-gray-600",children:"受注可能な案件を検索・入札"})]}),(0,a.jsxs)("div",{className:"flex items-center gap-3",children:[(0,a.jsxs)("div",{className:"text-right",children:[a.jsx("p",{className:"text-sm text-gray-600",children:"入札可能案件"}),(0,a.jsxs)("p",{className:"text-sm font-medium",children:[C.filter(e=>"bidding"===e.status).length,"件"]})]}),(0,a.jsxs)("div",{className:"text-right",children:[a.jsx("p",{className:"text-sm text-gray-600",children:"落札案件"}),(0,a.jsxs)("p",{className:"text-sm font-medium",children:[C.filter(e=>"bidding"!==e.status).length,"件"]})]})]})]})})}),(0,a.jsxs)("main",{className:"px-6 py-8",children:[a.jsx("div",{className:"mb-8",children:(0,a.jsxs)("div",{className:"flex flex-col lg:flex-row gap-4 items-start lg:items-center justify-between",children:[a.jsx("div",{className:"flex space-x-1 bg-gray-100 p-1 rounded-lg",children:[{id:"available",label:"入札可能",count:C.filter(e=>"bidding"===e.status).length},{id:"awarded",label:"落札案件",count:C.filter(e=>"bidding"!==e.status).length},{id:"all",label:"すべて",count:C.length}].map(e=>(0,a.jsxs)("button",{onClick:()=>z(e.id),className:`flex items-center gap-2 px-4 py-2 rounded-md text-sm font-medium transition-colors ${A===e.id?"bg-white text-engineering-blue shadow-sm":"text-gray-600 hover:text-gray-900"}`,children:[e.label,a.jsx(v.C,{variant:"outline",className:"text-xs",children:e.count})]},e.id))}),(0,a.jsxs)("div",{className:"flex gap-2",children:[(0,a.jsxs)("div",{className:"relative",children:[a.jsx(d.Z,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400 w-4 h-4"}),a.jsx("input",{type:"text",placeholder:"案件名・発注者で検索...",value:M,onChange:e=>E(e.target.value),className:"pl-10 pr-4 py-2 border border-gray-200 rounded-lg focus:ring-2 focus:ring-engineering-blue focus:border-transparent w-64"})]}),(0,a.jsxs)("select",{value:J,onChange:e=>L(e.target.value),className:"px-3 py-2 border border-gray-200 rounded-lg focus:ring-2 focus:ring-engineering-blue focus:border-transparent",children:[a.jsx("option",{value:"",children:"すべてのカテゴリ"}),Array.from(new Set(C.map(e=>e.category))).map(e=>a.jsx("option",{value:e,children:e},e))]}),(0,a.jsxs)(w.z,{variant:"outline",children:[a.jsx(o.Z,{className:"w-4 h-4 mr-2"}),"詳細フィルター"]})]})]})}),a.jsx("div",{className:"grid grid-cols-1 lg:grid-cols-2 xl:grid-cols-3 gap-6",children:a.jsx(l.M,{children:S.map((e,s)=>a.jsx(i.E.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},exit:{opacity:0,y:-20},transition:{delay:.1*s},children:(0,a.jsxs)(N.Zb,{className:"hover-lift cursor-pointer group",children:[a.jsx(N.Ol,{className:"pb-3",children:(0,a.jsxs)("div",{className:"flex items-start justify-between",children:[(0,a.jsxs)("div",{className:"flex-1",children:[a.jsx(N.ll,{className:"text-lg text-gray-900 group-hover:text-engineering-blue transition-colors",children:e.title}),(0,a.jsxs)(N.SZ,{className:"mt-1",children:[e.org_name," • ",e.category]})]}),a.jsx(v.C,{className:eo(e.status),children:ex(e.status)})]})}),(0,a.jsxs)(N.aY,{className:"space-y-4",children:[(0,a.jsxs)("div",{className:"space-y-2 text-sm",children:[e.bidding_deadline&&(0,a.jsxs)("div",{className:`flex items-center gap-2 ${et(e.bidding_deadline)}`,children:[a.jsx(x.Z,{className:"w-4 h-4"}),"入札締切: ",new Date(e.bidding_deadline).toLocaleDateString("ja-JP"),(()=>{let s=es(e.bidding_deadline);return null!==s&&s>0?(0,a.jsxs)("span",{className:"text-xs",children:["(",s,"日後)"]}):null})()]}),(0,a.jsxs)("div",{className:"flex items-center gap-2 text-gray-600",children:[a.jsx(u.Z,{className:"w-4 h-4"}),X(e.budget)]}),(0,a.jsxs)("div",{className:"flex items-center gap-2 text-gray-600",children:[a.jsx(m.Z,{className:"w-4 h-4"}),"納期: ",new Date(e.end_date).toLocaleDateString("ja-JP")]}),(0,a.jsxs)("div",{className:"flex items-center gap-2 text-blue-600",children:[a.jsx(h.Z,{className:"w-4 h-4"}),"募集人数: ",e.required_contractors,"名",e.current_bid_count>0&&(0,a.jsxs)("span",{className:"text-sm",children:["(入札済み: ",e.current_bid_count,"名)"]})]}),e.required_level&&a.jsx("div",{className:"flex items-center gap-2",children:(0,a.jsxs)(v.C,{className:Z.DY[e.required_level].color,children:["必要レベル: ",Z.DY[e.required_level].label]})}),e.is_full&&(0,a.jsxs)("div",{className:"flex items-center gap-2 text-red-600 font-medium",children:[a.jsx(g.Z,{className:"w-4 h-4"}),"募集人数に達しました"]}),e.location&&(0,a.jsxs)("div",{className:"flex items-center gap-2 text-gray-600",children:[a.jsx(p.Z,{className:"w-4 h-4"}),e.location]})]}),a.jsx("div",{className:"text-sm text-gray-700 bg-gray-50 p-3 rounded-lg",children:a.jsx("p",{className:"line-clamp-3",children:e.description})}),a.jsx("div",{className:"pt-3 border-t border-gray-100",children:(0,a.jsxs)("div",{className:"flex items-center gap-3",children:[a.jsx("div",{className:"w-8 h-8 bg-engineering-blue/10 rounded-full flex items-center justify-center",children:a.jsx(n.Z,{className:"w-4 h-4 text-engineering-blue"})}),(0,a.jsxs)("div",{className:"flex-1",children:[a.jsx("p",{className:"text-xs text-gray-500",children:"発注者"}),a.jsx("p",{className:"text-sm font-medium text-gray-900",children:e.org_name}),e.assignee_name&&(0,a.jsxs)("p",{className:"text-xs text-gray-600",children:["担当: ",e.assignee_name]})]})]})}),(0,a.jsxs)("div",{className:"flex justify-between items-center pt-3 border-t border-gray-100",children:[(0,a.jsxs)("div",{className:"text-xs text-gray-500",children:["案件ID: ",e.id.slice(0,8).toUpperCase()]}),(0,a.jsxs)("div",{className:"flex gap-2",children:[a.jsx(w.z,{variant:"outline",size:"sm",onClick:()=>ed(e.id),children:a.jsx(b.Z,{className:"w-4 h-4"})}),"bidding"===e.status&&(0,a.jsxs)(w.z,{variant:"engineering",size:"sm",onClick:()=>ei(e.id),disabled:!e.can_bid,className:e.can_bid?"":"opacity-50 cursor-not-allowed",title:e.is_full?"募集人数に達しました":"入札する",children:[a.jsx(c.Z,{className:"w-4 h-4 mr-1"}),e.is_full?"募集終了":"入札"]}),"bidding"!==e.status&&a.jsx(v.C,{variant:"secondary",className:"bg-green-100 text-green-800",children:"落札済み"})]})]})]})]})},e.id))})}),0===S.length&&(0,a.jsxs)(i.E.div,{initial:{opacity:0},animate:{opacity:1},className:"text-center py-12",children:[a.jsx(c.Z,{className:"w-16 h-16 text-gray-300 mx-auto mb-4"}),a.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-2",children:"案件が見つかりません"}),a.jsx("p",{className:"text-gray-600 mb-4",children:M||J?"検索条件に一致する案件がありません。":"現在、入札可能な案件はありません。"}),a.jsx(w.z,{variant:"outline",onClick:()=>{E(""),L(""),z("all")},children:"フィルターをリセット"})]})]})]}),a.jsx(l.M,{children:O&&a.jsx(i.E.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:a.jsx(i.E.div,{initial:{scale:.95,opacity:0},animate:{scale:1,opacity:1},exit:{scale:.95,opacity:0},className:"bg-white rounded-lg w-full max-w-2xl max-h-[90vh] overflow-y-auto",children:(0,a.jsxs)(N.Zb,{children:[(0,a.jsxs)(N.Ol,{children:[(0,a.jsxs)(N.ll,{className:"flex items-center gap-2",children:[a.jsx(c.Z,{className:"w-5 h-5 text-engineering-blue"}),"入札フォーム"]}),a.jsx(N.SZ,{children:(()=>{let e=C.find(e=>e.id===O);return e?`${e.title} への入札`:"入札フォーム"})()})]}),a.jsx(N.aY,{children:(0,a.jsxs)("form",{onSubmit:er,className:"space-y-4",children:[(()=>{let e=C.find(e=>e.id===O);return e&&e.is_full?(0,a.jsxs)("div",{className:"bg-red-50 p-4 rounded-lg border border-red-200",children:[(0,a.jsxs)("div",{className:"flex items-center gap-2 mb-2",children:[a.jsx(g.Z,{className:"w-5 h-5 text-red-600"}),a.jsx("span",{className:"font-medium text-red-900",children:"募集終了"})]}),(0,a.jsxs)("div",{className:"text-sm text-red-700",children:["この案件の募集人数（",e.required_contractors,"名）に達しているため、入札できません。"]})]}):null})(),(0,a.jsxs)("div",{className:"bg-blue-50 p-4 rounded-lg",children:[(0,a.jsxs)("div",{className:"flex items-center gap-2 mb-2",children:[a.jsx(u.Z,{className:"w-5 h-5 text-blue-600"}),a.jsx("span",{className:"font-medium text-blue-900",children:"発注者側の予算"})]}),a.jsx("div",{className:"text-2xl font-bold text-blue-900",children:(()=>{let e=C.find(e=>e.id===O);return e?X(e.budget)+"円":"読み込み中..."})()})]}),(0,a.jsxs)("div",{className:"flex items-center gap-3 p-4 border border-gray-200 rounded-lg",children:[a.jsx("input",{type:"checkbox",id:"budget_approved",checked:B.budget_approved,onChange:e=>{let s=e.target.checked,t=C.find(e=>e.id===O);G({...B,budget_approved:s,bid_amount:s?X(t?.budget||0):B.bid_amount})},className:"w-4 h-4 text-engineering-blue border-gray-300 rounded focus:ring-engineering-blue"}),a.jsx("label",{htmlFor:"budget_approved",className:"text-sm font-medium text-gray-700",children:"上記の予算で問題ありません"})]}),(0,a.jsxs)("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"入札金額 * (円)"}),a.jsx("input",{type:"text",value:B.budget_approved?X(C.find(e=>e.id===O)?.budget||0):B.bid_amount,onChange:e=>{if(!B.budget_approved){let s=X(e.target.value);G({...B,bid_amount:s})}},placeholder:"例: 500,000",className:`w-full px-3 py-2 border rounded-lg focus:ring-2 focus:ring-engineering-blue focus:border-transparent ${B.budget_approved?"border-gray-300 bg-gray-100 text-gray-500 cursor-not-allowed":"border-gray-200"}`,disabled:B.budget_approved,required:!0}),B.budget_approved&&a.jsx("p",{className:"mt-1 text-sm text-gray-500",children:"予算承認済みのため、発注者側の予算と同じ金額で入札されます"})]}),(0,a.jsxs)("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"コメント"}),a.jsx("textarea",{value:B.proposal,onChange:e=>G({...B,proposal:e.target.value}),rows:4,placeholder:"案件に対する提案やアプローチ方法を記入してください（任意）...",className:"w-full px-3 py-2 border border-gray-200 rounded-lg focus:ring-2 focus:ring-engineering-blue focus:border-transparent"})]}),(0,a.jsxs)("div",{className:"flex justify-end gap-3 pt-4",children:[a.jsx(w.z,{type:"button",variant:"outline",onClick:()=>R(null),disabled:I,children:"キャンセル"}),a.jsx(w.z,{type:"submit",variant:"engineering",disabled:I||(()=>{let e=C.find(e=>e.id===O);return!!e&&!e.can_bid})(),children:(()=>{let e=C.find(e=>e.id===O);return e&&!e.can_bid?"募集終了":I?"送信中...":"入札を送信"})()})]})]})})]})})})}),a.jsx(l.M,{children:F&&a.jsx(i.E.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:a.jsx(i.E.div,{initial:{scale:.95,opacity:0},animate:{scale:1,opacity:1},exit:{scale:.95,opacity:0},className:"bg-white rounded-lg w-full max-w-4xl max-h-[90vh] overflow-y-auto",children:(0,a.jsxs)(N.Zb,{children:[a.jsx(N.Ol,{children:(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsxs)("div",{children:[(0,a.jsxs)(N.ll,{className:"flex items-center gap-2",children:[a.jsx(j.Z,{className:"w-5 h-5 text-engineering-blue"}),"案件詳細"]}),a.jsx(N.SZ,{children:C.find(e=>e.id===F)?.title})]}),a.jsx(w.z,{variant:"outline",size:"sm",onClick:()=>Y(null),children:a.jsx(f.Z,{className:"w-4 h-4"})})]})}),a.jsx(N.aY,{children:(()=>{let e=C.find(e=>e.id===F);return e?(0,a.jsxs)("div",{className:"space-y-6",children:[(0,a.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[(0,a.jsxs)("div",{children:[a.jsx("h3",{className:"font-semibold text-gray-900 mb-3",children:"基本情報"}),(0,a.jsxs)("div",{className:"space-y-2 text-sm",children:[(0,a.jsxs)("div",{className:"flex justify-between",children:[a.jsx("span",{className:"text-gray-600",children:"案件名:"}),a.jsx("span",{className:"font-medium",children:e.title})]}),(0,a.jsxs)("div",{className:"flex justify-between",children:[a.jsx("span",{className:"text-gray-600",children:"カテゴリ:"}),a.jsx("span",{className:"font-medium",children:e.category})]}),(0,a.jsxs)("div",{className:"flex justify-between",children:[a.jsx("span",{className:"text-gray-600",children:"予算:"}),a.jsx("span",{className:"font-medium text-engineering-blue",children:(0,_.xG)(e.budget)})]}),(0,a.jsxs)("div",{className:"flex justify-between",children:[a.jsx("span",{className:"text-gray-600",children:"納期:"}),a.jsx("span",{className:"font-medium",children:new Date(e.end_date).toLocaleDateString("ja-JP")})]}),e.bidding_deadline&&(0,a.jsxs)("div",{className:"flex justify-between",children:[a.jsx("span",{className:"text-gray-600",children:"入札締切:"}),(0,a.jsxs)("span",{className:`font-medium ${et(e.bidding_deadline)}`,children:[new Date(e.bidding_deadline).toLocaleDateString("ja-JP"),(()=>{let s=es(e.bidding_deadline);return null!==s&&s>0?(0,a.jsxs)("span",{className:"text-xs ml-1",children:["(",s,"日後)"]}):null})()]})]}),e.location&&(0,a.jsxs)("div",{className:"flex justify-between",children:[a.jsx("span",{className:"text-gray-600",children:"場所:"}),a.jsx("span",{className:"font-medium",children:e.location})]})]})]}),(0,a.jsxs)("div",{children:[a.jsx("h3",{className:"font-semibold text-gray-900 mb-3",children:"発注者情報"}),(0,a.jsxs)("div",{className:"space-y-2 text-sm",children:[(0,a.jsxs)("div",{className:"flex justify-between",children:[a.jsx("span",{className:"text-gray-600",children:"発注者:"}),a.jsx("span",{className:"font-medium",children:e.org_name})]}),e.assignee_name&&(0,a.jsxs)("div",{className:"flex justify-between",children:[a.jsx("span",{className:"text-gray-600",children:"担当者:"}),a.jsx("span",{className:"font-medium",children:e.assignee_name})]}),(0,a.jsxs)("div",{className:"flex justify-between",children:[a.jsx("span",{className:"text-gray-600",children:"案件ID:"}),a.jsx("span",{className:"font-mono text-xs",children:e.id})]})]})]})]}),(0,a.jsxs)("div",{children:[a.jsx("h3",{className:"font-semibold text-gray-900 mb-3",children:"案件説明"}),a.jsx("div",{className:"bg-gray-50 p-4 rounded-lg",children:a.jsx("p",{className:"text-sm text-gray-700 whitespace-pre-wrap",children:e.description})})]}),e.requirements&&(0,a.jsxs)("div",{children:[a.jsx("h3",{className:"font-semibold text-gray-900 mb-3",children:"要件・条件"}),a.jsx("div",{className:"bg-blue-50 p-4 rounded-lg",children:a.jsx("p",{className:"text-sm text-gray-700 whitespace-pre-wrap",children:e.requirements})})]}),(0,a.jsxs)("div",{children:[a.jsx("h3",{className:"font-semibold text-gray-900 mb-3",children:"添付資料"}),K?a.jsx("div",{className:"bg-gray-50 p-4 rounded-lg text-center",children:a.jsx("div",{className:"text-sm text-gray-600",children:"添付資料を読み込み中..."})}):Q.length>0?a.jsx("div",{className:"space-y-2",children:Q.map(e=>a.jsx("div",{className:"bg-gray-50 p-3 rounded-lg border",children:(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsxs)("div",{className:"flex items-center gap-3",children:[a.jsx("span",{className:"text-lg",children:ec(e.file_type)}),(0,a.jsxs)("div",{children:[a.jsx("div",{className:"text-sm font-medium text-gray-900",children:e.file_name}),(0,a.jsxs)("div",{className:"text-xs text-gray-500",children:[en(e.file_size)," •",new Date(e.created_at).toLocaleDateString("ja-JP")," •",e.uploaded_by_name]})]})]}),(0,a.jsxs)(w.z,{variant:"outline",size:"sm",onClick:()=>window.open(e.download_url,"_blank"),children:[a.jsx(j.Z,{className:"w-4 h-4 mr-1"}),"ダウンロード"]})]})},e.id))}):a.jsx("div",{className:"bg-gray-50 p-4 rounded-lg text-center",children:a.jsx("div",{className:"text-sm text-gray-600",children:"添付資料はありません"})})]}),(0,a.jsxs)("div",{className:"flex justify-end gap-3 pt-4 border-t border-gray-200",children:[a.jsx(w.z,{variant:"outline",onClick:()=>Y(null),children:"閉じる"}),"bidding"===e.status&&(0,a.jsxs)(w.z,{variant:"engineering",onClick:()=>{Y(null),ei(e.id)},disabled:!e.can_bid,className:e.can_bid?"":"opacity-50 cursor-not-allowed",children:[a.jsx(c.Z,{className:"w-4 h-4 mr-2"}),e.is_full?"募集人数に達しました":"入札する"]}),"bidding"!==e.status&&a.jsx(v.C,{variant:"secondary",className:"bg-green-100 text-green-800",children:"落札済み"})]})]}):null})()})]})})})})]})}function S(){return a.jsx(C.AuthGuard,{requiredRole:"Contractor",children:a.jsx(P,{})})}},76586:(e,s,t)=>{"use strict";t.r(s),t.d(s,{AuthGuard:()=>d,useRoleAccess:()=>x,withAuth:()=>o});var a=t(95344),r=t(3729),i=t(22254),l=t(57916),n=t(42739),c=t(43750);function d({children:e,requiredRole:s,allowedRoles:t,redirectTo:d="/auth/login"}){let{user:o,userRole:x,loading:u}=(0,c.useAuth)(),m=(0,i.useRouter)(),h=(0,i.usePathname)(),g=(0,r.useRef)(!1);return((0,r.useEffect)(()=>{if(!u&&!g.current){if(!o){sessionStorage.setItem("redirectAfterLogin",h),h!==d&&(g.current=!0,m.push(d));return}if(s&&x!==s||t&&t.length>0&&(!x||!t.includes(x))){"/unauthorized"!==h&&(g.current=!0,m.push("/unauthorized"));return}}},[o,x,u,s,t]),u)?a.jsx("div",{className:"min-h-screen bg-gradient-mesh flex items-center justify-center",children:(0,a.jsxs)(l.E.div,{initial:{opacity:0,scale:.9},animate:{opacity:1,scale:1},className:"text-center",children:[a.jsx("div",{className:"w-16 h-16 bg-engineering-blue rounded-xl flex items-center justify-center mx-auto mb-4",children:a.jsx(n.Z,{className:"w-8 h-8 text-white animate-spin"})}),a.jsx("h2",{className:"text-xl font-semibold text-gray-900 mb-2",children:"認証確認中..."}),a.jsx("p",{className:"text-gray-600",children:"しばらくお待ちください"})]})}):!o||s&&x!==s||t&&t.length>0&&(!x||!t.includes(x))?null:a.jsx(a.Fragment,{children:e})}function o(e,s){return function(t){return a.jsx(d,{requiredRole:s,children:a.jsx(e,{...t})})}}function x(){let{userRole:e}=(0,c.useAuth)(),s=s=>e===s,t=s=>!!e&&s.includes(e);return{hasRole:s,hasAnyRole:t,isAdmin:()=>s("OrgAdmin"),isStaff:()=>s("Staff"),isContractor:()=>s("Contractor"),isReviewer:()=>s("Reviewer"),isAuditor:()=>s("Auditor"),canManageProjects:()=>t(["OrgAdmin","Staff"]),canViewFinancials:()=>t(["OrgAdmin","Staff","Auditor"]),canReviewProjects:()=>t(["Reviewer","OrgAdmin"]),canViewAuditLogs:()=>t(["Auditor","OrgAdmin"])}}},91684:(e,s,t)=>{"use strict";t.d(s,{$9:()=>r,DY:()=>a,qf:()=>i});let a={beginner:{level:"beginner",label:"初級",description:"経験年数3年未満、未経験",color:"bg-green-100 text-green-800"},intermediate:{level:"intermediate",label:"中級",description:"経験年数3年以上7年未満",color:"bg-yellow-100 text-yellow-800"},advanced:{level:"advanced",label:"上級",description:"経験年数7年以上",color:"bg-red-100 text-red-800"}};function r(e,s){if(0===s.length||s.every(e=>"未経験"===e))return"beginner";let t=parseInt(e||"0",10);return t<3?"beginner":t<7?"intermediate":"advanced"}function i(e){return a[e]}},40615:(e,s,t)=>{"use strict";t.r(s),t.d(s,{$$typeof:()=>i,__esModule:()=>r,default:()=>l});let a=(0,t(86843).createProxy)(String.raw`/Users/sayuri/caddonworks/src/app/jobs/page.tsx`),{__esModule:r,$$typeof:i}=a,l=a.default}};var s=require("../../webpack-runtime.js");s.C(e);var t=e=>s(s.s=e),a=s.X(0,[1638,4679,3035,7962,4835,8710,6152],()=>t(65994));module.exports=a})();